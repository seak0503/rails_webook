<?xml version="1.0"?>
<rss version="2.0">
  <channel>
    <title>Rails View - Rails Webook</title>
    <link>http://ruby-rails.hatenadiary.com/category/Rails%20View</link>
    <description>自社のECを開発している会社で働いています。Rails情報やサービスを成長させる方法を書いていきます</description>
    <lastBuildDate>Fri, 18 Dec 2015 02:44:31 +0900</lastBuildDate>
    <docs>http://blogs.law.harvard.edu/tech/rss</docs>
    <generator>Hatena::Blog</generator>
    
      
      
        <item>
          <title>RailsでDraperを使ってプレゼンテーション層（デコレーター）を実装する</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20150415/1429031791</link>
          <description>&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150415/20150415020650.jpg&quot; alt=&quot;f:id:nipe880324:20150415020650j:plain&quot; title=&quot;f:id:nipe880324:20150415020650j:plain&quot; class=&quot;hatena-fotolife&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;br /&gt;
&lt;i&gt;Photo by &lt;a href=&quot;https://www.flickr.com/photos/herry/&quot;&gt;Flickr: HerryLawford&amp;#39;s Photostream&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/drapergem/draper&quot;&gt;Draper&lt;/a&gt;はRailsのプレゼンテーション層の役割を担うgemです。&lt;br /&gt;
この記事では、Draperを通し、プレゼンテーション層の必要性や使い方を説明します。&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;Ruby   2.2.1&lt;/li&gt;
&lt;li&gt;Rails  4.2.0&lt;/li&gt;
&lt;li&gt;Draper 1.4.0&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;目次&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;0.   &lt;a href=&quot;#draper-why&quot;&gt;プレゼンテーション層の必要性&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;1.   &lt;a href=&quot;#draper-installation&quot;&gt;Draperのインストール方法&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;2.   &lt;a href=&quot;#draper-basic-usage&quot;&gt;Draperの簡単な使い方&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;3.   &lt;a href=&quot;#draper-instanate&quot;&gt;デコレーターインスタンスの作成&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;3.1. &lt;a href=&quot;#draper-single-obj&quot;&gt;単独のオブジェクトのデコレーター&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;3.2. &lt;a href=&quot;#draper-individual-collection&quot;&gt;コレクションの個々のオブジェクトのデコレーター&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;3.3. &lt;a href=&quot;#draper-collection&quot;&gt;コレクション自身のデコレーター&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;3.4. &lt;a href=&quot;#draper-related-object&quot;&gt;関連するオブジェクトのデコレーター&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;4.   &lt;a href=&quot;#draper-create-class&quot;&gt;デコレータークラスの作成&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;4.1. &lt;a href=&quot;#draper-access-helper&quot;&gt;デコレーター内でヘルパーメソッドへのアクセス&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;4.2. &lt;a href=&quot;#draper-access-model&quot;&gt;デコレーター内でモデルオブジェクトへアクセス&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;4.3. &lt;a href=&quot;#draper-render-html&quot;&gt;デコレーターでHTMLをレンダリングする&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;4.4. &lt;a href=&quot;#draper-delegate&quot;&gt;デコレーターのデリゲート（委託）&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;draper-why&quot;&gt;0. プレゼンテーション層の必要性&lt;/h3&gt;Draperはデコレーター（他にはプレゼンター、ビューモデルなどと呼ばれます）であり、ビューとモデルの中間に位置し、モデルやビューに実装されやすい表示ロジック/フォーマットといったプレゼンテーション層の責務を引き受けることで可読性、保守性を向上させることができます。&lt;/p&gt;&lt;p&gt;ビューにif文が多くて見ずらい、モデルに表示用のロジックが多くなってしまった、ビューのロジックをヘルパーに書いているがヘルパーの名前空間の衝突が怖い(※1)などの場合にDraperを導入するとよいと思います。&lt;/p&gt;&lt;p&gt;&lt;i&gt;※1 Railsのヘルパーはグローバルな名前空間にメソッドが定義されるので、異なるヘルパーモジュールに同じメソッド名のメソッドを定義すると名前が衝突します&lt;/i&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;ビューにif文が多くて見ずらい&lt;/h5&gt;
    &lt;p&gt;ビューからロジックをなくしたい。HTML構造が複雑になり、ビューファイルが見ずらくなる。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# Draper導入前
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Twitter:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% if @user.twitter_name.present? %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; @user.twitter_name, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;http://twitter.com/#{@user.twitter_name}&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% else %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;span&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;none&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;None given&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;span&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

# Draper導入後
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Twitter:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; @user.twitter&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;ヘルパーの名前空間の衝突&lt;/h5&gt;
    &lt;p&gt;別々のヘルパーでfooメソッドという同じメソッド名のメソッドを定義したので衝突してしまって、思うようにメソッドが動かない。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synPreProc&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ApplicationHelper&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;foo&lt;/span&gt;
    &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;ApplicationHelper#foo&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;synPreProc&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;BooksHelper&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;foo&lt;/span&gt;
    &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;BooksHelper#foo&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# ApplicationHelper#fooが上書きされてしまう??&lt;/span&gt;
foo &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &#39;BooksHelper#foo&#39; &lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;モデルに表示用のロジックが多い&lt;/h5&gt;
    &lt;p&gt;モデルはドメインロジックを記載するべきであり、メソッドが多くやすいので、UIの細かなフォーマットなどはあまり書きたくない。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# Draper導入前&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;SomeModel&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;posted_at&lt;/span&gt;
    created_at.strftime(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;%Y/%m/%d&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# Draper導入後&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;SomeModel&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# posted_atメソッドはデコレータークラスに移動&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;draper-installation&quot;&gt;1. Draperのインストール方法&lt;/h3&gt;&lt;code&gt;Gemfile&lt;/code&gt;にDraperを追加します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# Gemfile&lt;/span&gt;
gem &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;draper&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;~&amp;gt; 1.3&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
バンドラーを実行して、Draperをインストールします。&lt;/p&gt;
&lt;pre class=&quot;code lang-sh&quot; data-lang=&quot;sh&quot; data-unlink&gt;bundle &lt;span class=&quot;synStatement&quot;&gt;install&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;draper-basic-usage&quot;&gt;2. Draperの簡単な使い方&lt;/h3&gt;まず、Scaffoldで作成します。&lt;br /&gt;
Draperを入れたので、デコレーターも作成されます。&lt;/p&gt;
&lt;pre class=&quot;code lang-sh&quot; data-lang=&quot;sh&quot; data-unlink&gt;bin/rails g scaffold Article title body:text
      ...
      invoke    decorator
      create      app/decorators/article_decorator.rb
&lt;/pre&gt;&lt;p&gt;※&lt;code&gt;rails g resource&lt;/code&gt;や&lt;code&gt;rails g decorator&lt;/code&gt;というジェネレーターを実行した場合もデコレーターが作成されます。&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;デコレーターにプレゼンテーション層のメソッドを定義します。&lt;br /&gt;
イメージとしては、ビューやモデルに書くべきではなく、ヘルパーに書くようなメソッドです。例えば、日付のフォーマット、条件分岐でビューの表示が少し変わるなどです。&lt;br /&gt;
今回は、日付をフォーマットして、spanタグ付きで表示する&lt;code&gt;posted_at&lt;/code&gt;メソッドを追加しました。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/decorators/article_decorator.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;Draper&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Decorator&lt;/span&gt;
  delegate_all

  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;posted_at&lt;/span&gt;
    h.content_tag &lt;span class=&quot;synConstant&quot;&gt;:span&lt;/span&gt;, &lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt;
      model.created_at.strftime(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;%Y/%m/%d %H:%m&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
    &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;デコレーターはモデルオブジェクトを保持しています。&lt;br /&gt;
そして、&lt;code&gt;delegate_all&lt;/code&gt;と記載することで、デコレーター内に定義されていないメソッドが呼び出されたい場合、デコレーターが保持しているモデルオブジェクトにメソッド呼び出しを委譲します。&lt;br /&gt;
そのため、基本的にデコレーターを導入しても、モデルの処理が行われるので従来通り動きます。&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;次に、コントローラー内で作成したデコレーターを使いようにします。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;コレクションの個々のオブジェクトをデコレートするには&lt;code&gt;decorate_collection&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;単独のオブジェクトをデコレートするには&lt;code&gt;decorate&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;を使います。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/controllers/articles_controller.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ArticlesController&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ApplicationController&lt;/span&gt;
  before_action &lt;span class=&quot;synConstant&quot;&gt;:set_article&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;only&lt;/span&gt;: [&lt;span class=&quot;synConstant&quot;&gt;:show&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:edit&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:update&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:destroy&lt;/span&gt;]

  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;index&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;@articles&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt;.decorate_collection(&lt;span class=&quot;synType&quot;&gt;Article&lt;/span&gt;.all)
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

  ...

  &lt;span class=&quot;synStatement&quot;&gt;private&lt;/span&gt;

    &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;set_article&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;@article&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt;.decorate(&lt;span class=&quot;synType&quot;&gt;Article&lt;/span&gt;.find(params[&lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;]))
    &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;これで、Articleオブジェクトを保持した、Articleデコレーターインスタンスが作成されました。&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;最後に、ビューからデコレーターのメソッドを呼び出します。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;&amp;lt;!-- app/views/articles/index.html.erb --&amp;gt;&lt;/span&gt;

   &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tbody&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% @articles.each do |article| %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tr&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; article.title&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; article.body&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synComment&quot;&gt;&amp;lt;!-- デコレーターのメソッド呼び出し --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; article.posted_at&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Show&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, article %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Edit&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, edit_article_path(article) %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Destroy&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, article, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: :delete, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: { confirm: &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Are you sure?&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; } %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tr&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tbody&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;code&gt;title&lt;/code&gt;や&lt;code&gt;body&lt;/code&gt;は、デコレーターの&lt;code&gt;delegate_all&lt;/code&gt;でモデルに委譲させるのでモデルのメソッドが呼び出されます。&lt;br /&gt;
&lt;code&gt;posted_at&lt;/code&gt;は、デコレーターで定義したメソッドが呼び出されます。&lt;/p&gt;&lt;p&gt;画面は次のようになります。（Posted atの値のスタイリングをしています）&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150415/20150415021453.jpg&quot; alt=&quot;f:id:nipe880324:20150415021453j:plain:w480&quot; title=&quot;f:id:nipe880324:20150415021453j:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;このようにして、Draperを使うことができます。&lt;br /&gt;
モデルとビューの間にデコレーターを導入することで、モデル内のビジネスロジックと関係ないメソッドを減らせ、ビューから条件分岐を減らせ、ヘルパーメソッドのメソッド名の衝突問題を防ぐことができるようになります。&lt;br /&gt;
アプリの規模が大きくなってきてこのようなことに困った場合は、導入をお勧めします。&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;draper-instanate&quot;&gt;3. デコレーターインスタンスの作成&lt;/h3&gt;&lt;h3 id=&quot;draper-single-obj&quot;&gt;3.1. 単独のオブジェクトのデコレーター&lt;/h3&gt;単独のオブジェクトの場合、次のように&lt;code&gt;decorate&lt;/code&gt;メソッドやデコレーターの&lt;code&gt;new&lt;/code&gt;メソッドを使います。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# decorateメソッドを使うと、モデルからデコレーターを推測して作成されます&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# Articleの場合、ArticleDecoratorが使われる。&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;@article&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;Article&lt;/span&gt;.find(params[&lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;]).decorate


&lt;span class=&quot;synComment&quot;&gt;# デコレーターを指定したい場合は、デコーレータを作成します&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;@widget&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;ProductDecorator&lt;/span&gt;.new(&lt;span class=&quot;synType&quot;&gt;Widget&lt;/span&gt;.find(params[&lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;]))
&lt;span class=&quot;synComment&quot;&gt;# 以下も同じ&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;@widget&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;ProductDecorator&lt;/span&gt;.decorate(&lt;span class=&quot;synType&quot;&gt;Widget&lt;/span&gt;.find(params[&lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;]))
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
また、次のように&lt;code&gt;decorates_finders&lt;/code&gt;メソッドをデコレーターに定義すれば、ActiveRecordのように&lt;code&gt;find&lt;/code&gt;メソッドがつかえるようになります。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/decorators/articl_decorator.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;Draper&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Decorator&lt;/span&gt;
  decorates_finders
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# コントローラーなど&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;@article&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt;.find(params[&lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;])
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;draper-individual-collection&quot;&gt;3.2. コレクションの個々のオブジェクトのデコレーター&lt;/h3&gt;コレクションの場合、次のように&lt;code&gt;decorate_collection&lt;/code&gt;メソッドを使います。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synIdentifier&quot;&gt;@articles&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt;.decorate_collection(&lt;span class=&quot;synType&quot;&gt;Article&lt;/span&gt;.all)
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;draper-collection&quot;&gt;3.3. コレクション自身のデコレーター&lt;/h3&gt;コレクション自身をデコレートしたい場合は、&lt;code&gt;Draper::CollectionDecorator&lt;/code&gt;のサブクラスのデコレータークラスを定義します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/decorators/articles_decorator.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ArticlesDecorator&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;Draper&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;CollectionDecorator&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;page_number&lt;/span&gt;
    &lt;span class=&quot;synConstant&quot;&gt;42&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# コントローラーなど&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;@articles&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;ArticlesDecorator&lt;/span&gt;.new(&lt;span class=&quot;synType&quot;&gt;Article&lt;/span&gt;.all)
&lt;span class=&quot;synComment&quot;&gt;# もしくは、&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;@articles&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;ArticlesDecorator&lt;/span&gt;.decorate(&lt;span class=&quot;synType&quot;&gt;Article&lt;/span&gt;.all)
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;draper-related-object&quot;&gt;3.4. 関連するオブジェクトのデコレーター&lt;/h3&gt;&lt;code&gt;decorates_association&lt;/code&gt;を使うことで、関連するオブジェクトのデコレーターを使うように宣言できます。&lt;br /&gt;
次の場合、authorモデルに対応するAuthorDecoratorを使うことができます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/decorators/article_decorator.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;Draper&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Decorator&lt;/span&gt;
  decorates_association &lt;span class=&quot;synConstant&quot;&gt;:author&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# app/decorators/author_decorator.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;AuthorDecorator&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;Draper&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Decorator&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;hoge&lt;/span&gt;
    model.name + &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;hogehoge&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# ビューでAuthorDecoratorのメソッドを呼び出す&lt;/span&gt;
article.author.hoge
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;draper-create-class&quot;&gt;4. デコレータークラスの作成&lt;/h3&gt;&lt;/p&gt;&lt;p&gt;&lt;h3 id=&quot;draper-access-helper&quot;&gt;4.1. デコレーター内でヘルパーメソッドへのアクセス&lt;/h3&gt;デコレーターからヘルパーメソッドを使うには、&lt;code&gt;h&lt;/code&gt;メソッドを使います。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;Draper&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Decorator&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;emphatic&lt;/span&gt;
    h.content_tag(&lt;span class=&quot;synConstant&quot;&gt;:strong&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Awesome&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
    &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;strong&amp;gt;Awesome&amp;lt;/strong&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;draper-access-model&quot;&gt;4.2. デコレーター内でモデルオブジェクトへアクセス&lt;/h3&gt;デコレーター内でデコレーターが保持しているモデルオブジェクトにアクセスするにはモデルには、&lt;code&gt;object&lt;/code&gt;（もしくは、エイリアスの&lt;code&gt;model&lt;/code&gt;）を使います。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;Draper&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Decorator&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;published_at&lt;/span&gt;
    object.published_at.strftime(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;%A, %B %e&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;draper-render-html&quot;&gt;4.3. デコレーターでHTMLをレンダリングする&lt;/h3&gt;条件分岐をビューからデコレーターに移す場合、HTMLの断片が入ってしまうことがあります。&lt;br /&gt;
デコレーター内に直でHTMLコードを記載するとHTMLコードの断片が散らばり可読性や保守性が下がるので、次のようにするといいかもしれません。&lt;/p&gt;&lt;p&gt;HTMLのレンダリングが&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;1行程度なら&lt;code&gt;content_tag&lt;/code&gt;ヘルパーメソッドを使う&lt;/li&gt;
&lt;li&gt;複数行の場合は&lt;code&gt;render&lt;/code&gt;メソッドを使って部分テンプレートを表示する&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;Draper&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Decorator&lt;/span&gt;
  delegate_all

  &lt;span class=&quot;synComment&quot;&gt;# 1行程度なので、content_tagメソッドを使う&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;emphatic&lt;/span&gt;
    h.content_tag(&lt;span class=&quot;synConstant&quot;&gt;:strong&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Awesome&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
    &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;strong&amp;gt;Awesome&amp;lt;/strong&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# 複数行のため、部分テンプレートを呼び出す&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;sub_view&lt;/span&gt;
    h.render &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;sub_view&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;title&lt;/span&gt;: model.title
    &lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; articles/sub_view.html.erb　を表示する&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;draper-delegate&quot;&gt;4.4. デコレーターのデリゲート（委託）&lt;/h3&gt;デコレーターオブジェクトへのメソッド呼び出しを、モデルにデリゲート（委託）することができます。&lt;br /&gt;
&lt;code&gt;delegate_all&lt;/code&gt;で全てのメソッドを委託、&lt;code&gt;delegate&lt;/code&gt;で指定したメソッドを委託するように宣言できます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# デコレーター&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;Draper&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Decorator&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# 全てのメソッド呼び出しにおいて、デコレーターで定義していないメソッドは、モデルオブジェクトへ委譲される&lt;/span&gt;
  delegate_all

  &lt;span class=&quot;synComment&quot;&gt;# 特定のメソッドのみ委譲する（toオプションを指定しないとデフォルトでobjectに委譲する）&lt;/span&gt;
  delegate &lt;span class=&quot;synConstant&quot;&gt;:title&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:body&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# 特定のメソッドを指定したオブジェクトに委譲する&lt;/span&gt;
  delegate &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;to&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:author&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;prefix&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;

  ...
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# 使い方（ビューなど）&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;@article&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;ArticleDecorator&lt;/span&gt;.decorate(&lt;span class=&quot;synType&quot;&gt;Article&lt;/span&gt;.find(params[&lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;]))
&lt;span class=&quot;synIdentifier&quot;&gt;@article&lt;/span&gt;.title  &lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; articleのtitle&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;@article&lt;/span&gt;.body   &lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; articleのbody&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;@article&lt;/span&gt;.author_name   &lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; articleの author.name&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
以上です。&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;参考文献&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/drapergem/draper&quot;&gt;https://github.com/drapergem/draper&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://morizyun.github.io/blog/draper-ruby-gem-code-clear/&quot;&gt;http://morizyun.github.io/blog/draper-ruby-gem-code-clear/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://railscasts.com/episodes/286-draper&quot;&gt;http://railscasts.com/episodes/286-draper&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;</description>
          <pubDate>Wed, 15 Apr 2015 02:16:31 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/8454420450091528638</guid>
          
            <category>設計</category>
          
            <category>リファクタリング</category>
          
            <category>Rails View</category>
          
            <category>Rails中級</category>
          
        </item>
      
    
      
      
        <item>
          <title>Railsのlink_toメソッドでclass属性を指定する</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20150210/1423494000</link>
          <description>&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150304/20150304013504.png&quot; alt=&quot;f:id:nipe880324:20150304013504p:plain&quot; title=&quot;f:id:nipe880324:20150304013504p:plain&quot; class=&quot;hatena-fotolife&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;link_toメソッドでclass属性を指定するには、&lt;code&gt;class&lt;/code&gt;オプションを利用します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# ビューファイル&lt;/span&gt;
&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;, &lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;btn btn-large&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;profile-btn&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;a href=&amp;quot;/profiles/1&amp;quot; class=&amp;quot;btn btn-large&amp;quot; id=&amp;quot;profile-btn&amp;quot;&amp;gt;プロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;以上です。&lt;/p&gt;
</description>
          <pubDate>Tue, 10 Feb 2015 00:00:00 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/8454420450086938187</guid>
          
            <category>Rails View</category>
          
            <category>Rails入門</category>
          
            <category>Rails Tips</category>
          
        </item>
      
    
      
      
        <item>
          <title>Railsのlink_toにパラメータを追加する</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20150114/1421161200</link>
          <description>&lt;p&gt;link_toメソッドの&lt;code&gt;_path&lt;/code&gt;メソッドの引数にハッシュを渡すことで、URLにパラメータ（クエリストリング）を付与することができます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# ビューファイル&lt;/span&gt;
&amp;lt;%= link_to  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, profile_path(&lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;q1&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;some&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;q2&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;thing&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;)  %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;a href=&amp;quot;/profiles/1?q1=some&amp;amp;q2=thing&amp;quot;&amp;gt;プロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;また、&lt;code&gt;format&lt;/code&gt;オプションと値に&lt;code&gt;:json&lt;/code&gt;、&lt;code&gt;:xls&lt;/code&gt;などを渡すことで、JSONリクエスト(.json)やXLSリクエスト(.xls)になります。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# ビューファイル&lt;/span&gt;
&amp;lt;%= link_to  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, profile_path(&lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;q1&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;some&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;q2&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;thing&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;format&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:json&lt;/span&gt;)  %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;a href=&amp;quot;/profiles/1.json?q1=some&amp;amp;q2=thing&amp;quot;&amp;gt;プロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
以上です。&lt;/p&gt;
</description>
          <pubDate>Wed, 14 Jan 2015 00:00:00 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/8454420450086939651</guid>
          
            <category>Rails初級</category>
          
            <category>Rails View</category>
          
            <category>Rails Tips</category>
          
        </item>
      
    
      
      
        <item>
          <title>Railsのビューヘルパー(View Helper)のまとめ</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20150113/1421149061</link>
          <description>&lt;p&gt;&lt;a href=&quot;https://farm2.staticflickr.com/1005/1425536855_d705f747f8_b.jpg&quot; title=&quot;Columbus Flickr Meet Group Photo&quot;&gt;&lt;img alt=&quot;Columbus Flickr Meet Group Photo&quot; class=&quot;http-image&quot; src=&quot;https://farm2.staticflickr.com/1005/1425536855_d705f747f8_b.jpg&quot; /&gt;&lt;/a&gt;&lt;br /&gt;
&lt;i&gt;Photo by &lt;a href=&quot;https://www.flickr.com/photos/fensterbme/1425536855/in/photolist-4GjFfV-o8sHC9-a9MFqY-eo2tW8-eo2nBV-7eCWtP-3aYfrD-fQLPNz-6Lof3x-dkuUeM-52MkHD-6TjTGD-p8Hi6u-4vzm4e-9Tqmhn-5iT1Ch-bGDA3F-8nhsjA-dqSdfA-5dTjjS-ohvPL-62p3Xn-oaQ9Y4-aHY6ZB-3iXbZj-oFqJYW-4rFX1-5d918i-bB1wTW-o2FLCg-7tvtzy-4qTqmm-4nj2u6-gW5TTo-8ucrbd-ffNHdp-dpv9hC-9a4xLx-4mxMUW-ieBgZL-nadtga-6hpuGV-3RFkS-dLeXTM-oM5hzK-5U2YhL-aDCc3Z-eTiq5S-8EQy76-7FCaAs&quot;&gt;Columbus Flickr Meet Group Photo | Flickr - Photo Sharing!&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;Railsのよく忘れるプルダウン(select), チェックボックス(check_box), ラジオボタン(radio_button)などビューヘルパーをまとめました。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ビューでの表示形式の変換ヘルパーは、「&lt;a href=&quot;http://ruby-rails.hatenadiary.com/entry/20140802/1406969793&quot;&gt;Rails&amp;#x306E;&amp;#x30C6;&amp;#x30AD;&amp;#x30B9;&amp;#x30C8;&amp;#x3001;&amp;#x6570;&amp;#x5024;&amp;#x3001;&amp;#x65E5;&amp;#x4ED8;/&amp;#x65E5;&amp;#x6642;&amp;#x95A2;&amp;#x9023;&amp;#x306E;&amp;#x30D5;&amp;#x30A9;&amp;#x30FC;&amp;#x30DE;&amp;#x30C3;&amp;#x30C8;&amp;#x30D8;&amp;#x30EB;&amp;#x30D1;&amp;#x30FC; - Rails Webook&lt;/a&gt;」を参照してください。&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;Rails 4.2.0&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;目次&lt;/h3&gt;
    &lt;p&gt; 1. &lt;a href=&quot;#view-helpers-link_to&quot;&gt;リンク - &lt;code&gt;link_to&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
 2. &lt;a href=&quot;#view-helpers-image_tag&quot;&gt;画像 - &lt;code&gt;image_tag&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
 3. &lt;a href=&quot;#view-helpers-form&quot;&gt;フォーム - &lt;code&gt;form_for / form_tag&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
 4. &lt;a href=&quot;#view-helpers-fileds_for&quot;&gt;関連モデルのフォームを作成 - &lt;code&gt;fields_for&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
 5. &lt;a href=&quot;#view-helpers-label&quot;&gt;ラベル - &lt;code&gt;label / label_tag&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
 6. &lt;a href=&quot;#view-helpers-text&quot;&gt;テキストフィールド - &lt;code&gt;text_field / test_field_tag&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
 7. &lt;a href=&quot;#view-helpers-datetime&quot;&gt;日付/時刻の入力フィールド - &lt;code&gt;date_field / time_field / datetime_field&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
 8. &lt;a href=&quot;#view-helpers-datetime-select&quot;&gt;日付/時刻の選択フィールド - &lt;code&gt;date_select / time_select / datetime_select&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
 9. &lt;a href=&quot;#view-helpers-file&quot;&gt;ファイルアップロードフィールド - &lt;code&gt;file_field / file_field_tag&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
10. &lt;a href=&quot;#view-helpers-text_area&quot;&gt;テキストエリア - &lt;code&gt;text_area / text_area_tag&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
11. &lt;a href=&quot;#view-helpers-select&quot;&gt;プルダウン/セレクトボックス - &lt;code&gt;select / select_tag / collection_select&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
12. &lt;a href=&quot;#view-helpers-check_box&quot;&gt;チェックボックス - &lt;code&gt;check_box / check_box_tag / collection_check_boxes&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
13. &lt;a href=&quot;#view-helpers-radio_button&quot;&gt;ラジオボタン - &lt;code&gt;radio_button, radio_button_tag&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
14. &lt;a href=&quot;#view-helpers-hidden&quot;&gt;hiddenフィールド - &lt;code&gt;hidden_field / hidden_field_tag&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
15. &lt;a href=&quot;#view-helpers-submit&quot;&gt;サブミットボタン - &lt;code&gt;submit / submit_tag&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-link_to&quot;&gt; 1. リンク - &lt;code&gt;link_to&lt;/code&gt;&lt;/h3&gt;&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;基本的な使い方&lt;/h4&gt;
    &lt;p&gt;リンク(aタグ）を作成します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;link_to(name = &lt;span class=&quot;synConstant&quot;&gt;nil&lt;/span&gt;, options = &lt;span class=&quot;synConstant&quot;&gt;nil&lt;/span&gt;, html_options = &lt;span class=&quot;synConstant&quot;&gt;nil&lt;/span&gt;, &amp;amp;block)
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;optionsに指定できるオプション&lt;/h4&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;method&lt;/code&gt; ... &lt;code&gt;:get&lt;/code&gt;, &lt;code&gt;:post&lt;/code&gt;, &lt;code&gt;:patch&lt;/code&gt;, &lt;code&gt;:delete&lt;/code&gt; を指定することで、リンクのGET, POSTなどのHTTPメソッドを定義できる&lt;/li&gt;
&lt;li&gt;&lt;code&gt;remote: true&lt;/code&gt; ... Ajaxリクエストをサーバーに送る（デフォルト値：false）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;data: { confirm: &#39;削除しますか？&#39; }&lt;/code&gt; ... &quot;削除しますか？&quot;という表示される確認ダイアログを表示する。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;data: { disable_with: &#39;更新中...&#39; }&lt;/code&gt; ... ボタンを押した後に、ボタンを押せなくし、&quot;更新中...&quot;とボタンに表示する。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;link_to の良くある使い方&lt;/h4&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# HTML属性を指定する&lt;/span&gt;
link_to &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, profile_path(&lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;), &lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;btn btn-large&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;.id&lt;span class=&quot;synSpecial&quot;&gt;}&amp;quot;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;a class=&amp;quot;btn btn-large&amp;quot; href=&amp;quot;/profiles/1&amp;quot; id=&amp;quot;profile1&amp;quot;&amp;gt;プロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# クエリストリング(?=xxx)を追加する&lt;/span&gt;
link_to &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, profile_path(&lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;q&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;a href=&amp;quot;/profiles/1?q=list&amp;quot;&amp;gt;プロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# CSV, JSONなどリンクのフォーマットを指定する。&lt;/span&gt;
link_to &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, profile_path(&lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;format&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;csv&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;)
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;a href=&amp;quot;/profiles/1.csv&amp;quot;&amp;gt;プロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# ブロックで特定要素を囲む&lt;/span&gt;
link_to &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt; &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt;
  &amp;lt;strong&amp;gt;&amp;lt;%= &lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;.name %&amp;gt;&amp;lt;/strong&amp;gt;さんのプロフィール
&lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;a href=&amp;quot;/profiles/1&amp;quot;&amp;gt;&amp;lt;strong&amp;gt;鈴木&amp;lt;/strong&amp;gt;さんのプロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# 条件によりリンクの表示有無を変える&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# 管理者の場合、リンクを表示する。&lt;/span&gt;
link_to_if(current_user.admin?, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;管理者用リンク&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, admin_path)
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-image_tag&quot;&gt; 2. 画像 - &lt;code&gt;image_tag&lt;/code&gt;&lt;/h3&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;基本的な使い方&lt;/h4&gt;
    &lt;p&gt;画像（&lt;code&gt;img&lt;/code&gt;タグ）を表示するために使います。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;image_tag(source, options={})
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;オプション&lt;/h4&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;source&lt;/code&gt; ... 絶対パスと相対パスのどちらでも指定可能。また、ファイルだけ指定した場合、assets/imagesフォルダからのパスとなる。&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;例: &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; image_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;picture.png&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
#=&lt;span class=&quot;synError&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;/images/picture.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;Picture&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;alt&lt;/code&gt; ... imgタグのalt属性（目の不自由な方のためなどの画像の代替文字列）を指定する。指定しない場合は、拡張子無しのファイル名が自動で設定される。&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;size&lt;/code&gt; ... &quot;{幅}x{高さ}&quot; か &quot;{数}&quot; のどちらかで指定する。&quot;30x50&quot;の場合、width=&quot;30&quot; height=&quot;50&quot;となる。&quot;30&quot;の場合、width=&quot;30&quot; height=&quot;30&quot;になる。&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;その他、HTMLのclassやid属性も追加することが可能&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;例: &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; image_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;picture.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;main_img&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;iamge_tag のサンプル&lt;/h4&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;image_tag(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;picture&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;img alt=&amp;quot;Picture&amp;quot; src=&amp;quot;/images/picture&amp;quot; /&amp;gt;&lt;/span&gt;

image_tag(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;picture.png&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;img alt=&amp;quot;Picture&amp;quot; src=&amp;quot;/images/picture.png&amp;quot; /&amp;gt;&lt;/span&gt;

image_tag(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;picture.png&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;size&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;50x40&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;alt&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Home Image&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;img src=&amp;quot;/images/picture.png&amp;quot; width=&amp;quot;50&amp;quot; height=&amp;quot;40&amp;quot; alt=&amp;quot;Home Image&amp;quot; /&amp;gt;&lt;/span&gt;

image_tag(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;/gallery/picture.png&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;size&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;img src=&amp;quot;/gallery/picture.png&amp;quot; width=&amp;quot;200&amp;quot; height=&amp;quot;200&amp;quot; alt=&amp;quot;Picture&amp;quot; /&amp;gt;&lt;/span&gt;

image_tag(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;picture.png&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;menu_img&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;img alt=&amp;quot;Picture&amp;quot; class=&amp;quot;main_img&amp;quot; src=&amp;quot;/images/picture.png&amp;quot; /&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-form&quot;&gt; 3. フォーム - &lt;code&gt;form_for / form_tag&lt;/code&gt;&lt;/h3&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;基本的な使い方(form_for と form_tag の使い分け方)&lt;/h4&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;form_for&lt;/code&gt;は、&lt;b&gt;モデルの作成や更新などモデルに紐付いたフォームを作成するため&lt;/b&gt;に使います。モデルに紐付いているので、バリデーションエラー時にエラーメッセージとエラー箇所を表示することなどができます。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;form_tag&lt;/code&gt;は、&lt;b&gt;検索やレポート出力などモデルに紐付かないフォームを作成するため&lt;/b&gt;に使います。モデルに紐付かないので、基本的にはバリデーションはできません。メソッドは&lt;code&gt;label_tag&lt;/code&gt;など&lt;code&gt;xxx_tag&lt;/code&gt;メソッドを使います。&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;form_for(record, options = {} &amp;amp;block)
form_tag(url_for_options = {}&amp;lt; options = {}, &amp;amp;block)
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;オプション&lt;/h4&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;url&lt;/code&gt; ... submitするURL。&lt;code&gt;form_for&lt;/code&gt;の場合、モデルから自動的にURLが生成されるため必ずしも必要ではない。&lt;code&gt;form_tag&lt;/code&gt;の場合、必ず必要。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;method&lt;/code&gt; ... &lt;code&gt;:get&lt;/code&gt;, &lt;code&gt;:post&lt;/code&gt;, &lt;code&gt;:patch&lt;/code&gt;, &lt;code&gt;:delete&lt;/code&gt; を指定することで、フォームのGET, POSTなどのHTTPメソッドを定義できる&lt;/li&gt;
&lt;li&gt;&lt;code&gt;remote&lt;/code&gt; ... &lt;code&gt;true&lt;/code&gt;を設定するとAjaxのsubmitになる。（デフォルト: false）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;html&lt;/code&gt; ... formタグのHTML属性を指定する&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= form_for &lt;span class=&quot;synIdentifier&quot;&gt;@user&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;remote&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:html&lt;/span&gt; =&amp;gt; { &lt;span class=&quot;synConstant&quot;&gt;:class&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;form-horizontal&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:role&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; } &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;f&lt;/span&gt;| %&amp;gt;
  &lt;span class=&quot;synComment&quot;&gt;# userの属性を指定&lt;/span&gt;
  &amp;lt;%= f.text_field &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt; %&amp;gt;
  &amp;lt;%= f.number_field &lt;span class=&quot;synConstant&quot;&gt;:age&lt;/span&gt; %&amp;gt;
  ...
  &amp;lt;%= f.submit %&amp;gt;
&amp;lt;% &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt; %&amp;gt;


&lt;span class=&quot;synComment&quot;&gt;# config/routes.rb の resources が次のように入れ子の場合、&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#  resources :users do&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#    resources :comments&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#  end&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# form_forにモデルを配列で指定する&lt;/span&gt;
&amp;lt;%= form_for [&lt;span class=&quot;synIdentifier&quot;&gt;@usre&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;@comments&lt;/span&gt;] &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;f&lt;/span&gt;| %&amp;gt;
  &amp;lt;!-- commentの属性を指定 --&amp;gt;
  &amp;lt;%= f.text_field &lt;span class=&quot;synConstant&quot;&gt;:content&lt;/span&gt; %&amp;gt;
  ...
&amp;lt;% &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt; %&amp;gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-fileds_for&quot;&gt; 4. 関連モデルのフォームを作成 - &lt;code&gt;fields_for&lt;/code&gt;&lt;/h3&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;has_one&lt;/code&gt;や&lt;code&gt;has_many&lt;/code&gt;で関連づいたモデルも同時に作成/更新できるフォームを作成します。&lt;br /&gt;
次のようにモデルごとにフォームを入れ子にします。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; form_for&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; @user do |f| %&amp;gt;&lt;/span&gt;
  ...
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.fields_for&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :address do |address_fields| %&amp;gt;&lt;/span&gt;
    Street  : &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; address_fields.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :street %&amp;gt;&lt;/span&gt;
    Zip code: &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; address_fields.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :zip_code %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
  ...
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
関連モデルの作成/更新をするには、ビューだけでなくモデルやコントローラーにも実装が必要です。一般的に&lt;code&gt;fields_for&lt;/code&gt;と一緒に&lt;code&gt;accepts_nested_attributes_for&lt;/code&gt;を使います。&lt;br /&gt;
関連モデルも一度に作成/更新するフォームを作りたい場合は、「&lt;a href=&quot;http://ruby-rails.hatenadiary.com/entry/20141208/1418018874&quot;&gt;Rails&amp;#x3067;accepts_nested_attributes_for&amp;#x3068;fields_for&amp;#x3092;&amp;#x4F7F;&amp;#x3063;&amp;#x3066;has_many&amp;#x95A2;&amp;#x9023;&amp;#x306E;&amp;#x5B50;&amp;#x30EC;&amp;#x30B3;&amp;#x30FC;&amp;#x30C9;&amp;#x3092;&amp;#x4F5C;&amp;#x6210;/&amp;#x66F4;&amp;#x65B0;&amp;#x3059;&amp;#x308B;&amp;#x30D5;&amp;#x30A9;&amp;#x30FC;&amp;#x30E0;&amp;#x3092;&amp;#x4F5C;&amp;#x6210; - Rails Webook&lt;/a&gt;」を参照してください。&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-label&quot;&gt; 5. ラベル - &lt;code&gt;label / label_tag&lt;/code&gt;&lt;/h3&gt;ラベル（&lt;code&gt;label&lt;/code&gt;要素）を作成します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.label(&lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;名前&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;label for=&amp;quot;user_name&amp;quot;&amp;gt;名前&amp;lt;/label&amp;gt;&lt;/span&gt;


&amp;lt;%= label_tag(&lt;span class=&quot;synConstant&quot;&gt;:user&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;名前&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;label for=&amp;quot;user&amp;quot;&amp;gt;名前&amp;lt;/label&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-text&quot;&gt; 6. テキストフィールド - &lt;code&gt;text_field / test_field_tag&lt;/code&gt;&lt;/h3&gt;テキストフィールド（&lt;code&gt;&amp;lt;input type=&quot;text&quot;&amp;gt;&lt;/code&gt;要素）を作成します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 編集時にはvalueにはモデルのname属性の値が入る&lt;/span&gt;
&amp;lt;%= f.text_field &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;user[name]&amp;quot; id=&amp;quot;user_name&amp;quot;&amp;gt;&lt;/span&gt;


&amp;lt;%= text_field_tag &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;user[name]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;値&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;user[name]&amp;quot; id=&amp;quot;user_name&amp;quot; value=&amp;quot;値&amp;quot;&amp;gt;&lt;/span&gt;
&amp;lt;%= f.text_field(&lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;名前&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) %&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;&lt;code&gt;text_field&lt;/code&gt;のオプション&lt;/h4&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;:disabled&lt;/code&gt; ... &lt;code&gt;true&lt;/code&gt;を設定すると入力不可にできる。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:size&lt;/code&gt; ... 指定した数の文字数分だけ表示できる幅に広がる。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:maxlength&lt;/code&gt; ... ユーザが入力可能な最大文字数&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:placeholder&lt;/code&gt; ... プレイスホルダーを設定する。&lt;/li&gt;
&lt;li&gt;その他、どんなHTML属性をも設定できる。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;その他のテキストフィールド&lt;/h4&gt;
    &lt;p&gt;テキストフィールドと同じように、次のようなフィールドも作成できます。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;メールアドレスフィールド(&lt;code&gt;type=&quot;email&quot;&lt;/code&gt;) &lt;code&gt;email_field / email_field_tag&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;パスワードフィールド(&lt;code&gt;type=&quot;password&lt;/code&gt;) &lt;code&gt;password_field / password_field_tag&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;検索フィールド(&lt;code&gt;type=&quot;search&quot;&lt;/code&gt;) &lt;code&gt;search_field / search_field_tag&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;数値フィールド(&lt;code&gt;type=&quot;number&quot;&lt;/code&gt;) &lt;code&gt;number_field / number_field_tag&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;h3 id=&quot;view-helpers-datetime&quot;&gt; 7. 日付/時刻の入力フィールド - &lt;code&gt;date_field / time_field / datetime_field&lt;/code&gt;&lt;/h3&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;日付フィールド(&lt;code&gt;type=&quot;date&lt;/code&gt;)&lt;/h4&gt;
    &lt;p&gt;&lt;code&gt;date_field / date_field_tag&lt;/code&gt;で作成できます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110140026.jpg&quot; alt=&quot;f:id:nipe880324:20150110140026j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110140026j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;時刻フィールド(&lt;code&gt;type=&quot;time&lt;/code&gt;)&lt;/h4&gt;
    &lt;p&gt;&lt;code&gt;time_field / time_field &lt;/code&gt;で作成できます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110140044.jpg&quot; alt=&quot;f:id:nipe880324:20150110140044j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110140044j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;日付時刻フィールド(&lt;code&gt;input type=&quot;datetime&quot;&lt;/code&gt;)&lt;/h4&gt;
    &lt;p&gt;&lt;code&gt;datetime_field / datetime_field_tag&lt;/code&gt;で作成できます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110140057.jpg&quot; alt=&quot;f:id:nipe880324:20150110140057j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110140057j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-datetime- 8. select&quot;&gt;日付/時刻の選択フィールド - &lt;code&gt;date_select / time_select / datetime_select&lt;/code&gt;&lt;/h3&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;日付選択フィールド - &lt;code&gt;time_select&lt;/code&gt;&lt;/h4&gt;
    &lt;p&gt;日付のセレクトフィールドが作成します。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110140321.jpg&quot; alt=&quot;f:id:nipe880324:20150110140321j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110140321j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.time_select &lt;span class=&quot;synConstant&quot;&gt;:activated_at&lt;/span&gt; %&amp;gt;

&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select id=&amp;quot;user_activated_at_1i&amp;quot; name=&amp;quot;user[activated_at(1i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;2010&amp;quot;&amp;gt;2010&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;2011&amp;quot;&amp;gt;2011&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   ... 年&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;2020&amp;quot;&amp;gt;2020&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select id=&amp;quot;user_activated_at_2i&amp;quot; name=&amp;quot;user[activated_at(2i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;1&amp;quot; selected=&amp;quot;selected&amp;quot;&amp;gt;January&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;2&amp;quot;&amp;gt;Feburary&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   ... 月&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;12&amp;quot;&amp;gt;December&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select id=&amp;quot;user_activated_at_3i&amp;quot; name=&amp;quot;user[activated_at(3i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;1&amp;quot;&amp;gt;1&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;2&amp;quot;&amp;gt;2&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   ... 日&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;31&amp;quot;&amp;gt;31&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# paramsの値&lt;/span&gt;
{
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; {
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;ユーザー名&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(1i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2015&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(2i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(3i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
    },
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Create User&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
}
&lt;/pre&gt;&lt;p&gt;&lt;i&gt;様々なオプションがあるので&lt;a href=&quot;http://api.rubyonrails.org/&quot; target=&quot;_blank&quot;&gt;Rails API&lt;/a&gt;を参照してください。&lt;/i&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;時刻選択フィールド - &lt;code&gt;time_select&lt;/code&gt;&lt;/h4&gt;
    &lt;p&gt;時刻のセレクトフィールドが作成されます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110140357.jpg&quot; alt=&quot;f:id:nipe880324:20150110140357j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110140357j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.time_select &lt;span class=&quot;synConstant&quot;&gt;:activated_at&lt;/span&gt; %&amp;gt;

&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input type=&amp;quot;hidden&amp;quot; id=&amp;quot;user_activated_at_1i&amp;quot; name=&amp;quot;user[activated_at(1i)]&amp;quot; value=&amp;quot;2015&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input type=&amp;quot;hidden&amp;quot; id=&amp;quot;user_activated_at_2i&amp;quot; name=&amp;quot;user[activated_at(2i)]&amp;quot; value=&amp;quot;1&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input type=&amp;quot;hidden&amp;quot; id=&amp;quot;user_activated_at_3i&amp;quot; name=&amp;quot;user[activated_at(3i)]&amp;quot; value=&amp;quot;8&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select id=&amp;quot;user_activated_at_4i&amp;quot; name=&amp;quot;user[activated_at(4i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;00&amp;quot;&amp;gt;00&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;01&amp;quot;&amp;gt;01&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   ... 時&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;24&amp;quot;&amp;gt;24&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#  : &lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select id=&amp;quot;user_activated_at_5i&amp;quot; name=&amp;quot;user[activated_at(5i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;00&amp;quot;&amp;gt;00&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;01&amp;quot;&amp;gt;01&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   ... 分&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;59&amp;quot;&amp;gt;59&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# デフォルトだとparamsに年月日も送られます。&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# 未入力でも、勝手にデータが作成される可能性があります。&lt;/span&gt;
{
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;{
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;ユーザー名&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(1i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2015&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(2i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(3i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(4i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(5i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;59&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
  },
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Create User&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
}
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
上記で記載しましたが、場合によって、&lt;code&gt;include_blank: true&lt;/code&gt;と&lt;code&gt;ignore_date: true&lt;/code&gt;を指定することで、未入力の場合に年月日が送られないようにできます。&lt;br /&gt;
そうすることで、モデル側の&lt;code&gt;presence&lt;/code&gt;などのバリデーションを上手く機能させることができるようになります。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.time_select &lt;span class=&quot;synConstant&quot;&gt;:activated_at&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;include_blank&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;ignore_date&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt; %&amp;gt;

&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# 年月日のhiddenフィールドが作成されない&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select id=&amp;quot;user_activated_at_4i&amp;quot; name=&amp;quot;user[activated_at(4i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;00&amp;quot;&amp;gt;00&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;01&amp;quot;&amp;gt;01&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   ... 時&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;24&amp;quot;&amp;gt;24&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#  : &lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select id=&amp;quot;user_activated_at_5i&amp;quot; name=&amp;quot;user[activated_at(5i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;00&amp;quot;&amp;gt;00&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;01&amp;quot;&amp;gt;01&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   ... 分&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;59&amp;quot;&amp;gt;59&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# 年月日がparamsになくなる&lt;/span&gt;
{
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; {
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;値&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(4i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(5i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
  },
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Create User&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
}
&lt;/pre&gt;&lt;p&gt;&lt;i&gt;他にも秒数を表示など様々なオプションがあるので&lt;a href=&quot;http://api.rubyonrails.org/&quot; target=&quot;_blank&quot;&gt;Rails API&lt;/a&gt;を参照してください。&lt;/i&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;日付時刻選択フィールド - &lt;code&gt;datetime_select&lt;/code&gt;&lt;/h4&gt;
    &lt;p&gt;日付と時刻のセレクトフィールドが作成されます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110141729.jpg&quot; alt=&quot;f:id:nipe880324:20150110141729j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110141729j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.datetime_select &lt;span class=&quot;synConstant&quot;&gt;:activated_at&lt;/span&gt; %&amp;gt;

&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;div class=&amp;quot;field&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select id=&amp;quot;user_activated_at_1i&amp;quot; name=&amp;quot;user[activated_at(1i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;2015&amp;quot; selected=&amp;quot;selected&amp;quot;&amp;gt;2015&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;2016&amp;quot;&amp;gt;2016&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#     ... 年&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select id=&amp;quot;user_activated_at_2i&amp;quot; name=&amp;quot;user[activated_at(2i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;1&amp;quot; selected=&amp;quot;selected&amp;quot;&amp;gt;January&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;2&amp;quot;&amp;gt;February&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#     ... 月&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;12&amp;quot;&amp;gt;December&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select id=&amp;quot;user_activated_at_3i&amp;quot; name=&amp;quot;user[activated_at(3i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;1&amp;quot;&amp;gt;1&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;2&amp;quot;&amp;gt;2&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#     ... 日&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;31&amp;quot;&amp;gt;31&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#  —&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select id=&amp;quot;user_activated_at_4i&amp;quot; name=&amp;quot;user[activated_at(4i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;00&amp;quot;&amp;gt;00&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;01&amp;quot;&amp;gt;01&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#     ... 時&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;23&amp;quot;&amp;gt;23&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#  :&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#  &amp;lt;select id=&amp;quot;user_activated_at_5i&amp;quot; name=&amp;quot;user[activated_at(5i)]&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;00&amp;quot;&amp;gt;00&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;01&amp;quot;&amp;gt;01&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#     ... 分&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;59&amp;quot;&amp;gt;59&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# paramsは年月日と時刻が送られれます。&lt;/span&gt;
{
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; {
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;ユーザー名&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(1i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2015&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(2i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(3i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(4i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;activated_at(5i)&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;09&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
  },
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Create User&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
}
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-file&quot;&gt; 9. ファイルアップロードフィールド - &lt;code&gt;file_field / file_field_tag&lt;/code&gt;&lt;/h3&gt;ファイルをアップロードするための&lt;code&gt;&amp;lt;input type=&quot;file&quot;&amp;gt;&lt;/code&gt;要素を作成します。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110140555.jpg&quot; alt=&quot;f:id:nipe880324:20150110140555j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110140555j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.file_field(&lt;span class=&quot;synConstant&quot;&gt;:iamge&lt;/span&gt;) %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;input type=&amp;quot;file&amp;quot; name=&amp;quot;user[image]&amp;quot; id=&amp;quot;user_image&amp;quot;&amp;gt;&lt;/span&gt;


&amp;lt;%= file_field_tag &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;user[image]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;input type=&amp;quot;file&amp;quot; name=&amp;quot;user[image]&amp;quot; id=&amp;quot;user_image&amp;quot;&amp;gt;&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# form_for の場合は必要ないが、form_tagの場合、form_tag に multipart: true オプションが必要。&lt;/span&gt;
&amp;lt;%= form_tag &lt;span class=&quot;synConstant&quot;&gt;url&lt;/span&gt;: upload_users_path, &lt;span class=&quot;synConstant&quot;&gt;multipart&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;f&lt;/span&gt;| %&amp;gt;
  &amp;lt;%= f.file_field(&lt;span class=&quot;synConstant&quot;&gt;:iamge&lt;/span&gt;) %&amp;gt;
&amp;lt;% &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt; %&amp;gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-text_area&quot;&gt;10. テキストエリア - &lt;code&gt;text_area / text_area_tag&lt;/code&gt;&lt;/h3&gt;テキストエリアを作成します。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110141743.jpg&quot; alt=&quot;f:id:nipe880324:20150110141743j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110141743j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.text_area &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;input type=&amp;quot;file&amp;quot; name=&amp;quot;user[image]&amp;quot; id=&amp;quot;user_image&amp;quot;&amp;gt;&lt;/span&gt;


&amp;lt;%= text_area_tag &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;user[name]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;値&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;textarea name=&amp;quot;user[name]&amp;quot; id=&amp;quot;user_name&amp;quot;&amp;gt;値&amp;lt;/textarea&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;オプション&lt;/h4&gt;
    
&lt;ul&gt;
&lt;li&gt;:size - A string specifying the dimensions (columns by rows) of the textarea (e.g., “25x10”).&lt;/li&gt;
&lt;li&gt;:rows - Specify the number of rows in the textarea&lt;/li&gt;
&lt;li&gt;:cols - Specify the number of columns in the textarea&lt;/li&gt;
&lt;li&gt;:disabled - If set to true, the user will not be able to use this input.&lt;/li&gt;
&lt;li&gt;:escape - By default, the contents of the text input are HTML escaped. If you need unescaped contents, set this to false.&lt;/li&gt;
&lt;li&gt;Any other key creates standard HTML attributes for the tag.&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-select&quot;&gt;11. プルダウン/セレクトボックス - &lt;code&gt;select / select_tag / collection_select&lt;/code&gt;&lt;/h3&gt;プルダウンである&lt;code&gt;select&lt;/code&gt;要素が作成されます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110141809.jpg&quot; alt=&quot;f:id:nipe880324:20150110141809j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110141809j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# どのメソッド結果は同じです&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# 「属性名」、「配列データ」,「Option要素のvalueに設定するカラム名」, 「Option要素に表示するカラム名」の順で指定します。&lt;/span&gt;
&amp;lt;%= f.select &lt;span class=&quot;synConstant&quot;&gt;:prefecture_id&lt;/span&gt;, &lt;span class=&quot;synType&quot;&gt;Prefecture&lt;/span&gt;.all.map { |&lt;span class=&quot;synIdentifier&quot;&gt;p&lt;/span&gt;| [p.name, p.id] } %&amp;gt;
&amp;lt;%= select_tag &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;address[prefeture_id]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, options_from_collection_for_select(&lt;span class=&quot;synType&quot;&gt;Prefecture&lt;/span&gt;.all, &lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;) %&amp;gt;
&amp;lt;%= f.collection_select &lt;span class=&quot;synConstant&quot;&gt;:prefecture_id&lt;/span&gt;, &lt;span class=&quot;synType&quot;&gt;Prefecture&lt;/span&gt;.all, &lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;select name=&amp;quot;address[prefecture_id]&amp;quot; id=&amp;quot;address_prefecture_id&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;1&amp;quot;&amp;gt;東京都&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;2&amp;quot;&amp;gt;神奈川県&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   &amp;lt;option value=&amp;quot;3&amp;quot;&amp;gt;埼玉県&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;オプション&lt;/h4&gt;
    
&lt;ul&gt;
&lt;li&gt;:multiple - If set to true the selection will allow multiple choices.&lt;/li&gt;
&lt;li&gt;:disabled - If set to true, the user will not be able to use this input.&lt;/li&gt;
&lt;li&gt;:include_blank - If set to true, an empty option will be created. If set to a string, the string will be used as the option&#39;s content and the value will be empty.&lt;/li&gt;
&lt;li&gt;:prompt - Create a prompt option with blank value and the text asking user to select something.&lt;/li&gt;
&lt;li&gt;:selected - Provide a default selected value. It should be of the exact type as the provided options.&lt;/li&gt;
&lt;li&gt;Any other key creates standard HTML attributes for the tag.&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;br /&gt;
また、&lt;a href=&quot;https://select2.github.io/&quot; target=&quot;_blank&quot;&gt;select2&lt;/a&gt;という検索可能なプルダウンを作成するjQueryプラグインもあります。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110141855.jpg&quot; alt=&quot;f:id:nipe880324:20150110141855j:plain:w220&quot; title=&quot;f:id:nipe880324:20150110141855j:plain:w220&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:220px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Railsへの導入方法は、「&lt;a href=&quot;http://ruby-rails.hatenadiary.com/entry/20141112/1415804076&quot; target=&quot;_blank&quot;&gt;Railsで検索可能なセレクトボックスのselect2を使う方法&lt;/a&gt;]」を参照してください。&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-check_box&quot;&gt;12. チェックボックス - &lt;code&gt;check_box / check_box_tag / collection_check_boxes&lt;/code&gt;&lt;/h3&gt;チェックボックスが作成されます。&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;単一のチェックボックスの作成&lt;/h4&gt;
    &lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110140828.jpg&quot; alt=&quot;f:id:nipe880324:20150110140828j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110140828j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# チェックボックスを1つ作成する&lt;/span&gt;
&amp;lt;%= f.check_box &lt;span class=&quot;synConstant&quot;&gt;:discontinued&lt;/span&gt; %&amp;gt; &amp;lt;%= f.label &lt;span class=&quot;synConstant&quot;&gt;:discontinued&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;販売停止&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input name=&amp;quot;product[discontinued]&amp;quot; type=&amp;quot;hidden&amp;quot; value=&amp;quot;0&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input type=&amp;quot;checkbox&amp;quot; value=&amp;quot;1&amp;quot; name=&amp;quot;product[discontinued]&amp;quot; id=&amp;quot;product_discontinued&amp;quot;&amp;gt; &amp;lt;label for=&amp;quot;user_discontinued&amp;quot;&amp;gt;販売停止&amp;lt;/label&amp;gt;&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# チェックボックスを1つ作成する&lt;/span&gt;
&amp;lt;%= check_box_tag &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product[discontinued]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt; &amp;lt;%= label_tag &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product[discontinued]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;販売停止&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;product[discontinued]&amp;quot; id=&amp;quot;product_discontinued&amp;quot; value=&amp;quot;1&amp;quot;&amp;gt; &amp;lt;label for=&amp;quot;product_discontinued&amp;quot;&amp;gt;販売停止&amp;lt;/label&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;複数のチェックボックスの作成&lt;/h4&gt;
    &lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110140843.jpg&quot; alt=&quot;f:id:nipe880324:20150110140843j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110140843j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;ProductとCategoryが「N対N関係」である前提でビューを記載しています。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;% &lt;span class=&quot;synType&quot;&gt;Category&lt;/span&gt;.all.each &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;category&lt;/span&gt;| %&amp;gt;
  &amp;lt;%= check_box_tag &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product[category_ids][]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, category.id, &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.categories.include?(category), &lt;span class=&quot;synConstant&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_category_ids_&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;#{&lt;/span&gt;category.id&lt;span class=&quot;synSpecial&quot;&gt;}&amp;quot;&lt;/span&gt; %&amp;gt;
  &amp;lt;%= label_tag &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product[category_ids][&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;#{&lt;/span&gt;category.id&lt;span class=&quot;synSpecial&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, category.name %&amp;gt;
&amp;lt;% &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt; %&amp;gt;

&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;product[category_ids][]&amp;quot; id=&amp;quot;product_category_ids_1&amp;quot; value=&amp;quot;1&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;label for=&amp;quot;product_category_ids_1&amp;quot;&amp;gt;カテゴリ1&amp;lt;/label&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;product[category_ids][]&amp;quot; id=&amp;quot;product_category_ids_2&amp;quot; value=&amp;quot;2&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;label for=&amp;quot;product_category_ids_2&amp;quot;&amp;gt;カテゴリ2&amp;lt;/label&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input type=&amp;quot;checkbox&amp;quot; name=&amp;quot;product[category_ids][]&amp;quot; id=&amp;quot;product_category_ids_3&amp;quot; value=&amp;quot;3&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;label for=&amp;quot;product_category_ids_3&amp;quot;&amp;gt;カテゴリ3&amp;lt;/label&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# paramsは次のようになります。&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# チェック0個の場合&lt;/span&gt;
&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;{&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;}
&lt;span class=&quot;synComment&quot;&gt;# チェック1個以上&lt;/span&gt;
&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;{&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, category_ids&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;=&amp;gt;[&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;]}&lt;/span&gt;


&lt;span class=&quot;synConstant&quot;&gt;# コントローラーのStrongParameters部分では、category_ids =&amp;gt; [] と記載し配列を許可するようにします。&lt;/span&gt;
&lt;span class=&quot;synConstant&quot;&gt;def product_params&lt;/span&gt;
&lt;span class=&quot;synConstant&quot;&gt;  params.require(:product).permit(:name, :category_ids =&amp;gt; [])&lt;/span&gt;
&lt;span class=&quot;synConstant&quot;&gt;end&lt;/span&gt;


&lt;span class=&quot;synConstant&quot;&gt;# 「多対多関係」をモデルで定義しておくとProductのcateogyr_ids属性に配列でカテゴリIDを設定することでhas_manyメソッドのおかげで複数のINERT文が走ります。&lt;/span&gt;
&lt;span class=&quot;synConstant&quot;&gt;Parameters: {product&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;{&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Aaa&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;price&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;category_ids&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;[&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;]}, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Create Product&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;}
&lt;span class=&quot;synType&quot;&gt;Category&lt;/span&gt; Load (&lt;span class=&quot;synConstant&quot;&gt;0&lt;/span&gt;.3ms)  &lt;span class=&quot;synType&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;.* &lt;span class=&quot;synType&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;categories&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;.&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; IN (&lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt;)
&lt;span class=&quot;synStatement&quot;&gt;begin&lt;/span&gt; transaction
  &lt;span class=&quot;synComment&quot;&gt;# Prodctに1レコード追加される&lt;/span&gt;
  SQL (&lt;span class=&quot;synConstant&quot;&gt;0&lt;/span&gt;.4ms)  &lt;span class=&quot;synType&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;products&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; (&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;price&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) VALUES (&lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?)&lt;/span&gt;  [[&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Aaa&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;price&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;100&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2015-01-10 03:51:29.408266&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2015-01-10 03:51:29.408266&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;]]
  &lt;span class=&quot;synComment&quot;&gt;# ProductとCategoryの中間テーブルが2列追加されている&lt;/span&gt;
  SQL (&lt;span class=&quot;synConstant&quot;&gt;0&lt;/span&gt;.2ms)  &lt;span class=&quot;synType&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_categories&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; (&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;category_id&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_id&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) VALUES (&lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?)&lt;/span&gt;  [[&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;category_id&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_id&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2015-01-10 03:51:29.410606&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2015-01-10 03:51:29.410606&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;]]
  SQL (&lt;span class=&quot;synConstant&quot;&gt;0&lt;/span&gt;.1ms)  &lt;span class=&quot;synType&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_categories&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; (&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;category_id&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_id&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) VALUES (&lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?)&lt;/span&gt;  [[&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;category_id&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_id&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2015-01-10 03:51:29.414744&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2015-01-10 03:51:29.414744&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;]]
commit transaction
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
同じく「多対多関連」が前提で、次のような記載方法もあります。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.collection_check_boxes &lt;span class=&quot;synConstant&quot;&gt;:category_ids&lt;/span&gt;, &lt;span class=&quot;synType&quot;&gt;Category&lt;/span&gt;.all, &lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt; %&amp;gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-radio_button&quot;&gt;13. ラジオボタン - &lt;code&gt;radio_button, radio_button_tag&lt;/code&gt;&lt;/h3&gt;ラジオボタンを作成します。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110140911.jpg&quot; alt=&quot;f:id:nipe880324:20150110140911j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110140911j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.label &lt;span class=&quot;synConstant&quot;&gt;:rate&lt;/span&gt; %&amp;gt;&amp;lt;br&amp;gt;
&amp;lt;%= f.radio_button &lt;span class=&quot;synConstant&quot;&gt;:rate&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt; %&amp;gt; &amp;lt;%= f.label &lt;span class=&quot;synConstant&quot;&gt;:rate_1&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt; %&amp;gt;
&amp;lt;%= f.radio_button &lt;span class=&quot;synConstant&quot;&gt;:rate&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt; %&amp;gt; &amp;lt;%= f.label &lt;span class=&quot;synConstant&quot;&gt;:rate_2&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt; %&amp;gt;
&amp;lt;%= f.radio_button &lt;span class=&quot;synConstant&quot;&gt;:rate&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt; %&amp;gt; &amp;lt;%= f.label &lt;span class=&quot;synConstant&quot;&gt;:rate_3&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt; %&amp;gt;
&amp;lt;%= f.radio_button &lt;span class=&quot;synConstant&quot;&gt;:rate&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;4&lt;/span&gt; %&amp;gt; &amp;lt;%= f.label &lt;span class=&quot;synConstant&quot;&gt;:rate_4&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;4&lt;/span&gt; %&amp;gt;
&amp;lt;%= f.radio_button &lt;span class=&quot;synConstant&quot;&gt;:rate&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;5&lt;/span&gt; %&amp;gt; &amp;lt;%= f.label &lt;span class=&quot;synConstant&quot;&gt;:rate_5&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;5&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt;&lt;/span&gt;
&amp;lt;label &lt;span class=&quot;synStatement&quot;&gt;for&lt;/span&gt;=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_rate&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&amp;gt;&lt;span class=&quot;synType&quot;&gt;Rate&lt;/span&gt;&amp;lt;/label&amp;gt;&amp;lt;br&amp;gt;
&amp;lt;input type=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;radio&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; value=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; name=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product[rate]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; id=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_rate_1&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&amp;gt; &amp;lt;label &lt;span class=&quot;synStatement&quot;&gt;for&lt;/span&gt;=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_rate_1&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&amp;gt;&lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;&amp;lt;/label&amp;gt;
&amp;lt;input type=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;radio&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; value=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; name=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product[rate]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; id=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_rate_2&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&amp;gt; &amp;lt;label &lt;span class=&quot;synStatement&quot;&gt;for&lt;/span&gt;=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_rate_2&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&amp;gt;&lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt;&amp;lt;/label&amp;gt;
&amp;lt;input type=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;radio&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; value=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; name=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product[rate]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; id=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_rate_3&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&amp;gt; &amp;lt;label &lt;span class=&quot;synStatement&quot;&gt;for&lt;/span&gt;=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_rate_3&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&amp;gt;&lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt;&amp;lt;/label&amp;gt;
&amp;lt;input type=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;radio&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; value=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; name=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product[rate]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; id=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_rate_4&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&amp;gt; &amp;lt;label &lt;span class=&quot;synStatement&quot;&gt;for&lt;/span&gt;=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_rate_4&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&amp;gt;&lt;span class=&quot;synConstant&quot;&gt;4&lt;/span&gt;&amp;lt;/label&amp;gt;
&amp;lt;input type=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;radio&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; value=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; name=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product[rate]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; id=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_rate_5&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&amp;gt; &amp;lt;label &lt;span class=&quot;synStatement&quot;&gt;for&lt;/span&gt;=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product_rate_5&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&amp;gt;&lt;span class=&quot;synConstant&quot;&gt;5&lt;/span&gt;&amp;lt;/label&amp;gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
セレクトボックスのように一度にモデルの配列を返すことで、ラジオボックスを作成することも可能です。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.collection_radio_buttons &lt;span class=&quot;synConstant&quot;&gt;:maker_id&lt;/span&gt;, &lt;span class=&quot;synType&quot;&gt;Maker&lt;/span&gt;.all, &lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input type=&amp;quot;radio&amp;quot; value=&amp;quot;1&amp;quot; name=&amp;quot;product[maker_id]&amp;quot; id=&amp;quot;product_maker_id_1&amp;quot;&amp;gt;&amp;lt;label for=&amp;quot;product_maker_id_1&amp;quot;&amp;gt;カテゴリ1# &amp;lt;/label&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input type=&amp;quot;radio&amp;quot; value=&amp;quot;2&amp;quot; name=&amp;quot;product[maker_id]&amp;quot; id=&amp;quot;product_maker_id_2&amp;quot;&amp;gt;&amp;lt;label for=&amp;quot;product_maker_id_2&amp;quot;&amp;gt;カテゴリ2# &amp;lt;/label&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# &amp;lt;input type=&amp;quot;radio&amp;quot; value=&amp;quot;3&amp;quot; name=&amp;quot;product[maker_id]&amp;quot; id=&amp;quot;product_maker_id_3&amp;quot;&amp;gt;&amp;lt;label for=&amp;quot;product_maker_id_3&amp;quot;&amp;gt;カテゴリ3# &amp;lt;/label&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;view-helpers-hidden&quot;&gt;14. hiddenフィールド - &lt;code&gt;hidden_field / hidden_field_tag&lt;/code&gt;&lt;/h3&gt;隠し入力フィールド（画面に表示されない）を作成できます。&lt;br /&gt;
&lt;i&gt;ユーザーからhiddenフィールドの値を見ることができるので、ユーザーに見られて困る秘密情報は載せないようにする必要があります。&lt;/i&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.hidden_field &lt;span class=&quot;synConstant&quot;&gt;:lock_version&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;input type=&amp;quot;hidden&amp;quot; name=&amp;quot;product[lock_version]&amp;quot; id=&amp;quot;product_lock_version&amp;quot; value=&amp;quot;1&amp;quot;&amp;gt;&lt;/span&gt;


&amp;lt;%= hidden_field_tag &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product[lock_version]&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.lock_version %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;input type=&amp;quot;hidden&amp;quot; name=&amp;quot;product[lock_version]&amp;quot; id=&amp;quot;product_lock_version&amp;quot; value=&amp;quot;1&amp;quot;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;h3 id=&quot;view-helpers-submit&quot;&gt;15. サブミットボタン - &lt;code&gt;submit / submit_tag&lt;/code&gt;&lt;/h3&gt;サブミットボタンを作成します。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20150110/20150110141646.jpg&quot; alt=&quot;f:id:nipe880324:20150110141646j:plain:w180&quot; title=&quot;f:id:nipe880324:20150110141646j:plain:w180&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:180px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.submit &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;登録&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;input type=&amp;quot;submit&amp;quot; name=&amp;quot;commit&amp;quot; value=&amp;quot;登録&amp;quot;&amp;gt;&lt;/span&gt;

&amp;lt;%= submit_tag &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;検索&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
 &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;input type=&amp;quot;submit&amp;quot; name=&amp;quot;commit&amp;quot; value=&amp;quot;検索&amp;quot;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
１つのフォームに複数のサブミットボタンを追加して処理を分けたい場合は、「&lt;a href=&quot;http://ruby-rails.hatenadiary.com/entry/20141225/1419515057&quot; target=&quot;_blank&quot;&gt;Railsで１フォームに複数のサブミット(Submit)ボタンを配置するTips&lt;a/&gt;」を参照してください。&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;以上です。&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;参考文献&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://api.rubyonrails.org/&quot;&gt;Ruby on Rails API&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;</description>
          <pubDate>Tue, 13 Jan 2015 20:37:41 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/8454420450079810257</guid>
          
            <category>Rails初級</category>
          
            <category>Rails View</category>
          
            <category>まとめ</category>
          
        </item>
      
    
      
      
        <item>
          <title>RailsでVirtual Attributes(仮想的な属性)をする</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20141229/1419856433</link>
          <description>&lt;p&gt;Virtual Attributesとは、モデルのDBに存在しない仮想的な属性のことです。&lt;br /&gt;
モデルにVirtual Attributesを追加することで、DBを変更しないでフォームを変更することができるようになります。&lt;/p&gt;&lt;p&gt;言葉ではいまいち分かりづらいので、次のような、「名前」の入力フィールドと「グループ」のセレクトボックスがある画面を、&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141206/20141206212234.png&quot; alt=&quot;f:id:nipe880324:20141206212234p:plain:w420&quot; title=&quot;f:id:nipe880324:20141206212234p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;Virtual Attributesを使って、DBのカラムを変更しないで、「名前」が「苗字」と「氏名」に分かれ、グループを追加する入力フィールドを追加できます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141206/20141206212239.png&quot; alt=&quot;f:id:nipe880324:20141206212239p:plain:w420&quot; title=&quot;f:id:nipe880324:20141206212239p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;Virtual Attributesの使いどころとして、DBをマイグレートするのが大変、その他なんらかの理由によりDBをいじれない場合に、モデルにVirtual Attributesを追加することでフォームの内容を変更することが可能です。&lt;br /&gt;
もちろん、バリデーションも行えます。&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;Rails 4.1&lt;/li&gt;
&lt;li&gt;ActiveRecord 4.1.7&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;目次&lt;/h3&gt;
    
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;#virtual-attributes-first-last-name&quot;&gt;名前入力欄を苗字と氏名入力欄に分ける&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#virtual-attributes-new-group-name&quot;&gt;新規グループ入力欄を追加する&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;virtual-attributes-first-last-name&quot;&gt;1. 名前入力欄を苗字と氏名入力欄に分ける&lt;/h3&gt;&lt;/p&gt;&lt;p&gt;まず、フォームを修正し、「苗字」と「氏名」の入力フィールドを追加します。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# users/_form.html.erb

&lt;span class=&quot;synComment&quot;&gt;&amp;lt;!-- 変更前&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;&amp;lt;div class=&amp;quot;field&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;  &amp;lt;%= f.label :name %&amp;gt;&amp;lt;br&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;  &amp;lt;%= f.text_field :name %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;--&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;&amp;lt;!-- 変更後 --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :last_name, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;苗字&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :last_name %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :first_name, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;氏名&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :first_name %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
この状態で画面にアクセスすると、&lt;code&gt;undefined method `last_name&#39; for User&lt;/code&gt;という例外が発生します。&lt;br /&gt;
そのため、モデルにVirtual Attributes(仮想的な属性)として、&lt;code&gt;last_name&lt;/code&gt;と&lt;code&gt;first_name&lt;/code&gt;を追加します。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;フォームからの first_name と last_name という入力を、結合し、DBのnameカラムに保存しています。&lt;/li&gt;
&lt;li&gt;また、DBのnameカラムを取得し、分割し、フォームの first_name と last_name として返しています。&lt;/li&gt;
&lt;li&gt;あとは、バリデーションエラー時の新規画面(new.html.erb)を再表示した際にデータを保持しておく必要があるので、インスタンス変数の値を使っています。&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/models/user.rb&lt;/span&gt;

&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;User&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  belongs_to &lt;span class=&quot;synConstant&quot;&gt;:group&lt;/span&gt;

  validates &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;,       &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# 追加箇所開始&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# セッターを定義。new, create, updateなどのときに設定される&lt;/span&gt;
  &lt;span class=&quot;synStatement&quot;&gt;attr_writer&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;:last_name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:first_name&lt;/span&gt;

  validates &lt;span class=&quot;synConstant&quot;&gt;:last_name&lt;/span&gt;,  &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:first_name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;

  before_validation &lt;span class=&quot;synConstant&quot;&gt;:set_name&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# 画面表示時に呼ばれる&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;last_name&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;@last_name&lt;/span&gt; || &lt;span class=&quot;synConstant&quot;&gt;self&lt;/span&gt;.name.split(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;).first &lt;span class=&quot;synStatement&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;self&lt;/span&gt;.name.present?
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# 画面表示時に呼ばれる&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;first_name&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;@first_name&lt;/span&gt; || &lt;span class=&quot;synConstant&quot;&gt;self&lt;/span&gt;.name.split(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;).last &lt;span class=&quot;synStatement&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;self&lt;/span&gt;.name.present?
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# DBのカラムはnameのため、last_nameとfirst_nameを&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# バリデーションの前に結合させて、設定しておく必要がある&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;set_name&lt;/span&gt;
    &lt;span class=&quot;synConstant&quot;&gt;self&lt;/span&gt;.name = [&lt;span class=&quot;synIdentifier&quot;&gt;@last_name&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;@first_name&lt;/span&gt;].join(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# 追加箇所終了&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
これで、例外は発生しなくなりました。&lt;br /&gt;
では、コントローラのStrongParametersで&lt;code&gt;last_name&lt;/code&gt;と&lt;code&gt;first_name&lt;/code&gt;の入力を許可させます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;user_params&lt;/span&gt;
  params.require(&lt;span class=&quot;synConstant&quot;&gt;:user&lt;/span&gt;).permit(&lt;span class=&quot;synConstant&quot;&gt;:last_name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:first_name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:group_id&lt;/span&gt;)
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、サーバーを起動して動作を確認します。&lt;br /&gt;
「苗字」や「氏名」が入力されていないとバリデーションエラーになります。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141206/20141206213818.png&quot; alt=&quot;f:id:nipe880324:20141206213818p:plain:w420&quot; title=&quot;f:id:nipe880324:20141206213818p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;もちろん、「苗字」と「氏名」を入力すれば、「苗字」と「氏名」を結合した値が名前(name)としてDBに保存され、画面に表示されます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141206/20141206213934.png&quot; alt=&quot;f:id:nipe880324:20141206213934p:plain:w420&quot; title=&quot;f:id:nipe880324:20141206213934p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;virtual-attributes-new-group-name&quot;&gt;2. 新規グループ入力欄を追加する&lt;/h3&gt;次は、新規グループの入力欄を追加します。&lt;br /&gt;
まずは、フォームに入力欄を追加します。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/users/_form.html.erb

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :group_id %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.select&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :group_id, Group.order(:&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;).map { |g| [g.&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, g.&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;] }, include_blank: true %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;&amp;lt;!-- 追加箇所 開始 --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :new_group_name, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;グループを追加:&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :new_group_name %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;&amp;lt;!-- 追加箇所 終了 --&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
この状態で画面にアクセスすると、&lt;code&gt;undefined method `new_group_name&#39; for User&lt;/code&gt;という例外が発生します。&lt;br /&gt;
そのため、モデルにVirtual Attributes(仮想的な属性)として&lt;code&gt;new_group_name&lt;/code&gt;を追加します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/models/user.rb&lt;/span&gt;

&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;User&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;synStatement&quot;&gt;attr_writer&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;:last_name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:first_name&lt;/span&gt;

  belongs_to &lt;span class=&quot;synConstant&quot;&gt;:group&lt;/span&gt;

  validates &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;,       &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:last_name&lt;/span&gt;,  &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:first_name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;

  before_validation &lt;span class=&quot;synConstant&quot;&gt;:set_name&lt;/span&gt;

  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;last_name&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;@last_name&lt;/span&gt; || &lt;span class=&quot;synConstant&quot;&gt;self&lt;/span&gt;.name.split(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;).first &lt;span class=&quot;synStatement&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;self&lt;/span&gt;.name.present?
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;first_name&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;@first_name&lt;/span&gt; || &lt;span class=&quot;synConstant&quot;&gt;self&lt;/span&gt;.name.split(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;).last &lt;span class=&quot;synStatement&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;self&lt;/span&gt;.name.present?
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;set_name&lt;/span&gt;
    &lt;span class=&quot;synConstant&quot;&gt;self&lt;/span&gt;.name = [&lt;span class=&quot;synIdentifier&quot;&gt;@last_name&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;@first_name&lt;/span&gt;].join(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# 追加箇所 開始&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# データの変換は必要ないので単純にattr_accessorで読み書きを可能にしている&lt;/span&gt;
  &lt;span class=&quot;synStatement&quot;&gt;attr_accessor&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;:new_group_name&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# バリデーション前にグループのバリデーションをする&lt;/span&gt;
  before_validation &lt;span class=&quot;synConstant&quot;&gt;:build_group&lt;/span&gt;

  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;build_group&lt;/span&gt;
    &lt;span class=&quot;synComment&quot;&gt;# new_group_nameが設定されたいない場合は、グループを作成しない&lt;/span&gt;
    &lt;span class=&quot;synComment&quot;&gt;# ため、アーリーリターンをする&lt;/span&gt;
    &lt;span class=&quot;synStatement&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;synStatement&quot;&gt;if&lt;/span&gt; new_group_name.blank?

    &lt;span class=&quot;synIdentifier&quot;&gt;@group&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;Group&lt;/span&gt;.new &lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;: new_group_name
    &lt;span class=&quot;synStatement&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;@group&lt;/span&gt;.valid?
      &lt;span class=&quot;synComment&quot;&gt;# グループのバリデーションエラーが発生しなかった場合、&lt;/span&gt;
      &lt;span class=&quot;synComment&quot;&gt;# 値を設定しておく。Userを保存するときにグループも一緒に作成される &lt;/span&gt;
      &lt;span class=&quot;synConstant&quot;&gt;self&lt;/span&gt;.group = &lt;span class=&quot;synIdentifier&quot;&gt;@group&lt;/span&gt;
    &lt;span class=&quot;synStatement&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;synComment&quot;&gt;# グループのバリデーションエラーが発生した場合、&lt;/span&gt;
      &lt;span class=&quot;synComment&quot;&gt;# グループのバリデーションエラーのメッセージをUserモデルに設定&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;@group&lt;/span&gt;.errors.each &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;_&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;message&lt;/span&gt;|
        errors.add &lt;span class=&quot;synConstant&quot;&gt;:new_group_name&lt;/span&gt;, message
      &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# 追加箇所 終了&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;


ちなみに、グループ(&lt;span class=&quot;synType&quot;&gt;Group&lt;/span&gt;)のバリデーションは次のようになっています。
&amp;gt;|ruby|
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;Group&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  has_many &lt;span class=&quot;synConstant&quot;&gt;:users&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;uniqueness&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、StrongParametersで&lt;code&gt;new_group_name&lt;/code&gt;を許可するようにします。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;user_params&lt;/span&gt;
  params.require(&lt;span class=&quot;synConstant&quot;&gt;:user&lt;/span&gt;).permit(&lt;span class=&quot;synConstant&quot;&gt;:last_name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:first_name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:group_id&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:new_group_name&lt;/span&gt;)
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、動作確認をします。既に登録済みのグループ名を追加しようとするとバリデーションエラーが発生します。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141206/20141206220312.png&quot; alt=&quot;f:id:nipe880324:20141206220312p:plain:w420&quot; title=&quot;f:id:nipe880324:20141206220312p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;登録されていないグループ名を入力し、登録すると、新規でグループが作成され、そのグループが設定されます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141206/20141206220403.png&quot; alt=&quot;f:id:nipe880324:20141206220403p:plain:w420&quot; title=&quot;f:id:nipe880324:20141206220403p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;以上です。&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;参考文献&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://railscasts.com/episodes/16-virtual-attributes&quot;&gt;#16 Virtual Attributes - RailsCasts&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://railscasts.com/episodes/16-virtual-attributes-revised&quot;&gt;#16 Virtual Attributes (revised) - RailsCasts&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;</description>
          <pubDate>Mon, 29 Dec 2014 21:33:53 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/8454420450076313013</guid>
          
            <category>Rails中級</category>
          
            <category>Rails Model</category>
          
            <category>Rails View</category>
          
        </item>
      
    
      
      
        <item>
          <title>Railsで１フォームに複数のサブミット(Submit)ボタンを配置するTips</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20141225/1419515057</link>
          <description>&lt;p&gt;Railsで、次のように１つのフォームに複数のSubmitボタンを追加したときの処理のハンドリングについて説明します。&lt;/p&gt;&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141206/20141206180539.png&quot; alt=&quot;f:id:nipe880324:20141206180539p:plain:w420&quot; title=&quot;f:id:nipe880324:20141206180539p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/articles/_form.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; form_for(@article)&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; do |f| %&amp;gt;&lt;/span&gt;
  ...

  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; submit_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;投稿&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; submit_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;プレビュー&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;preview_button&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;Rails 4.1&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;目次&lt;/h3&gt;
    
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;#tips-one-form-two-submit&quot;&gt;Submit時のパラメーターを確認&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#tips-one-form-two-submit&quot;&gt;Submitボタンにname属性を設定&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#tips-one-form-two-submit&quot;&gt;コントローラーで処理を振り分ける&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#tips-one-form-two-submit&quot;&gt;ビューに表示内容を設定&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#tips-one-form-two-submit&quot;&gt;動作確認&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;tips-one-form-two-submit&quot;&gt;1. Submit時のパラメーターを確認&lt;/h3&gt;&lt;/p&gt;&lt;p&gt;まず、「投稿」ボタン、「プレビュー」ボタンを押した時の&lt;code&gt;params&lt;/code&gt;の内容を確認してみましょう。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 投稿ボタンをした時のパラメーター&lt;/span&gt;
&lt;span class=&quot;synType&quot;&gt;Parameters&lt;/span&gt;:
{
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;utf8&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;✓&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;authenticity_token&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;5Du...&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;article&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; {
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;   =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;
  },
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;投稿&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
}

&lt;span class=&quot;synComment&quot;&gt;# プレビューボタンを押した時のパラメーター&lt;/span&gt;
&lt;span class=&quot;synType&quot;&gt;Parameters&lt;/span&gt;:
{
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;utf8&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;✓&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;authenticity_token&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;5Du...&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;article&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; {
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;   =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;
  },
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プレビュー&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
}
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
両者を見比べる&lt;code&gt;commmit&lt;/code&gt;の内容が違うことに気づくと思います。&lt;br /&gt;
基本的にはコントローラー側で&lt;code&gt;commit&lt;/code&gt;の値を確認し、条件分岐をすればよいです。&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;tips-one-form-two-submit&quot;&gt;2. Submitボタンにname属性を設定&lt;/h3&gt;&lt;/p&gt;&lt;p&gt;上記のままでもよいのですが、ボタン名は変わる可能性があるので往々にしてあるので、次のように&lt;code&gt;name&lt;/code&gt;属性を設定します。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; submit_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;投稿&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; submit_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;プレビュー&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;preview_button&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
「プレビュー」ボタンを押したときのパラメーターは次のように変わります。&lt;br /&gt;
（「投稿」ボタンを押したときのパラメーターは上記と変わりません）&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# プレビューボタンを押した時のパラメーター&lt;/span&gt;
&lt;span class=&quot;synType&quot;&gt;Parameters&lt;/span&gt;:
{
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;utf8&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;✓&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;authenticity_token&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;5Du...&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;article&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; {
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;   =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;
  },
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;preview_button&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プレビュー&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
}
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;tips-one-form-two-submit&quot;&gt;3. コントローラーで処理を振り分ける&lt;/h3&gt;&lt;/p&gt;&lt;p&gt;先ほど追加した&lt;code&gt;preview_button&lt;/code&gt;キーの存在有無により、処理を振り分けます。&lt;br /&gt;
プレビュー機能なので、もう一度作成画面を表示するようにします。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/controllers/articles_controller.rb&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# POST /articles&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# POST /articles.json&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;create&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;@article&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;Article&lt;/span&gt;.new(article_params)

  &lt;span class=&quot;synComment&quot;&gt;# params[:preview_button]キーが存在する場合か、ariticleがDBに保存できない場合&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# new画面を再度表示する&lt;/span&gt;
  &lt;span class=&quot;synStatement&quot;&gt;if&lt;/span&gt; params[&lt;span class=&quot;synConstant&quot;&gt;:preview_button&lt;/span&gt;] || !&lt;span class=&quot;synIdentifier&quot;&gt;@article&lt;/span&gt;.save
    render &lt;span class=&quot;synConstant&quot;&gt;:new&lt;/span&gt;
  &lt;span class=&quot;synStatement&quot;&gt;else&lt;/span&gt;
    redirect_to &lt;span class=&quot;synIdentifier&quot;&gt;@article&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;notice&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Article was successfully created.&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;
  &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;tips-one-form-two-submit&quot;&gt;4. ビューに表示内容を設定&lt;/h3&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;_form.html.erb&lt;/code&gt;に&lt;code&gt;preview_button&lt;/code&gt;キーが存在するときの画面表示を記載します。&lt;br /&gt;
ここではプレビュー機能なので、&lt;code&gt;show.html.erb&lt;/code&gt;の表示内容と同じ内容を表示するようにしました。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/articles/_form.html.erb
...
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% if params[:preview_button] %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;preview&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synComment&quot;&gt;&amp;lt;!-- show.html.erbと重複しているので部分テンプレートにするべき --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; @article.title&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;content&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; simple_format&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; @article.&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
...
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;tips-one-form-two-submit&quot;&gt;5. 動作確認&lt;/h3&gt;&lt;/p&gt;&lt;p&gt;では、サーバーを起動し、画面を確認してみます。&lt;br /&gt;
新規画面でタイトルと内容を記載し、「プレビュー」ボタンを押すと、登録画面が再表示され、preview_buttonパラメーターが存在するためプレビューが表示されます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141206/20141206180631.png&quot; alt=&quot;f:id:nipe880324:20141206180631p:plain:w420&quot; title=&quot;f:id:nipe880324:20141206180631p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;「登録」ボタンを押すと、DBに保存されて、詳細画面に遷移します。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141206/20141206180641.png&quot; alt=&quot;f:id:nipe880324:20141206180641p:plain:w420&quot; title=&quot;f:id:nipe880324:20141206180641p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;以上です。&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;参考文献&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://railscasts.com/episodes/38-multibutton-form&quot;&gt;#38 Multibutton Form - RailsCasts&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;</description>
          <pubDate>Thu, 25 Dec 2014 22:44:17 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/8454420450076296829</guid>
          
            <category>Rails Tips</category>
          
            <category>Rails View</category>
          
        </item>
      
    
      
      
        <item>
          <title>Railsでaccepts_nested_attributes_forとfields_forを使ってhas_many関連の子レコードを作成/更新するフォームを作成</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20141208/1418018874</link>
          <description>&lt;p&gt;Railsでは、&lt;code&gt;accepts_nested_attributes_for&lt;/code&gt;を使うことで簡単に1対多のモデルを一度に更新するフォームを作成することできます。&lt;/p&gt;&lt;p&gt;今回のケースは、ユーザー(User)が家、会社など複数の住所(Address)を持っているというという1対多関係のモデルの入れ子状態を説明します。&lt;br /&gt;
完成イメージは次の通りで、ユーザー情報(User)も作成しながら、住所(Address)も一緒に１フォームで作成できるようになっています。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141127/20141127225732.png&quot; alt=&quot;f:id:nipe880324:20141127225732p:plain:w420&quot; title=&quot;f:id:nipe880324:20141127225732p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;Rails 4.1&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;目次&lt;/h3&gt;
    
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;#accepts_nested_attributes_for-create&quot;&gt;Railsプロジェクトの作成&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#accepts_nested_attributes_for-form&quot;&gt;accepts_nested_attributes_forによる入れ子のフォームを作成&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#accepts_nested_attributes_for-destroy&quot;&gt;入れ子にしたモデルの削除機能の追加&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#accepts_nested_attributes_for-validation&quot;&gt;親モデルと子モデルにバリデーションを追加する&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#accepts_nested_attributes_for-ajax&quot;&gt;Ajaxで動的に住所の入力項目を追加/削除する&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;h3 id=&quot;accepts_nested_attributes_for-create&quot;&gt;1. Railsプロジェクトの作成&lt;/h3&gt;まずプロジェクトを作成します。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;rails new accepts_nested_attributes_for_test
cd accepts_nested_attributes_for_test&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
ユーザーをScaffoldで作成する。&lt;br /&gt;
コントローラー、ビュー、モデル、マイグレーションファイルといったユーザーの一式が作成されます。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;rails g scaffold User username age:integer&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
住所モデルを作成する。&lt;br /&gt;
今回は、１つのフォームでユーザーと住所の作成をするのでモデルとマイグレーションファイルのみ作成します。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;rails g model Address zipcode city street tel user_id:integer&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
マイグレートを実行する。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;rake db:migrate&lt;/pre&gt;&lt;p&gt;アソシエーションを追加する。ユーザーと住所は、1対N関係なので次のようにします。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/models/user.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;User&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  has_many &lt;span class=&quot;synConstant&quot;&gt;:addresses&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# app/models/address.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;Address&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  belongs_to &lt;span class=&quot;synConstant&quot;&gt;:user&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;accepts_nested_attributes_for-form&quot;&gt;2. accepts_nested_attributes_forによる入れ子のフォームを作成&lt;/h3&gt;ActiveRecordは入れ子のフォームを取扱うために&lt;code&gt;accepts_nested_attributes_for&lt;/code&gt;メソッドを提供しているので、それを追加します。&lt;br /&gt;
これを追加することで、&lt;code&gt;addresses_attributes=&lt;/code&gt;が自動的に追加され、それにより、住所(Address)の追加、更新、削除ができるようになります。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/models/user.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;User&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  has_many &lt;span class=&quot;synConstant&quot;&gt;:addresses&lt;/span&gt;
  accepts_nested_attributes_for &lt;span class=&quot;synConstant&quot;&gt;:addresses&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
&lt;span style=&quot;color: #ff2600&quot;&gt;注意事項として、次のようにpresence: trueのバリデーションを定義すると保存ができなくなるので注意してください。&lt;/span&gt;&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/models/address.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;Address&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  belongs_to &lt;span class=&quot;synConstant&quot;&gt;:user&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# モデルを保存できなくなるのでpresence: trueは記載しない&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:user_id&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# or validates :user, presence: true&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、フォームで値を入力/更新できるようにします。&lt;br /&gt;
&lt;code&gt;fields_for&lt;/code&gt;を使うことで入れ子のモデル(Address)を表示させることができます。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/users/_form.html.erb

   ...
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :age %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.number_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :age %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :addresses, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;住所&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.fields_for&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :addresses do |addresses_form| %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :zipcode, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;郵便番号&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :zipcode %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :city, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;都道府県&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :city %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :street, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;市町村番&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :street %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :tel, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;電話番号&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :tel %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;actions&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.submit&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
次に、コントローラーでnewアクションでAddressをbuild（newのリレーション版）をするようにします。こうすることで、&lt;code&gt;fields_for&lt;/code&gt;内の内容が表示されるようになります。&lt;br /&gt;
また、StrongParameterも許可するようにします。&lt;code&gt;fields_for&lt;/code&gt;は&lt;code&gt;[引数に与えた名前]_attributes&lt;/code&gt;というname属性でフォームを作成するので、&lt;code&gt;addresses_attributes&lt;/code&gt;を許可する必要があります。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/controllers/users_controller.rb&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# GET /users/new&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;new&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;@user&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;User&lt;/span&gt;.new
    &lt;span class=&quot;synIdentifier&quot;&gt;@user&lt;/span&gt;.addresses.build

    &lt;span class=&quot;synComment&quot;&gt;# デフォルトで2つの住所入力欄を作成したい場合は次のようにする&lt;/span&gt;
    &lt;span class=&quot;synComment&quot;&gt;# 2.times { @user.addresses.build }&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

  ...

  &lt;span class=&quot;synStatement&quot;&gt;private&lt;/span&gt;

    &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;user_params&lt;/span&gt;
      params.require(&lt;span class=&quot;synConstant&quot;&gt;:user&lt;/span&gt;).permit(
        &lt;span class=&quot;synConstant&quot;&gt;:username&lt;/span&gt;,
        &lt;span class=&quot;synConstant&quot;&gt;:age&lt;/span&gt;,
        &lt;span class=&quot;synConstant&quot;&gt;addresses_attributes&lt;/span&gt;: [&lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:zipcode&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:city&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:street&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:tel&lt;/span&gt;]
      )
    &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、動作確認してみましょう。&lt;br /&gt;
入力画面で次のように値をいれて新規作成します。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141127/20141127220131.png&quot; alt=&quot;f:id:nipe880324:20141127220131p:plain:w380&quot; title=&quot;f:id:nipe880324:20141127220131p:plain:w380&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:380px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;すると、&lt;code&gt;accepts_nested_attributes_for&lt;/code&gt;と&lt;code&gt;fields_for&lt;/code&gt;により、自動的にユーザーと住所モデルが作成されます。&lt;br /&gt;
そして、編集画面を開くと登録されていることがわかると思います。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141127/20141127220314.png&quot; alt=&quot;f:id:nipe880324:20141127220314p:plain:w380&quot; title=&quot;f:id:nipe880324:20141127220314p:plain:w380&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:380px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;登録時のサーバーのログを確認すると次のようなパラメーターとSQL文が走っています。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# パラメーター（addresses_attributesにより入力パラメーターが渡されている）&lt;/span&gt;
 {&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;utf8&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;✓&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;authenticity_token&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;3t7C...&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt; {
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;test1&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;addresses_attributes&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; {
      &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; {
        &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;zipcode&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;111-1111&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
        &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;city&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;東京都&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
        &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;street&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, 
        &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;tel&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;
       }
     }
   },
  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;=&amp;gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Create User&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
 }

&lt;span class=&quot;synComment&quot;&gt;# SQL文（UserとAddressモデルが作成されている） &lt;/span&gt;
  (&lt;span class=&quot;synConstant&quot;&gt;0&lt;/span&gt;.1ms)  &lt;span class=&quot;synStatement&quot;&gt;begin&lt;/span&gt; transaction
  SQL (&lt;span class=&quot;synConstant&quot;&gt;0&lt;/span&gt;.5ms)  &lt;span class=&quot;synType&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; (&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) VALUES (&lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?)&lt;/span&gt;  [[&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;10&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2014-11-27 12:56:56.445149&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2014-11-27 12:56:56.445149&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;test1&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;]]
  SQL (&lt;span class=&quot;synConstant&quot;&gt;0&lt;/span&gt;.3ms)  &lt;span class=&quot;synType&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;addresses&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; (&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;city&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;street&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;tel&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;user_id&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;zipcode&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) VALUES (&lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?,&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;?)&lt;/span&gt;  [[&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;city&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;東京都&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2014-11-27 12:56:56.450941&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;street&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;tel&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;2014-11-27 12:56:56.450941&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;user_id&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;], [&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;zipcode&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;111-1111&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;]]
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;accepts_nested_attributes_for-destroy&quot;&gt;3. 入れ子にしたモデルの削除機能の追加&lt;/h3&gt;&lt;code&gt;accepts_nested_attributes_for&lt;/code&gt;を使っていれば、簡単にユーザーに関連した住所モデルを削除することもできます。&lt;br /&gt;
削除方法として、フォームに削除チェックボックスを追加し、チェックしたまま更新するとそのモデルを削除されるようにします。&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;まず、&lt;code&gt;allow_destroy: true&lt;/code&gt;オプションをユーザーモデルに追加します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/models/user.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;User&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  has_many &lt;span class=&quot;synConstant&quot;&gt;:addresses&lt;/span&gt;
  accepts_nested_attributes_for &lt;span class=&quot;synConstant&quot;&gt;:addresses&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;allow_destroy&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
次に、削除チェックボックスをフォームに追加します。&lt;br /&gt;
&lt;code&gt;_destroy&lt;/code&gt;キーである必要があります。&lt;br /&gt;
&lt;code&gt;accepts_nested_attributes_for&lt;/code&gt;の挙動として、&lt;code&gt;_destroy&lt;/code&gt;が&lt;code&gt;1&lt;/code&gt;か&lt;code&gt;true&lt;/code&gt;の場合に、関連するモデルが削除されるような挙動になっているためです。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/users/_form.html.erb
  ...
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.field_for&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :addresses do |addresses_form| %&amp;gt;&lt;/span&gt;
      ...

      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :street, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;市町村番&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :street %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :tel, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;電話番号&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :tel %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synComment&quot;&gt;&amp;lt;!-- DBに保存されていない場合のみ表示 = 更新時のみ表示 --&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% if @user.persisted? %&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.check_box&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :_destroy %&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; addresses_form.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :_destroy, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;削除&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  ...
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
最後に、StrongParameterに&lt;code&gt;_destroy&lt;/code&gt;をpermitするようにします。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/controllers/users_controller.rb&lt;/span&gt;
 
  &lt;span class=&quot;synStatement&quot;&gt;private&lt;/span&gt;

    &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;user_params&lt;/span&gt;
      params.require(&lt;span class=&quot;synConstant&quot;&gt;:user&lt;/span&gt;).permit(
        &lt;span class=&quot;synConstant&quot;&gt;:username&lt;/span&gt;,
        &lt;span class=&quot;synConstant&quot;&gt;:age&lt;/span&gt;,
        &lt;span class=&quot;synConstant&quot;&gt;addresses_attributes&lt;/span&gt;: [&lt;span class=&quot;synConstant&quot;&gt;:id&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:zipcode&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:city&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:street&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:tel&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:_destroy&lt;/span&gt;]
      )
    &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、削除できることを確認しましょう。&lt;br /&gt;
編集画面を開き、「削除」にチェックし、更新ボタンを押します。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141127/20141127221518.png&quot; alt=&quot;f:id:nipe880324:20141127221518p:plain:w380&quot; title=&quot;f:id:nipe880324:20141127221518p:plain:w380&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:380px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;編集画面を開きなおすと、住所が削除されます。Railsにより自動的にレコードが削除されました。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141127/20141127221524.png&quot; alt=&quot;f:id:nipe880324:20141127221524p:plain:w380&quot; title=&quot;f:id:nipe880324:20141127221524p:plain:w380&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:380px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;accepts_nested_attributes_for-validation&quot;&gt;4. 親モデルと子モデルにバリデーションを追加する&lt;/h3&gt;&lt;code&gt;reject_if&lt;/code&gt;で条件を指定して値を更新しないようにすることができますが、画面上にエラーとして表示されないため、バリデーションを定義します。&lt;br /&gt;
定義方法は通常通りです。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/models/user.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;User&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  has_many &lt;span class=&quot;synConstant&quot;&gt;:addresses&lt;/span&gt;
  accepts_nested_attributes_for &lt;span class=&quot;synConstant&quot;&gt;:addresses&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;allow_destroy&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# presence: true 各項目が存在しない場合バリデーションエラーになる&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:username&lt;/span&gt;,  &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:age&lt;/span&gt;,       &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;


&lt;span class=&quot;synComment&quot;&gt;# app/models/address.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;Address&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  belongs_to &lt;span class=&quot;synConstant&quot;&gt;:user&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# presence: true 各項目が存在しない場合バリデーションエラーになる&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:zipcode&lt;/span&gt;,  &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:city&lt;/span&gt;,     &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:street&lt;/span&gt;,   &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:tel&lt;/span&gt;,      &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、画面から未入力でユーザーを新規登録すると、バリデーションが適用されていることがわかります。&lt;br /&gt;
このように、&lt;code&gt;accepts_nested_attributes_for&lt;/code&gt;と&lt;code&gt;fields_for&lt;/code&gt;メソッドによりバリデーションも自動的に行ってくれます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141127/20141127223728.png&quot; alt=&quot;f:id:nipe880324:20141127223728p:plain:w420&quot; title=&quot;f:id:nipe880324:20141127223728p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;ちなみに、今は、住所を入力する気がなくてもバリデーションが実行されてしまいユーザーが登録できません。&lt;br /&gt;
そういうときに&lt;code&gt;reject_if&lt;/code&gt;オプションが使えます。これがtrueになるときは住所モデルを作成せず、バリデーションも実施しません。&lt;br /&gt;
条件の指定方法は次のようにProcか&lt;code&gt;all_blank&lt;/code&gt;のどちらかで記述します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 郵便番号が空の場合のみ、住所モデルを作成しない（バリデーションも実行しない）&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# つまり、郵便番号を入力した場合は、バリデーションが実行されます。&lt;/span&gt;
accepts_nested_attributes_for &lt;span class=&quot;synConstant&quot;&gt;:addresses&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;allow_destroy&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;reject_if&lt;/span&gt;: &lt;span class=&quot;synStatement&quot;&gt;proc&lt;/span&gt; { |&lt;span class=&quot;synIdentifier&quot;&gt;attributes&lt;/span&gt;| attributes[&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;zipcode&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;].blank? }

&lt;span class=&quot;synComment&quot;&gt;# すべての入力属性が空の場合、住所モデルを作成しない（バリデーションも実行しない）&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# １つでも属性を入力した場合、住所モデルを作成しようとします。（バリデーションも実行される）&lt;/span&gt;
accepts_nested_attributes_for &lt;span class=&quot;synConstant&quot;&gt;:addresses&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;allow_destroy&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;reject_if&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:all_blank&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、Userモデルを次のように修正します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/models/user.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;User&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  has_many &lt;span class=&quot;synConstant&quot;&gt;:addresses&lt;/span&gt;
  accepts_nested_attributes_for &lt;span class=&quot;synConstant&quot;&gt;:addresses&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;allow_destroy&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;reject_if&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:all_blank&lt;/span&gt;

  &lt;span class=&quot;synComment&quot;&gt;# presence: true 各項目が存在しない場合バリデーションエラーになる&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:username&lt;/span&gt;,  &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
  validates &lt;span class=&quot;synConstant&quot;&gt;:age&lt;/span&gt;,       &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、画面を開いて未入力で作成ボタンを押すと、Userのバリデーションエラーのみ発生します。&lt;br /&gt;
これは、&lt;code&gt;reject_if: :all_blank&lt;/code&gt;がtrueになったため住所モデルを作成しなくなったため、バリデーションエラーがUserのみになったためです。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141209/20141209202629.png&quot; alt=&quot;f:id:nipe880324:20141209202629p:plain:w420&quot; title=&quot;f:id:nipe880324:20141209202629p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;accepts_nested_attributes_for-ajax&quot;&gt;5. Ajaxで動的に住所の入力項目を追加/削除する&lt;/h3&gt;「追加」、「削除」リンクを押すことで、動的に入力項目を追加/削除するため機能は提供していないので、Ajaxで作る必要があります。&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;まずは、jQueryとturbolinkを共存させるために、&lt;code&gt;jquery-turbolinks&lt;/code&gt;をインストールします。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;echo &amp;#34;gem &amp;#39;jquery-turbolinks&amp;#39;&amp;#34; &amp;gt;&amp;gt; Gemfile
bundle install&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
&lt;code&gt;jquery.turbolinks&lt;/code&gt;も読み込むようにします。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;# app/assets/javascripts/application.js
...
//= require jquery
//= require jquery.turbolinks
//= require jquery_ujs&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
住所入力部分を動的に追加、削除するので、住所入力部分を部分テンプレートをします。&lt;br /&gt;
ついでに、削除はリンクにし、JSで動的に非表示にするようにします。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/users/_address_fields.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;fieldset&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :zipcode, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;郵便番号&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :zipcode %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :city, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;都道府県&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :city %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :street, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;市町村番&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :street %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :tel, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;電話番号&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :tel %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.hidden_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :_destroy %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;削除&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;#&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;remove_fields&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;fieldset&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
次に、作成した部分テンプレートを呼び出すようにし、「住所追加」リンクも作ります。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/users/_form.html.erb
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :addresses, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;住所&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.fields_for&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :addresses do |builder| %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; render&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;address_fields&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, f: builder %&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to_add_fields&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;住所追加&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, f, :addresses %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
次に、&lt;code&gt;link_to_add_fields&lt;/code&gt;ヘルパーを実装します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/helpers/application_helper.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ApplicationHelper&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;link_to_add_fields&lt;/span&gt;(name, f, association)
    new_object = f.object.send(association).klass.new
    id = new_object.object_id
    fields = f.fields_for(association, new_object, &lt;span class=&quot;synConstant&quot;&gt;child_index&lt;/span&gt;: id) &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;builder&lt;/span&gt;|
      render(association.to_s.singularize + &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;_fields&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;f&lt;/span&gt;: builder)
    &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt;
    link_to(name, &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;add_fields&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;data&lt;/span&gt;: {&lt;span class=&quot;synConstant&quot;&gt;id&lt;/span&gt;: id, &lt;span class=&quot;synConstant&quot;&gt;fields&lt;/span&gt;: fields.gsub(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;)})
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
そして、最後はAjax部分をCoffeeScriptで記載します。&lt;/p&gt;
&lt;pre class=&quot;code lang-javascript&quot; data-lang=&quot;javascript&quot; data-unlink&gt;# app/assets/javascripts/user.js.coffee
$ -&amp;gt;
  $(&lt;span class=&quot;synConstant&quot;&gt;&#39;form&#39;&lt;/span&gt;).on &lt;span class=&quot;synConstant&quot;&gt;&#39;click&#39;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;&#39;.remove_fields&#39;&lt;/span&gt;, (&lt;span class=&quot;synStatement&quot;&gt;event&lt;/span&gt;) -&amp;gt;
    $(&lt;span class=&quot;synIdentifier&quot;&gt;this&lt;/span&gt;).prev(&lt;span class=&quot;synConstant&quot;&gt;&#39;input[type=hidden]&#39;&lt;/span&gt;).val(&lt;span class=&quot;synConstant&quot;&gt;&#39;1&#39;&lt;/span&gt;)
    $(&lt;span class=&quot;synIdentifier&quot;&gt;this&lt;/span&gt;).closest(&lt;span class=&quot;synConstant&quot;&gt;&#39;fieldset&#39;&lt;/span&gt;).hide()
    &lt;span class=&quot;synStatement&quot;&gt;event&lt;/span&gt;.preventDefault()

  $(&lt;span class=&quot;synConstant&quot;&gt;&#39;form&#39;&lt;/span&gt;).on &lt;span class=&quot;synConstant&quot;&gt;&#39;click&#39;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;&#39;.add_fields&#39;&lt;/span&gt;, (&lt;span class=&quot;synStatement&quot;&gt;event&lt;/span&gt;) -&amp;gt;
    time = &lt;span class=&quot;synStatement&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;Date&lt;/span&gt;().getTime()
    regexp = &lt;span class=&quot;synStatement&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;RegExp&lt;/span&gt;($(&lt;span class=&quot;synIdentifier&quot;&gt;this&lt;/span&gt;).data(&lt;span class=&quot;synConstant&quot;&gt;&#39;id&#39;&lt;/span&gt;), &lt;span class=&quot;synConstant&quot;&gt;&#39;g&#39;&lt;/span&gt;)
    $(&lt;span class=&quot;synIdentifier&quot;&gt;this&lt;/span&gt;).before($(&lt;span class=&quot;synIdentifier&quot;&gt;this&lt;/span&gt;).data(&lt;span class=&quot;synConstant&quot;&gt;&#39;fields&#39;&lt;/span&gt;).replace(regexp, time))
    &lt;span class=&quot;synStatement&quot;&gt;event&lt;/span&gt;.preventDefault()
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、動作を確認してみましょう。&lt;br /&gt;
「住所追加」や「削除」ができ、また、作成や更新をすると値が更新されます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20141127/20141127225732.png&quot; alt=&quot;f:id:nipe880324:20141127225732p:plain:w420&quot; title=&quot;f:id:nipe880324:20141127225732p:plain:w420&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:420px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;以上です。&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;参考文献&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://guides.rubyonrails.org/form_helpers.html#building-complex-forms&quot;&gt;Form Helpers &amp;mdash; Ruby on Rails Guides&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://api.rubyonrails.org/&quot;&gt;Ruby on Rails API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://railscasts.com/episodes/196-nested-model-form-revised&quot;&gt;#196 Nested Model Form (revised) - RailsCasts&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;</description>
          <pubDate>Mon, 08 Dec 2014 15:07:54 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/8454420450075499185</guid>
          
            <category>Rails中級</category>
          
            <category>Rails Controller</category>
          
            <category>Rails View</category>
          
        </item>
      
    
      
      
        <item>
          <title>Railsのテンプレートエンジンの比較 erb vs slim vs haml</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20141001/1412169453</link>
          <description>&lt;p&gt;RailsでHTMLを作成するときによく使われるテンプレートエンジンの「ERB」「Haml」「Slim」について比較しました。&lt;br /&gt;
&lt;b style=&quot;color: #ff2600&quot;&gt;SlimやHamlである程度書いた後に、ERBで記載すると冗長が多すぎるのでめんどくさく感じるようになります。&lt;/b&gt;&lt;br /&gt;
是非、導入を検討してみて下さい。&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;対象読者&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;RailsのViewをどのテンプレートエンジンで書いたら良いか分からない方&lt;/li&gt;
&lt;li&gt;RailsのView作成をより生産的に実装したい方&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;バージョン&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;ERB(erubis) 2.7.0&lt;/li&gt;
&lt;li&gt;Haml 4.0.5&lt;/li&gt;
&lt;li&gt;Slim 2.0.3&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;オススメ&lt;/h3&gt;
    &lt;p&gt;&lt;b&gt;Slim &amp;gt; Haml &amp;gt;&amp;gt; ERB&lt;/b&gt;の順でオススメです。&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;HTMLテンプレートエンジンの比較表&lt;/h3&gt;
    &lt;p&gt;理由としては、次の表を見てもらえば一目瞭然です。&lt;table&gt;
  &lt;tr&gt;
    &lt;th&gt;名前&lt;/th&gt;
    &lt;th&gt;概要&lt;/th&gt;
    &lt;th&gt;メリット&lt;/th&gt;
    &lt;th&gt;デメリット&lt;/th&gt;
    &lt;th&gt;ファイル拡張子&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;ERB&lt;/td&gt;
    &lt;td&gt;Ruby標準付属であり、RailsではデフォルトのHTMLテンプレートエンジン&lt;/td&gt;
    &lt;td&gt;基本はHTMLに&lt;code&gt;&amp;lt; ... &amp;gt;と&amp;lt;= ... &amp;gt;&lt;/code&gt;でRubyコードを埋め込むだけなので、学習コストが低く理解しやすい&lt;/td&gt;
    &lt;td&gt;ほぼHTMLのため、冗長な箇所が多々ある&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;.erb&lt;/code&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Haml&lt;/td&gt;
    &lt;td&gt;タグで階層構造を表すことにより、&lt;code&gt;&amp;lt;&lt;/code&gt;や&lt;code&gt;&amp;gt;&lt;/code&gt;や閉じタグなどを省略できるHTMLテンプレートエンジン&lt;/td&gt;
    &lt;td&gt;HTMLコードの記述量が2,3割減り、ERBに比べ生産的。学習コストもそんなに高くない&lt;/td&gt;
    &lt;td&gt;テキストや属性の記載方法などに若干のクセがある&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;.haml&lt;/code&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Slim&lt;/td&gt;
    &lt;td&gt;Hamlとほぼ同じ。Hamlよりほんの少しシンプルなHTMLテンプレートエンジン&lt;/td&gt;
    &lt;td&gt;Hamlと同様。また、ERBよりパフォーマンスが良い&lt;/td&gt;
    &lt;td&gt;Hamlと同様&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;.slim&lt;/code&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;HTMLテンプレートエンジンのソースコードの比較&lt;/h3&gt;
    &lt;p&gt;次のHTMLを作成するためのソースコードをそれぞれ記載してみます。&lt;br /&gt;
HamlとSlimのコードはほぼ同じであり、ERBに比べ、コード量は短いと思います。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;title&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;H1 タイトル&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;0: リスト&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;1: リスト&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;2: リスト&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;#&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;synUnderlined&quot;&gt;リンク&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;ERBのコードです。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;h1 id=&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&amp;gt;&lt;span class=&quot;synType&quot;&gt;H1&lt;/span&gt; タイトル&amp;lt;/h1&amp;gt;
&amp;lt;br&amp;gt;
&amp;lt;ul&amp;gt;
  &amp;lt;% &lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt;.times &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;i&lt;/span&gt;| %&amp;gt;
    &amp;lt;li&amp;gt;&amp;lt;%= i %&amp;gt;: リスト&amp;lt;/li&amp;gt;
  &amp;lt;% &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt; %&amp;gt;
&amp;lt;/ul&amp;gt;
&amp;lt;a href=&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&amp;gt;リンク&amp;lt;/a&amp;gt;
&lt;/pre&gt;&lt;p&gt;Hamlのコードです。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;%h1&lt;span class=&quot;synComment&quot;&gt;#title H1 タイトル&lt;/span&gt;
%br
%ul
  - &lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt;.times &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;i&lt;/span&gt;|
    %li &lt;span class=&quot;synComment&quot;&gt;#{i}: リスト&lt;/span&gt;

%a{ &lt;span class=&quot;synConstant&quot;&gt;href&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; } リンク
&lt;/pre&gt;&lt;p&gt;Slimのコードです。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;h1&lt;span class=&quot;synComment&quot;&gt;#title H1 タイトル&lt;/span&gt;
br
ul
  - &lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt;.times &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;i&lt;/span&gt;|
    li &lt;span class=&quot;synComment&quot;&gt;#{i}: リスト&lt;/span&gt;

a(href=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) リンク
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;チュートリアル&lt;/h3&gt;
    &lt;p&gt;SlimやHamlをやってみたいという方は、是非下記のチュートリアル記事を読んで、実際に手を動かしてみて下さい。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/entry/20140929/1411997071&quot; target=&quot;_blank&quot;&gt;Slim入門&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/entry/20141001/1412097051&quot; target=&quot;_blank&quot;&gt;Haml入門&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;SlimやHamlである程度書いた後に、ERBで記載すると冗長が多すぎるのでめんどくさく感じるようになります。&lt;br /&gt;
是非使ってみてください。&lt;/p&gt;&lt;p&gt;以上です。&lt;br /&gt;
質問や誤りなどがある場合は、気軽にコメント下さい。できるだけ早く反応します。&lt;/p&gt;

&lt;/div&gt;</description>
          <pubDate>Wed, 01 Oct 2014 22:17:33 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/8454420450066771841</guid>
          
            <category>Rails View</category>
          
            <category>Rails gem</category>
          
        </item>
      
        <item>
          <title>RailsのHTMLテンプレートエンジン Haml入門</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20141001/1412097051</link>
          <description>
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;はじめに&lt;/h3&gt;
    &lt;p&gt;RailsではView（HTML出力）のためには標準ではERB(.erb)を使用しています。&lt;br /&gt;
しかし、erbは汎用的なテンプレートエンジンであり、HTML以外のファイルにRubyコードを&lt;br /&gt;
埋め込めることができるます。&lt;br /&gt;
そのため、HTML作成という点で見ると、いくらか冗長な箇所があります。&lt;/p&gt;&lt;p&gt;そのため、より生産的にHTMLを作成するために、Railsでは&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Haml （拡張子 xxx.html.haml）&lt;/li&gt;
&lt;li&gt;Slim （拡張子 xxx.html.slim）&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;という２つのHTML用のテンプレートエンジンがよく使われます。&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;そして、今回はタイトルからも分かるように&lt;b&gt;Haml&lt;/b&gt;について説明します。&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;b&gt;Slim&lt;/b&gt;については、&lt;a href=&quot;/entry/20140929/1411997071&quot;&gt;こちら&lt;/a&gt;から参照ください。&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Hamlは「マークアプは美しくあるべき」という原則に基づいて開発されました。&lt;br /&gt;
Hamlを使うことにより、Viewファイルを「綺麗に」「読みやすく」「生産的に」作成することができます。&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;Rails 4.1&lt;/li&gt;
&lt;li&gt;haml  4.0.5&lt;/li&gt;
&lt;li&gt;haml-rails 0.5.3&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;目次&lt;/h3&gt;
    
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;#haml-basic&quot;&gt;Hamlの基礎&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#haml-introduce-to-haml&quot;&gt;RailsにHamlの導入&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#haml-translate-to-haml-from-erb&quot;&gt;erbをhamlに書き換えていく&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#haml-refarence-sheet&quot;&gt;おまけ：Hamlのリファレンスシート&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#haml-tools-erb2haml&quot;&gt;おまけ：HTMLやerbをhamlに変換するツール: erb2haml&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;&lt;br /&gt;
&lt;h3 id=&quot;haml-basic&quot;&gt;1. Hamlの基礎&lt;/h3&gt;Hamlはシンプルな記法で難しくはないので、実際にerbとhamlのソースコードを比べて、１つ１つ説明していきます。&lt;br /&gt;
Hamlの拡張子は、&lt;code&gt;.haml&lt;/code&gt;にする必要があります。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/layouts/application.html.erb
&lt;span class=&quot;synComment&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;SlimTest&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; stylesheet_link_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;application&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;all&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;data-turbolinks-track&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; =&amp;gt;&lt;/span&gt;&lt;span class=&quot;synPreProc&quot;&gt; true %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; javascript_include_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;application&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;data-turbolinks-track&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; =&amp;gt;&lt;/span&gt;&lt;span class=&quot;synPreProc&quot;&gt; true %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; csrf_meta_tags&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;header&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;header&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;title logo&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Slim Test&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;header&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; yield&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/layouts/application.html.haml&lt;/span&gt;
!!! &lt;span class=&quot;synConstant&quot;&gt;5&lt;/span&gt;
%html
  %head
    %title &lt;span class=&quot;synType&quot;&gt;HamlTest&lt;/span&gt;
    = stylesheet_link_tag    &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;media&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;data-turbolinks-track&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
    = javascript_include_tag &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;data-turbolinks-track&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
    = csrf_meta_tags

  %body

  = &lt;span class=&quot;synStatement&quot;&gt;yield&lt;/span&gt;
&lt;/pre&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;Hamlの簡単な覚え方&lt;/h4&gt;
    &lt;p&gt;上記のerbとslimを見比べながら、下記のルールを見て下さい。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;code&gt;&amp;lt;、&amp;gt;、&amp;lt;%、%&amp;gt;&lt;/code&gt;をタグから削除し。&lt;code&gt;&amp;&lt;/code&gt;をタグの直前につける。また、閉じタグは全て削除する&lt;/li&gt;
&lt;li&gt;&lt;code&gt;each、if&lt;/code&gt;などのロジック部分の先頭には、&lt;code&gt;-&lt;/code&gt;を記載する（&lt;code&gt;end&lt;/code&gt;は必要ない)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;lt;%= ... &amp;gt;&lt;/code&gt;は&lt;code&gt;=&lt;/code&gt;にする&lt;/li&gt;
&lt;li&gt;class属性やid属性は、&lt;code&gt;%p.fields&lt;/code&gt;や&lt;code&gt;%p#contents&lt;/code&gt;などにする。タグがdivのときはdivを省略し&lt;code&gt;#content&lt;/code&gt;と記載できる&lt;/li&gt;
&lt;li&gt;class属性やid属性以外のhrefやimgなどの属性を追加したい場合は、ハッシュで記載する（例：&lt;code&gt;%a{:href =&gt; &quot;#&quot;} リンクテキスト&lt;/code&gt;）&lt;/li&gt;
&lt;li&gt;コメントは、&lt;code&gt;/ このコメントはHTMLに変換後に表示されない&lt;/code&gt;で記載する&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;&lt;br /&gt;
&lt;h3 id=&quot;haml-introduce-to-haml&quot;&gt;2. RailsにHamlの導入&lt;/h3&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;Railsプロジェクトの作成&lt;/h4&gt;
    &lt;p&gt;まず、いつも通りRailsプロジェクトを作成します。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;$ rails new haml_test&lt;/pre&gt;&lt;p&gt;次に、商品(Product)のソース一式をScaffoldを使って作成します。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;$ cd haml_test
$ rails g scaffold Product name:string description:text price:integer discontinued:boolean&lt;/pre&gt;&lt;p&gt;DBマイグレートをします。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;$ rake db:migrate&lt;/pre&gt;&lt;p&gt;これで、商品(Product)の一覧表示、作成、更新、削除ができました。&lt;br /&gt;
&lt;code&gt;$ rails server&lt;/code&gt;でローカルのサーバを起動していくつかデータを入力してみました。&lt;/p&gt;&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140929/20140929214513.png&quot; alt=&quot;f:id:nipe880324:20140929214513p:plain:w480&quot; title=&quot;f:id:nipe880324:20140929214513p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;HamlをRailsに導入&lt;/h4&gt;
    &lt;p&gt;では、実際にRailsにHamlを導入していきましょう。&lt;br /&gt;
&lt;code&gt;Gemfile&lt;/code&gt;に下記を追加します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;gem &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;haml-rails&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;その後、Hamlをインストールします。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;$ bundle install&lt;/pre&gt;&lt;p&gt;これで、RailsにHamlが導入されたので、以降は&lt;code&gt;xxx.html.haml&lt;/code&gt;という拡張子でViewファイルを作成することで&lt;b&gt;Haml&lt;/b&gt;としてRailsが読み込んでくれます。&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;b&gt;ERB&lt;/b&gt;と&lt;b&gt;Haml&lt;/b&gt;で同名のファイルがある場合は、&lt;b&gt;ERB&lt;/b&gt;が優先的に読み込まれるので、ERBファイルは削除して下さい。例えば、&lt;code&gt;index.html.erb&lt;/code&gt;と&lt;code&gt;index.html.haml&lt;/code&gt;がある場合、&lt;code&gt;index.html.erb&lt;/code&gt;が読み込まれてしまうため、削除して下さい。&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;haml-rails gem をインストール後に、rails generaterでscaffoldやcontrollerを作成すると、Viewファイルは全て&lt;code&gt;.erb&lt;/code&gt;の代わりに&lt;code&gt;.haml&lt;/code&gt;で作成されます。&lt;/i&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;haml-translate-to-haml-from-erb&quot;&gt;3. erbをhamlに書き換えていく&lt;/h3&gt;では、Scaffoldで作成した&lt;code&gt;.erb&lt;/code&gt;を１画面ずつ&lt;code&gt;.haml&lt;/code&gt;に変更していきます。&lt;br /&gt;
変更後のHamlファイルを見る前に、自分で上記の「1. Hamlの基礎」を確認しながら手を動かしながらHamlファイルを作成することにより、Hamlの書き方に慣れるのでおすすめです。&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;一覧画面&lt;/h4&gt;
    &lt;p&gt;まずは、一覧画面を変更します。&lt;br /&gt;
&lt;code&gt;index.html.erb&lt;/code&gt;は次のようになっています。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/products/index.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Listing products&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;thead&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tr&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Name&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Description&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Price&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Discontinued&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;colspan&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tr&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;thead&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tbody&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% @products.each do |product| %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tr&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; product.name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; product.description&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; product.price&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; product.discontinued&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Show&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, product %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Edit&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, edit_product_path(product) %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Destroy&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, product, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: :delete, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: { confirm: &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Are you sure?&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; } %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tr&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tbody&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;New Product&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, new_product_path %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
&lt;code&gt;index.html.slim&lt;/code&gt;を新しく作成し、これを１つ１つ直していきましょう。&lt;/p&gt;&lt;p&gt;下記が変換後の一覧画面です。&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;Hamlに変換するポイント&lt;/h5&gt;
    
&lt;ul&gt;
&lt;li&gt;h1, tableなどのタグの&amp;lt;と&amp;gt;を削除し、&lt;code&gt;%&lt;/code&gt;をタグに付け、閉じタグは削除する&lt;/li&gt;
&lt;li&gt;id属性、class属性、その他の属性を追加する場合は、&lt;code&gt;{}&lt;/code&gt;でハッシュ形式でタグの直後に記載する&lt;/li&gt;
&lt;li&gt;ifやeachなどロジック部分の行には、先頭に&lt;code&gt;-&lt;/code&gt;を記載する&lt;/li&gt;
&lt;li&gt;上記をインデントに気をつけながら記載する&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;では、Hamlファイルを見てみましょう。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/index.html.haml&lt;/span&gt;
%h1 &lt;span class=&quot;synType&quot;&gt;Listing&lt;/span&gt; products

%table
  %thead
    %tr
      %th &lt;span class=&quot;synType&quot;&gt;Name&lt;/span&gt;
      %th &lt;span class=&quot;synType&quot;&gt;Description&lt;/span&gt;
      %th &lt;span class=&quot;synType&quot;&gt;Price&lt;/span&gt;
      %th &lt;span class=&quot;synType&quot;&gt;Discontinued&lt;/span&gt;
      %th{&lt;span class=&quot;synConstant&quot;&gt;:colspan&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;}

  %tbody
    - &lt;span class=&quot;synIdentifier&quot;&gt;@products&lt;/span&gt;.each &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;product&lt;/span&gt;|
      %tr
        %td= product.name
        %td= product.description
        %td= product.price
        %td= product.discontinued
        %td= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Show&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, product
        %td= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Edit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, edit_product_path(product)
        %td= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Destroy&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, product, &lt;span class=&quot;synConstant&quot;&gt;method&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:delete&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;data&lt;/span&gt;: { &lt;span class=&quot;synConstant&quot;&gt;confirm&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Are you sure?&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; }

%br

= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;New Product&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, new_product_path
&lt;/pre&gt;&lt;p&gt;&lt;code&gt;.erb&lt;/code&gt;ファイルが存在するとそちらが優先的に表示されてしまうので、削除します。&lt;br /&gt;
サーバーを再起動しなおして、一覧画面を確認してみましょう。&lt;br /&gt;
表示は変わっていませんね :)&lt;/p&gt;&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140929/20140929214513.png&quot; alt=&quot;f:id:nipe880324:20140929214513p:plain:w480&quot; title=&quot;f:id:nipe880324:20140929214513p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;新規/編集画面&lt;/h4&gt;
    &lt;p&gt;次は、新規、編集画面です。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/products/new.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;New product&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; render&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;form&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Back&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, products_path %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/products/edit.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Editing product&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; render&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;form&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Show&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, @product %&amp;gt;&lt;/span&gt; |
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Back&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, products_path %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/products/_form.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; form_for(@product)&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; do |f| %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% if @product.errors.any? %&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;error_explanation&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; pluralize(@product.errors.count,&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;error&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;) %&amp;gt;&lt;/span&gt; prohibited this product from being saved:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% @product.errors.full_messages.each do |message| %&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; message&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :description %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_area&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :description %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :price %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.number_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :price %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :discontinued %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.check_box&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :discontinued %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;actions&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.submit&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
ではHamlに変換します。&lt;br /&gt;
ポイントは、&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;プレインテキストは、&lt;code&gt;\&lt;/code&gt;をプレインテキストの前後に記載すr&lt;/li&gt;
&lt;li&gt;文字列は&lt;code&gt;&quot;{...}&quot;&lt;/code&gt;で記載する&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;です。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/new.html.haml&lt;/span&gt;
%h1 &lt;span class=&quot;synType&quot;&gt;New&lt;/span&gt; product

= render &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;

= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Back&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, products_path
&lt;/pre&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/edit.html.haml&lt;/span&gt;
%h1 &lt;span class=&quot;synType&quot;&gt;Editing&lt;/span&gt; product

= render &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;

= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Show&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;
\|
= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Back&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, products_path
&lt;/pre&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/_form.html.haml&lt;/span&gt;
= form_for(&lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;) &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;f&lt;/span&gt;|
  - &lt;span class=&quot;synStatement&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.errors.any?
    &lt;span class=&quot;synComment&quot;&gt;#error_explanation&lt;/span&gt;
      %h2= &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;#{&lt;/span&gt;pluralize(&lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.errors.count, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)&lt;span class=&quot;synSpecial&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; prohibited this product from being saved:&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;

      %ul
        - &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.errors.full_messages.each &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;message&lt;/span&gt;|
          %li= message

  .field
    = f.label &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;
    %br
    = f.text_field &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;
  .field
    = f.label &lt;span class=&quot;synConstant&quot;&gt;:description&lt;/span&gt;
    %br
    = f.text_area &lt;span class=&quot;synConstant&quot;&gt;:description&lt;/span&gt;
  .field
    = f.label &lt;span class=&quot;synConstant&quot;&gt;:price&lt;/span&gt;
    %br
    = f.number_field &lt;span class=&quot;synConstant&quot;&gt;:price&lt;/span&gt;
  .field
    = f.label &lt;span class=&quot;synConstant&quot;&gt;:discontinued&lt;/span&gt;
    %br
    = f.check_box &lt;span class=&quot;synConstant&quot;&gt;:discontinued&lt;/span&gt;

  .actions
    = f.submit
&lt;/pre&gt;&lt;p&gt;では、新規画面を開いてみましょう。&lt;br /&gt;
上手く行っていますね。順調です。&lt;/p&gt;&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140929/20140929220337.png&quot; alt=&quot;f:id:nipe880324:20140929220337p:plain:w480&quot; title=&quot;f:id:nipe880324:20140929220337p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;詳細画面&lt;/h4&gt;
    &lt;p&gt;では、この調子で最後に詳細画面を変換していきましょう。&lt;br /&gt;
変換にも慣れてきたと思います。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/products/show.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;notice&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; notice&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Name:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; @product.name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Description:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; @product.description&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Price:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; @product.price&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Discontinued:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; @product.discontinued&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Edit&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, edit_product_path(@product) %&amp;gt;&lt;/span&gt; |
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Back&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, products_path %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
Hamlへの変換のポイントは&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;id属性は&lt;code&gt;#&lt;/code&gt;、class属性は&lt;code&gt;.&lt;/code&gt;で記載し、タグの直後に記載する（例：&lt;code&gt;%p.error&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;#&lt;/code&gt;や&lt;code&gt;.&lt;/code&gt;の前にタグ名を記載しない場合（例： &lt;code&gt;.disable&lt;/code&gt;）は、div要素として変換されます。&lt;/li&gt;
&lt;li&gt;複数のクラスを記載したい場合は、&lt;code&gt;.&lt;/code&gt;でつなげる（例：&lt;code&gt;input.btn.btn-default.btn-sm&lt;/code&gt;）&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/show.html.haml&lt;/span&gt;
%p&lt;span class=&quot;synComment&quot;&gt;#notice= notice&lt;/span&gt;

%p
  %strong &lt;span class=&quot;synType&quot;&gt;Name&lt;/span&gt;:
  = &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.name

%p
  %strong &lt;span class=&quot;synType&quot;&gt;Description&lt;/span&gt;:
  = &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.description

%p
  %strong &lt;span class=&quot;synType&quot;&gt;Price&lt;/span&gt;:
  = &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.price

%p
  %strong &lt;span class=&quot;synType&quot;&gt;Discontinued&lt;/span&gt;:
  = &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.discontinued

= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Edit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, edit_product_path(&lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;)
\|
= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Back&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, products_path
&lt;/pre&gt;&lt;p&gt;では、詳細画面を見てみましょう。&lt;br /&gt;
これで、一通りの画面をSlimにすることができました :)&lt;/p&gt;&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140929/20140929220852.png&quot; alt=&quot;f:id:nipe880324:20140929220852p:plain:w480&quot; title=&quot;f:id:nipe880324:20140929220852p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;haml-refarence-sheet&quot;&gt;4. おまけ：Hamlのリファレンスシート&lt;/h3&gt;Hamlの変換ルールで困った場合は次のURLを参照して下さい。&lt;br /&gt;
&lt;a href=&quot;http://haml.info/docs/yardoc/file.REFERENCE.html&quot; target=&quot;_blank&quot;&gt;http://haml.info/docs/yardoc/file.REFERENCE.html&lt;/a&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;haml-tools-erb2haml&quot;&gt;5. おまけ：ERBをHamlに変換するツール: erb2haml&lt;/h3&gt;また、既にerbで多くのViewファイルを作成してしまっている場合は、erbをhamlに変換する&lt;b&gt;erb2haml&lt;/b&gt;というツールがあります。&lt;br /&gt;
&lt;a href=&quot;http://codenote.net/ruby/rails/1009.html&quot; target=&quot;_blank&quot;&gt;erb2hamlの使い方&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;ちなみに、ツールは万能でなく、上手くHamlに変換できてない箇所が存在する可能性もあるので、全ての画面に対してレイアウト崩れのチェックはしてください。&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;参考文献&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://haml.info/&quot; target=&quot;_blank&quot;&gt;Haml 公式ドキュメント&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;以上です。&lt;br /&gt;
よく分からない箇所や誤りなどがありましたら、コメントの記入をお願いします。&lt;/p&gt;

&lt;/div&gt;</description>
          <pubDate>Wed, 01 Oct 2014 02:10:51 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/8454420450066704287</guid>
          
            <category>Rails View</category>
          
            <category>Rails gem</category>
          
        </item>
      
    
      
      
        <item>
          <title>早い、簡単、生産的!? RailsのHTMLテンプレートエンジン Slim入門</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20140929/1411997071</link>
          <description>
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;はじめに&lt;/h3&gt;
    &lt;p&gt;&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Rails&quot;&gt;Rails&lt;/a&gt;ではView（HTML出力）のためには標準ではERB(.erb)を使用しています。&lt;br /&gt;
しかし、erbは汎用的なテンプレートエンジンであり、HTML以外にも様々なファイルに&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Ruby&quot;&gt;Ruby&lt;/a&gt;コードを&lt;br /&gt;
埋め込めることができるため、HTMLを作成するにおいていくらか冗長な箇所があります。&lt;/p&gt;&lt;p&gt;そのため、より生産的にHTMLを作成するために、&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Rails&quot;&gt;Rails&lt;/a&gt;では&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Slim （&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/%B3%C8%C4%A5%BB%D2&quot;&gt;拡張子&lt;/a&gt; xxx.html.slim）&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Haml&quot;&gt;Haml&lt;/a&gt; （&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/%B3%C8%C4%A5%BB%D2&quot;&gt;拡張子&lt;/a&gt; xxx.html.&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/haml&quot;&gt;haml&lt;/a&gt;）&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;という２つのHTML用のテンプレートエンジンがよく使われます。&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;そして、今回はタイトルからも分かるように&lt;b&gt;Slim&lt;/b&gt;について説明します。&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Haml&quot;&gt;Haml&lt;/a&gt;については、&lt;a href=&quot;/entry/20141001/1412097051&quot; target=&quot;_blank&quot;&gt;こちら&lt;/a&gt;を参照して下さい。&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Slimの特徴としては、&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;タブによりHTMLのタグ構造を表すので、必要最低限のコードだけで良いのでコーディング時間が減る&lt;/li&gt;
&lt;li&gt;デフォルトでHTMLエスケープをするので安全&lt;/li&gt;
&lt;li&gt;erbに比べて、スピードが速い&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;※ほぼ&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Haml&quot;&gt;Haml&lt;/a&gt;と同じです。&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Rails&quot;&gt;Rails&lt;/a&gt; 4.1&lt;/li&gt;
&lt;li&gt;slim 2.0.3&lt;/li&gt;
&lt;li&gt;slim-&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/rails&quot;&gt;rails&lt;/a&gt; 2.1.5&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;目次&lt;/h3&gt;
    
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;#slim-basic&quot;&gt;Slimの基礎&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#slim-introduce-to-slim&quot;&gt;RailsにSlimの導入&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#slim-translate-to-slim-from-erb&quot;&gt;erbをslimに書き換えていく&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#slim-refarence-sheet&quot;&gt;おまけ：Slimのリファレンスシート&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#slim-tools-html2slim&quot;&gt;おまけ：HTMLやerbをSlimに変換するツール: html2slim&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;&lt;br /&gt;
&lt;h3 id=&quot;slim-basic&quot;&gt;1. Slimの基礎&lt;/h3&gt;Slimはシンプルな記法で難しくはないので、実際にerbとslimの&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/%A5%BD%A1%BC%A5%B9%A5%B3%A1%BC%A5%C9&quot;&gt;ソースコード&lt;/a&gt;を比べて、１つ１つ説明していきます。&lt;br /&gt;
Slimの&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/%B3%C8%C4%A5%BB%D2&quot;&gt;拡張子&lt;/a&gt;は、&lt;code&gt;.slim&lt;/code&gt;にする必要があります。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/layouts/application.html.erb
&lt;span class=&quot;synComment&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;SlimTest&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; stylesheet_link_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;application&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;all&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;data-turbolinks-track&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; =&amp;gt;&lt;/span&gt;&lt;span class=&quot;synPreProc&quot;&gt; true %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; javascript_include_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;application&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;data-turbolinks-track&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; =&amp;gt;&lt;/span&gt;&lt;span class=&quot;synPreProc&quot;&gt; true %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; csrf_meta_tags&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;header&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;header&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;title logo&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Slim Test&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;header&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; yield&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/layouts/application.html.slim&lt;/span&gt;
&lt;span class=&quot;synType&quot;&gt;DOCTYPE&lt;/span&gt;
html
  head
    title &lt;span class=&quot;synType&quot;&gt;SlimTest&lt;/span&gt;
    = stylesheet_link_tag    &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;media&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;data-turbolinks-track&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
    = javascript_include_tag &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;data-turbolinks-track&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;
    = csrf_meta_tags

  body

    header&lt;span class=&quot;synComment&quot;&gt;#header&lt;/span&gt;
      h1.title.logo &lt;span class=&quot;synType&quot;&gt;Slim&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;Test&lt;/span&gt;

    == &lt;span class=&quot;synStatement&quot;&gt;yield&lt;/span&gt;
&lt;/pre&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;Slimの簡単な覚え方&lt;/h4&gt;
    &lt;p&gt;上記のerbとslimを見比べながら、下記のルールを見て下さい。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;code&gt;&amp;lt;、&amp;gt;、&amp;lt;%、%&amp;gt;&lt;/code&gt;などのタグを削除する。閉じタグは全て削除する。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;each、if&lt;/code&gt;などのロジック部分の先頭に&lt;code&gt;-&lt;/code&gt;を記載する。（&lt;code&gt;end&lt;/code&gt;は必要ない)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;lt;%= ... &amp;gt;&lt;/code&gt;は&lt;code&gt;=&lt;/code&gt;にする。&lt;code&gt;yield&lt;/code&gt;と&lt;code&gt;render&lt;/code&gt;のときは、&lt;code&gt;==&lt;/code&gt;にする。&lt;/li&gt;
&lt;li&gt;class属性やid属性は、&lt;code&gt;p.fields&lt;/code&gt;や&lt;code&gt;p#contents&lt;/code&gt;などにする。タグがdivのときはdivを省略し&lt;code&gt;#content&lt;/code&gt;と記載する。&lt;/li&gt;
&lt;li&gt;コメントは、&lt;code&gt;/ このコメントはHTMLに変換後に表示されない&lt;/code&gt;か&lt;code&gt;/! このコメントはHTMLに変換後にコメントになる&lt;/code&gt;で記載する。&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;&lt;br /&gt;
&lt;h3 id=&quot;slim-introduce-to-slim&quot;&gt;2. &lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Rails&quot;&gt;Rails&lt;/a&gt;にSlimの導入&lt;/h3&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Rails&quot;&gt;Rails&lt;/a&gt;プロジェクトの作成&lt;/h4&gt;
    &lt;p&gt;まず、いつも通り&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Rails&quot;&gt;Rails&lt;/a&gt;プロジェクトを作成します。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;$ rails new slim_test&lt;/pre&gt;&lt;p&gt;次に、商品(Product)のソース一式をScaffoldを使って作成します。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;$ cd slim_test
$ rails g scaffold Product name:string description:text price:integer discontinued:boolean&lt;/pre&gt;&lt;p&gt;DBマイグレートをします。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;$ rake db:migrate&lt;/pre&gt;&lt;p&gt;これで、商品(Product)の一覧表示、作成、更新、削除ができました。&lt;br /&gt;
&lt;code&gt;$ rails server&lt;/code&gt;でローカルのサーバを起動していくつかデータを入力してみました。&lt;/p&gt;&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140929/20140929214513.png&quot; alt=&quot;f:id:nipe880324:20140929214513p:plain:w480&quot; title=&quot;f:id:nipe880324:20140929214513p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;Slimを&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Rails&quot;&gt;Rails&lt;/a&gt;に導入&lt;/h4&gt;
    &lt;p&gt;では、実際に&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Rails&quot;&gt;Rails&lt;/a&gt;にSlimを導入していきましょう。&lt;br /&gt;
&lt;code&gt;Gemfile&lt;/code&gt;に下記を追加します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;gem &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;slim-rails&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;その後、Slimをインストールします。&lt;/p&gt;
&lt;pre class=&quot;code&quot; data-lang=&quot;&quot; data-unlink&gt;$ bundle install&lt;/pre&gt;&lt;p&gt;これで、&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Rails&quot;&gt;Rails&lt;/a&gt;にSlimが導入されたので、以降は&lt;code&gt;xxx.html.slim&lt;/code&gt;という&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/%B3%C8%C4%A5%BB%D2&quot;&gt;拡張子&lt;/a&gt;でファイルを作成することで&lt;b&gt;Slim&lt;/b&gt;として&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Rails&quot;&gt;Rails&lt;/a&gt;が読み込んでくれます。&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;b&gt;ERB&lt;/b&gt;と&lt;b&gt;Slim&lt;/b&gt;で同名のファイルがある場合は、&lt;b&gt;ERB&lt;/b&gt;が読み込まれるので、ERBファイルは削除して下さい。例えば、&lt;code&gt;index.html.erb&lt;/code&gt;と&lt;code&gt;index.html.slim&lt;/code&gt;がある場合、&lt;code&gt;index.html.erb&lt;/code&gt;が読み込まれてしまうため、削除して下さい。&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;slim-&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/rails&quot;&gt;rails&lt;/a&gt; gem をインストール後に、&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/rails&quot;&gt;rails&lt;/a&gt; generaterでscaffoldやcontrollerを作成すると、ビューファイルは全て&lt;code&gt;.erb&lt;/code&gt;の代わりに&lt;code&gt;.slim&lt;/code&gt;で作成されます。&lt;/i&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;slim-translate-to-slim-from-erb&quot;&gt;2. erbをslimに書き換えていく&lt;/h3&gt;では、Scaffoldで作成した&lt;code&gt;.erb&lt;/code&gt;を１画面ずつ&lt;code&gt;.slim&lt;/code&gt;に変更していきます。&lt;br /&gt;
変更後のSlimファイルを見る前に、自分で上記の「1. Slimの基礎」を確認しながら手を動かしながらSlimファイルを作成することにより、Slimの書き方に慣れるのでおすすめです。&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;一覧画面&lt;/h4&gt;
    &lt;p&gt;まずは、一覧画面を変更します。&lt;br /&gt;
&lt;code&gt;index.html.erb&lt;/code&gt;は次のようになっています。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/products/index.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Listing products&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;thead&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tr&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Name&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Description&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Price&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Discontinued&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;colspan&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;th&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tr&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;thead&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tbody&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% @products.each do |product| %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tr&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; product.name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; product.description&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; product.price&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; product.discontinued&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Show&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, product %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Edit&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, edit_product_path(product) %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Destroy&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, product, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: :delete, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: { confirm: &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Are you sure?&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; } %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;td&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tr&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;tbody&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;New Product&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, new_product_path %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
&lt;code&gt;index.html.slim&lt;/code&gt;を新しく作成し、これを１つ１つ直していきましょう。&lt;/p&gt;&lt;p&gt;下記が変換後の一覧画面です。&lt;br /&gt;
基本は、&lt;code&gt;&amp;lt;と&amp;gt;&lt;/code&gt;を削除し、&lt;code&gt;each&lt;/code&gt;などのロジック部分は&lt;code&gt;-&lt;/code&gt;をつける、閉じタグは削除です。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/index.html.slim&lt;/span&gt;
h1 &lt;span class=&quot;synType&quot;&gt;Listing&lt;/span&gt; products

table
  thead
    tr
      th &lt;span class=&quot;synType&quot;&gt;Name&lt;/span&gt;
      th &lt;span class=&quot;synType&quot;&gt;Description&lt;/span&gt;
      th &lt;span class=&quot;synType&quot;&gt;Price&lt;/span&gt;&amp;lt;
      th &lt;span class=&quot;synType&quot;&gt;Discontinued&lt;/span&gt;
      th colspan=&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;

  tbody
    - &lt;span class=&quot;synIdentifier&quot;&gt;@products&lt;/span&gt;.each &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;product&lt;/span&gt;|
      tr
        td = product.name
        td = product.description
        td = product.price
        td = product.discontinued
        td = link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Show&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, product
        td = link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Edit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, edit_product_path(product)
        td = link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Destroy&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, product, &lt;span class=&quot;synConstant&quot;&gt;method&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:delete&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;data&lt;/span&gt;: { &lt;span class=&quot;synConstant&quot;&gt;confirm&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Are you sure?&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; }

br

= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;New Product&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, new_product_path
&lt;/pre&gt;&lt;p&gt;&lt;code&gt;.erb&lt;/code&gt;ファイルが存在するとそちらが表示されてしまうので、ファイル名を変更するか削除してから、&lt;br /&gt;
サーバーを再起動しなおして、一覧画面を確認してみましょう。&lt;br /&gt;
表示は変わっていませんね。&lt;/p&gt;&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140929/20140929214513.png&quot; alt=&quot;f:id:nipe880324:20140929214513p:plain:w480&quot; title=&quot;f:id:nipe880324:20140929214513p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;新規/編集画面&lt;/h4&gt;
    &lt;p&gt;次は、新規、編集画面です。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/products/new.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;New product&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; render&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;form&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Back&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, products_path %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/products/edit.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Editing product&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; render&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;form&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Show&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, @product %&amp;gt;&lt;/span&gt; |
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Back&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, products_path %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/products/_form.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; form_for(@product)&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; do |f| %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% if @product.errors.any? %&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;error_explanation&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; pluralize(@product.errors.count,&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;error&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;) %&amp;gt;&lt;/span&gt; prohibited this product from being saved:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% @product.errors.full_messages.each do |message| %&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; message&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :description %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_area&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :description %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :price %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.number_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :price %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :discontinued %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.check_box&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :discontinued %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;actions&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.submit&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
ではSlimに変換します。&lt;br /&gt;
&lt;code&gt;render&lt;/code&gt;や&lt;code&gt;yeild&lt;/code&gt;は、&lt;code&gt;=&lt;/code&gt;ではなく、&lt;code&gt;==&lt;/code&gt;です。&lt;br /&gt;
また、文字列(今回は&lt;b&gt;|&lt;/b&gt;)を表示するには、&lt;b&gt;&#39;&lt;/b&gt;が必要です。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/new.html.slim&lt;/span&gt;
h1 &lt;span class=&quot;synType&quot;&gt;New&lt;/span&gt; product

== render &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;

= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Back&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, products_path
&lt;/pre&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/edit.html.slim&lt;/span&gt;
h1 &lt;span class=&quot;synType&quot;&gt;Editing&lt;/span&gt; product

== render &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;

= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Show&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;
&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;synConstant&quot;&gt;= link_to &lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;Back&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;, products_path&lt;/span&gt;
&lt;/pre&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/_form.html.slim&lt;/span&gt;
= form_for(&lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;) &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;f&lt;/span&gt;|
  - &lt;span class=&quot;synStatement&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.errors.any?
    &lt;span class=&quot;synComment&quot;&gt;#error_explanation&lt;/span&gt;
      h2 = &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;#{&lt;/span&gt;pluralize(&lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.errors.count, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)&lt;span class=&quot;synSpecial&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; prohibited this product from being saved:&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;

      ul
        - &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.errors.full_messages.each &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;message&lt;/span&gt;|
          li = message

  .field
    = f.label &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;
    br
    = f.text_field &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;
  .field
    = f.label &lt;span class=&quot;synConstant&quot;&gt;:description&lt;/span&gt;
    br
    = f.text_area &lt;span class=&quot;synConstant&quot;&gt;:description&lt;/span&gt;
  .field
    = f.label &lt;span class=&quot;synConstant&quot;&gt;:price&lt;/span&gt;
    br
    = f.number_field &lt;span class=&quot;synConstant&quot;&gt;:price&lt;/span&gt;
  .field
    = f.label &lt;span class=&quot;synConstant&quot;&gt;:discontinued&lt;/span&gt;
    br
    = f.check_box &lt;span class=&quot;synConstant&quot;&gt;:discontinued&lt;/span&gt;
  .actions
    = f.submit
&lt;/pre&gt;&lt;p&gt;では、新規画面を開いてみましょう。&lt;br /&gt;
上手く行っていますね。順調です。&lt;/p&gt;&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140929/20140929220337.png&quot; alt=&quot;f:id:nipe880324:20140929220337p:plain:w480&quot; title=&quot;f:id:nipe880324:20140929220337p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;詳細画面&lt;/h4&gt;
    &lt;p&gt;では、この調子で詳細画面を変換していきましょう。&lt;br /&gt;
ほぼほぼ慣れてきたと思います。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/products/show.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;notice&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; notice&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Name:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; @product.name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Description:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; @product.description&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Price:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; @product.price&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Discontinued:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;strong&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; @product.discontinued&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Edit&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, edit_product_path(@product) %&amp;gt;&lt;/span&gt; |
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; link_to&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;Back&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, products_path %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
Slimへの変換のポイント&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;id属性は&lt;code&gt;#&lt;/code&gt;、class属性は&lt;code&gt;.&lt;/code&gt;で始めることがコツです&lt;/li&gt;
&lt;li&gt;&lt;code&gt;#&lt;/code&gt;や&lt;code&gt;.&lt;/code&gt;の前にタグ名を記載しない場合（例： &lt;code&gt;.disable&lt;/code&gt;）は、div要素として変換されます。&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/%CA%A3%BF%F4&quot;&gt;複数&lt;/a&gt;のクラスを記載したい場合は、&lt;code&gt;.&lt;/code&gt;でつなげる（例：&lt;code&gt;input.btn.btn-default.btn-sm&lt;/code&gt;）&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/show.html.haml&lt;/span&gt;
p&lt;span class=&quot;synComment&quot;&gt;#notice = notice&lt;/span&gt;

p
  strong &lt;span class=&quot;synType&quot;&gt;Name&lt;/span&gt;:
  = &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.name

p
  strong &lt;span class=&quot;synType&quot;&gt;Description&lt;/span&gt;:
  = &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.description

p
  strong &lt;span class=&quot;synType&quot;&gt;Price&lt;/span&gt;:
  = &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.price

p
  strong &lt;span class=&quot;synType&quot;&gt;Discontinued&lt;/span&gt;:
  = &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;.discontinued

= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Edit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, edit_product_path(&lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;)
&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;synConstant&quot;&gt;= link_to &lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;Back&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;, products_path&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;では、詳細画面を見てみましょう。&lt;br /&gt;
これで、一通りの画面をSlimにすることができました :)&lt;/p&gt;&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140929/20140929220852.png&quot; alt=&quot;f:id:nipe880324:20140929220852p:plain:w480&quot; title=&quot;f:id:nipe880324:20140929220852p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;slim-refarence-sheet&quot;&gt;4. おまけ：Slimのリファレンスシート&lt;/h3&gt;Slimの変換ルールで困った場合は次のURLを参照して下さい。&lt;br /&gt;
&lt;a href=&quot;http://www.e2esound.com/wp/2013/07/22/21_tips_to_use_slim_for_markup_engineer/#sec16&quot; target=&quot;_blank&quot;&gt;http://www.e2esound.com/wp/2013/07/22/21_tips_to_use_slim_for_markup_engineer/#sec16&lt;/a&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;slim-tools-html2slim&quot;&gt;5. おまけ：HTMLやerbをSlimに変換する&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/%A5%C4%A1%BC%A5%EB&quot;&gt;ツール&lt;/a&gt;: html2slim&lt;/h3&gt;また、既にerbで多くのViewファイルを作成してしまっている場合は、erbをslimに変換する&lt;b&gt;html2slim&lt;/b&gt;という&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/%A5%C4%A1%BC%A5%EB&quot;&gt;ツール&lt;/a&gt;があります。&lt;br /&gt;
&lt;a href=&quot;http://www.mocchiblog.com/?p=14680&quot; target=&quot;_blank&quot;&gt;html2slimの使い方&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;ちなみに、&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/%A5%C4%A1%BC%A5%EB&quot;&gt;ツール&lt;/a&gt;は万能ではなく、上手くSlimに変換できてない箇所がある可能性もあるので、全ての画面に対してレイアウト崩れのチェックはしてください。&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;参考文献&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://rdoc.info/gems/slim/frames&quot; target=&quot;_blank&quot;&gt;Slim 公式ドキュメント&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://qiita.com/yterajima/items/53fd0387279510ff082a&quot; target=&quot;_blank&quot;&gt;Slimの入門記事&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;以上です。&lt;br /&gt;
よく分からない箇所や誤りなどがありましたら、コメントの記入をお願いします。&lt;/p&gt;

&lt;/div&gt;</description>
          <pubDate>Mon, 29 Sep 2014 22:24:31 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/12921228815731681786</guid>
          
            <category>Rails View</category>
          
            <category>Rails gem</category>
          
        </item>
      
    
      
      
        <item>
          <title>Railsでビューのレイアウトを指定する</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20140810/1407603600</link>
          <description>&lt;p&gt;Railsのレイアウトファイルの使い方について説明します。&lt;/p&gt;&lt;p&gt;ページのヘッダー、ナビゲーションバー、フッターなどの大枠はRailsアプリを通して共通になるのが一般的です。&lt;/p&gt;&lt;p&gt;Railsではこのような共通の枠組みを記載したファイルを「&lt;b&gt;レイアウトファイル&lt;/b&gt;」と呼び、&lt;code&gt;app/views/layouts&lt;/code&gt;配下に配置します。&lt;/p&gt;&lt;p&gt;また、コントローラーやアクションで個別で指定したり、レイアウトファイルを非表示にしたり、レイアウトファイルに動的データを渡すことができます。&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;Rails 4.1&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;目次&lt;/h3&gt;
    
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;#ctrl-default-layout&quot;&gt;デフォルトのレイアウトファイル&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ctrl-indicate-layout&quot;&gt;レイアウトファイルを指定&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ctrl-pass-data&quot;&gt;レイアウトファイルにデータを渡す&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;ctrl-default-layout&quot;&gt;1. デフォルトのレイアウトファイル&lt;/h3&gt;デフォルトでは、「&lt;b&gt;app/views/layouts/application.html.erb&lt;/b&gt;」がレイアウトファイルとして使われます。&lt;br /&gt;
そして、&lt;code&gt;yield&lt;/code&gt;の箇所が各コントローラーで表示するテンプレートが表示されます。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/layouts/application.html.erb
&lt;span class=&quot;synComment&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;ControllerTest&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; stylesheet_link_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;application&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;all&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;data-turbolinks-track&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; =&amp;gt;&lt;/span&gt;&lt;span class=&quot;synPreProc&quot;&gt; true %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; javascript_include_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;application&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;data-turbolinks-track&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; =&amp;gt;&lt;/span&gt;&lt;span class=&quot;synPreProc&quot;&gt; true %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; csrf_meta_tags&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; yield&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;ctrl-indicate-layout&quot;&gt;2. レイアウトファイルを指定&lt;/h3&gt;コントローラーに&lt;code&gt;layout&lt;/code&gt;宣言をすることで、&lt;b&gt;コントローラーが使うレイアウトを指定すること&lt;/b&gt;ができます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/controllers/products_controller.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ProductsController&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ApplicationController&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# app/views/layouts/special_layout.html.erbをレイアウトファイルとして使う&lt;/span&gt;
  layout &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;special_layout&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# except(除く)やonly(のみ)を使うことで、レイアウトを指定するアクションを絞ることができる&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# layout &amp;quot;special_layout&amp;quot;, except: [:new, :edit]&lt;/span&gt;
  ...
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
また、renderメソッドの&lt;code&gt;layout&lt;/code&gt;オプションを指定することで、アクション内でレイアウトを指定できる。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;index&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;@products&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;Product&lt;/span&gt;.all

  &lt;span class=&quot;synComment&quot;&gt;# special_layoutで、index.html.erbを表示する&lt;/span&gt;
  render &lt;span class=&quot;synConstant&quot;&gt;:index&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;layout&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;special_layout&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# レイアウトを使わないで、index.html.erbを表示する&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# render :index, layout: false&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;ctrl-pass-data&quot;&gt;3. レイアウトファイルにデータを渡す&lt;/h3&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;レイアウトファイル内では、テンプレートファイルで使用できるインスタンス変数やセッションデータなどすべてのデータにアクセスできます。&lt;/li&gt;
&lt;li&gt;さらに、テンプレートファイルで設定されたインスタンス変数にもアクセスすることができます。&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;これを利用することで、ヘッダー、サイドバー、フッターにページ固有のHTMLを表示することができます。&lt;br /&gt;
よくある例として、「ページ固有のタイトル表示」、「ページ固有のコンテンツ表示」の仕方を説明します。&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;ページ固有のタイトルを表示する&lt;/h4&gt;
    &lt;p&gt;まず、個々のテンプレートファイルで&lt;code&gt;provide&lt;/code&gt;メソッドでタイトルを設定します。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# テンプレートファイル
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; provide(:title,&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;個別タイトル&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;) %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;個別タイトル&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
...
&lt;/pre&gt;&lt;p&gt;レイアウトファイルでは設定された値を&lt;code&gt;yeild&lt;/code&gt;で表示します。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# レイアウトファイル
&lt;span class=&quot;synComment&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synComment&quot;&gt;&amp;lt;!-- 「Sample Application | 個別タイトル」とタイトルに表示される --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;Sample Application | &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; yield(:title)&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; stylesheet_link_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;application&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;all&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;data-turbolinks-track&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; =&amp;gt;&lt;/span&gt;&lt;span class=&quot;synPreProc&quot;&gt; true %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; javascript_include_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;application&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&#39;data-turbolinks-track&#39;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; =&amp;gt;&lt;/span&gt;&lt;span class=&quot;synPreProc&quot;&gt; true %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; csrf_meta_tags&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
...
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;ページ固有のコンテンツを表示する&lt;/h4&gt;
    &lt;p&gt;まず、個々のテンプレートファイルで&lt;code&gt;content_for&lt;/code&gt;メソッドでコンテンツを作成します。&lt;br /&gt;
ここでは、サイドバーの表示を設定しています。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# テンプレートファイル
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;テンプレートファイル&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; content_for(:sidebar)&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;  do %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;このリストはこのテンプレートが表示された&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;ときだけ表示されます。&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;レイアウトファイルでは設定されたコンテンツを&lt;code&gt;yeild&lt;/code&gt;で表示します。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# レイアウトファイル
...
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;main&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; yield&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;sidebar&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;全てのページに表示されるリスト項目&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synComment&quot;&gt;&amp;lt;!-- テンプレートファイルに定義した sidebar が表示されます。&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;             設定されていない場合はこのli要素は表示されせん --&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; yield(:sidebar)&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
以上です。&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;参考文献&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;RailsによるアジャイルWebアプリケーション開発 第4版&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;</description>
          <pubDate>Sun, 10 Aug 2014 02:00:00 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/12921228815729872238</guid>
          
            <category>Rails初級</category>
          
            <category>Rails Controller</category>
          
            <category>Rails View</category>
          
        </item>
      
    
      
      
        <item>
          <title>RailsのViewでのrenderメソッドの使い方</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20140807/1407419013</link>
          <description>&lt;p&gt;RailsのViewでの&lt;code&gt;render&lt;/code&gt;メソッドの使い方について説明します。&lt;br /&gt;
&lt;code&gt;render&lt;/code&gt;メソッドは、「コントローラー(Controller)」と「ビュー(View)」それぞれにあります。&lt;br /&gt;
ここではビューのrenderメソッドの使い方を示します。&lt;/p&gt;&lt;p&gt;&lt;i&gt;コントローラーのrenderメソッドの使い方を知りたい場合は、&lt;a href=&quot;http://ruby-rails.hatenadiary.com/entry/20141125/1416918957&quot;&gt;こちら&lt;/a&gt;へ&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;Rails 4.1&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;目次&lt;/h3&gt;
    
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;#render-view-desc&quot;&gt;ビュー内での&lt;code&gt;render&lt;/code&gt;メソッドについて&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#render-view-partial&quot;&gt;部分テンプレートを表示するrenderメソッド&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#render-view-object&quot;&gt;部分テンプレートにオブジェクトを渡すrenderメソッド&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#render-view-collection&quot;&gt;部分テンプレートでコレクションを表示するrenderメソッド&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;&lt;br /&gt;
&lt;h3 id=&quot;render-view-desc&quot;&gt;1. ビュー内での&lt;code&gt;render&lt;/code&gt;メソッドについて&lt;/h3&gt;ビュー内での&lt;code&gt;render&lt;/code&gt;メソッドは、部分テンプレート（partial）を表示するために使います。&lt;br /&gt;
部分テンプレートとは、共通のビューの表示を別ファイルに切り出すことができ、様々なビューから呼び出すことができます。&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;render-view-partial&quot;&gt;2. 部分テンプレートを表示するrenderメソッド&lt;/h3&gt;一般的な例として、新規と編集ページのフォーム表示部分は部分テンプレートになっているので、それを説明します。&lt;br /&gt;
&lt;b&gt;部分テンプレートは必ずアンダースコア（_）で始まる必要があります。&lt;/b&gt;&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 部分テンプレート（呼び出される側）&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# app/views/products/_form.html.erb&lt;/span&gt;

&amp;lt;%= form_for(&lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;) &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;f&lt;/span&gt;| %&amp;gt;
  &amp;lt;div &lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt;=&amp;quot;field&amp;quot;&amp;gt;
    &amp;lt;%= f.label &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt; %&amp;gt;&amp;lt;br&amp;gt;
    &amp;lt;%= f.text_field &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt; %&amp;gt;
  &amp;lt;/div&amp;gt;
  &amp;lt;div &lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt;=&amp;quot;actions&amp;quot;&amp;gt;
    &amp;lt;%= f.submit %&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;% &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt; %&amp;gt;
&lt;/pre&gt;&lt;p&gt;部分テンプレートを呼び出す側では、renderメソッドと引数にアンダースコア抜きのファイル名を指定します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 新規画面（呼び出し側）&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# app/views/products/new.html.erb&lt;/span&gt;
&amp;lt;h1&amp;gt;&lt;span class=&quot;synType&quot;&gt;New&lt;/span&gt; product&amp;lt;/h1&amp;gt;

&amp;lt;%= render &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; %&amp;gt;

&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Back&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, products_path %&amp;gt;
&lt;/pre&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 編集画面（呼び出し側）&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# app/views/products/edit.html.erb&lt;/span&gt;
&amp;lt;h1&amp;gt;&lt;span class=&quot;synType&quot;&gt;Editing&lt;/span&gt; product&amp;lt;/h1&amp;gt;

&amp;lt;%= render &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; %&amp;gt;

&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Show&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt; %&amp;gt; |
&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Back&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, products_path %&amp;gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
&lt;h3 id=&quot;render-view-object&quot;&gt;3. 部分テンプレートにオブジェクトを渡すrenderメソッド&lt;/h3&gt;renderメソッドは、下記のようにオブジェクトを渡すことができます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 部分テンプレートを呼び出す側&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# app/views/products/index.html.erb&lt;/span&gt;
...
&amp;lt;% products.each &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;product&lt;/span&gt;| %&amp;gt;
  &amp;lt;!-- &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;object:&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;の部分は任意の名前で良いです。
     部分テンプレート内ではその名前でオブジェクトにアクセスできます。--&amp;gt;
  &amp;lt;%= render &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;product&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;object&lt;/span&gt;: product %&amp;gt;
&amp;lt;% &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt; %&amp;gt;
...
&lt;/pre&gt;&lt;p&gt;部分テンプレート側では、「呼び出し側で指定した名前」でオブジェクトにアクセスできます。（&quot;object&quot;でアクセスしている）&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 部分テンプレート側&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# app/views/products/_product.html.erb&lt;/span&gt;
&amp;lt;%= object.name %&amp;gt; |
&amp;lt;%= object.price %&amp;gt; |
&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Show&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, object %&amp;gt;
&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Edit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, edit_product_path(object) %&amp;gt;
&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Destroy&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, object, &lt;span class=&quot;synConstant&quot;&gt;method&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:delete&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;data&lt;/span&gt;: { &lt;span class=&quot;synConstant&quot;&gt;confrim&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Are you sure?&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; } %&amp;gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
&lt;h3 id=&quot;render-view-collection&quot;&gt;4. 部分テンプレートでコレクションを表示するrenderメソッド&lt;/h3&gt;部分テンプレートでコレクションを表示する場合、特定の条件が整っているとループ処理などを省くことができます。上記の例はコレクションを表示しているので書き直してみます。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;呼び出し側では、renderメソッドにコレクションを渡す（例：@products）&lt;/li&gt;
&lt;li&gt;呼び出される側では、ファイル名をコレクションの単数系にする（例：_product.html.erb）。さらに、オブジェクトにはその単数系でアクセスできます。（例：product.&lt;i&gt;method&lt;/i&gt;）&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 部分テンプレートを呼び出す側&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# app/views/products/index.html.erb&lt;/span&gt;
...
&amp;lt;!-- コレクションの変数を渡すとループ処理が必要なくなる。
   &lt;span class=&quot;synType&quot;&gt;Rails&lt;/span&gt;は変数名の単数系の部分テンプレートを呼び出す。
   今回は、app/views/products/_product.html.erb --&amp;gt;
&amp;lt;%= render &lt;span class=&quot;synIdentifier&quot;&gt;@products&lt;/span&gt; %&amp;gt;
...
&lt;/pre&gt;&lt;p&gt;部分テンプレート側では、「変数名の単数系の名前」でオブジェクトにアクセスできます。&lt;br /&gt;
（以下では、&quot;product&quot;でアクセスしています）&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 部分テンプレート側&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# app/views/products/_product.html.erb&lt;/span&gt;
&amp;lt;%= product.name %&amp;gt; |
&amp;lt;%= product.price %&amp;gt; |
&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Show&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, product %&amp;gt;
&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Edit&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, edit_product_path(product) %&amp;gt;
&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Destroy&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, product, &lt;span class=&quot;synConstant&quot;&gt;method&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:delete&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;data&lt;/span&gt;: { &lt;span class=&quot;synConstant&quot;&gt;confrim&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;Are you sure?&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; } %&amp;gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
以上です。&lt;/p&gt;

&lt;/div&gt;</description>
          <pubDate>Thu, 07 Aug 2014 22:43:33 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/12921228815729761679</guid>
          
            <category>Rails初級</category>
          
            <category>Rails View</category>
          
        </item>
      
    
      
      
        <item>
          <title>Railsで独自ヘルパー(Helper)メソッドの作成方法</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20140803/1407049200</link>
          <description>&lt;p&gt;Railsでの自前の独自ヘルパー(Helper)メソッドの作成方法について説明します。&lt;/p&gt;&lt;p&gt;Railsが既に多くのヘルパーメソッドを用意しているため、 &lt;a href=&quot;http://www.google.co.jp/&quot; target=&quot;_blank&quot;&gt;Google検索&lt;/a&gt; や &lt;a href=&quot;http://api.rubyonrails.org/&quot; target=&quot;_blank&quot;&gt;Rails API 公式ページ&lt;/a&gt;で探して、それでもなかったら実装して下さい。&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;Rails 4.1&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;目次&lt;/h3&gt;
    
&lt;ol&gt;
&lt;li&gt;独自ヘルパーメソッドの実装&lt;/li&gt;
&lt;li&gt;独自ヘルパーメソッドの使用&lt;/li&gt;
&lt;li&gt;一歩上のRailsのヘルパーについての情報&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;独自ヘルパーメソッドの実装&lt;/h3&gt;
    &lt;p&gt;ヘルパーモジュールは、&lt;code&gt;app/helpers&lt;/code&gt;配下にあります。&lt;br /&gt;
使い分けとして、&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;application_helper.rb&lt;/code&gt;は、アプリケーション全体にわたって使うヘルパーメソッドを定義&lt;/li&gt;
&lt;li&gt;&lt;code&gt;xxxxx_helper.rb&lt;/code&gt;は、その&quot;xxxxx&quot;だけで使うヘルパーメソッドを定義&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;という使い分けにすると、ヘルパーメソッドの管理が楽になります。&lt;/p&gt;&lt;p&gt;今回は、「条件が true の場合に、&lt;code&gt;divタグ&lt;/code&gt;を表示するヘルパーメソッド」を作ります。&lt;br /&gt;
アプリケーション全体で使うと思うため、&lt;code&gt;application_helper.rb&lt;/code&gt;に追加します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/helpers/application_helper.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ApplicationHelper&lt;/span&gt;

  &lt;span class=&quot;synSpecial&quot;&gt;//&lt;/span&gt; 条件が &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt; の場合のみ、divタグを表示する
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;div_tag_if&lt;/span&gt;(condition, content_or_options_with_block = &lt;span class=&quot;synConstant&quot;&gt;nil&lt;/span&gt;, options = &lt;span class=&quot;synConstant&quot;&gt;nil&lt;/span&gt;, escape = &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt;, &amp;amp;block)
    &lt;span class=&quot;synComment&quot;&gt;# condition が trueの場合だけ、content_tagメソッドでdivタグを作成する&lt;/span&gt;
    &lt;span class=&quot;synComment&quot;&gt;# falseの場合は、何も作成しない&lt;/span&gt;
    &lt;span class=&quot;synStatement&quot;&gt;if&lt;/span&gt; condition
      content_tag(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, content_or_options_with_block, options, escape, &amp;amp;block)
    &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;独自ヘルパーメソッドの使用&lt;/h3&gt;
    &lt;p&gt;ヘルパーモジュールは、 Railsに自動で読み込まれるため、View内ですぐに使うことができます。&lt;br /&gt;
では、View内で使ってみましょう。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/index.html.erb&lt;/span&gt;

&amp;lt;!--  商品が空の場合、divタグで囲まれた&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;商品がありません。&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;を表示します。 --&amp;gt;
&amp;lt;%= div_tag_if(&lt;span class=&quot;synIdentifier&quot;&gt;@products&lt;/span&gt;.empty?, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;商品がありません。&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) %&amp;gt;
&lt;/pre&gt;&lt;p&gt;一応表示された画面です。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140802/20140802185658.png&quot; alt=&quot;f:id:nipe880324:20140802185658p:plain:w240&quot; title=&quot;f:id:nipe880324:20140802185658p:plain:w240&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:240px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;一歩上のRailsのヘルパーについての情報&lt;/h3&gt;
    &lt;p&gt;RailsはすべてのHelperをロードします。つまり、どのビューファイルからでも、すべてのヘルパーのメソッドを使うことができます。&lt;br /&gt;
そのため、&lt;b&gt;自前のヘルパーメソッドの命名が重複しないようする&lt;/b&gt;必要があります。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/helpers/application_helper.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;ApplicationHelper&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# メソッド名が重複している&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;some_method&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# app/helpers/somes_helper.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;SomesHelper&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# メソッド名が重複している&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;some_method&lt;/span&gt;
  &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Helperが増える場合は、&lt;a href=&quot;https://github.com/drapergem/draper&quot; target=&quot;_blank&quot;&gt;Draper&lt;/code&gt;などのデコレーターを使うことを検討した良い場合があります。&lt;/p&gt;&lt;p&gt;以上です。&lt;/p&gt;

&lt;/div&gt;</description>
          <pubDate>Sun, 03 Aug 2014 16:00:00 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/12921228815729415150</guid>
          
            <category>Rails初級</category>
          
            <category>Rails View</category>
          
        </item>
      
    
      
      
        <item>
          <title>Railsのテキスト、数値、日付/日時関連のフォーマットヘルパー</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20140802/1406969793</link>
          <description>&lt;p&gt;RailsのViewでよく使う&lt;b&gt;日付、数値、テキストのフォーマットヘルパー&lt;/b&gt;のリファレンスです。&lt;br /&gt;
フォーマットヘルパーは、日付/日時、数値、テキストの「表示形式を指定」できます。&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;Rails 4.1&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;テキスト関連&lt;/h3&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# デバッグ情報を表示する&lt;/span&gt;
&amp;lt;%= debug(params) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; リクエストパラメータの中身を表示&lt;/span&gt;
&amp;lt;%= debug(cookies) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; クッキーの中身を表示&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# 改行やスペースをそのままの形で表示する。テキストエリアの表示などで使う&lt;/span&gt;
&amp;lt;%= simple_format(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;lt;p&amp;gt;ABC&amp;lt;br&amp;gt;ZYX&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; &amp;lt;p&amp;gt;ABC&amp;lt;br&amp;gt;ZYX&amp;lt;/p&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# 文字列内の「指定文字」にタグを作成する（デフォルト：mark）&lt;/span&gt;
&amp;lt;%= highlight( &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;これはテスト用の文字列です。&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;テスト&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;) %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; これは&amp;lt;mark&amp;gt;テスト&amp;lt;/mark&amp;gt;用の文字列です。&lt;/span&gt;
&amp;lt;%= highlight(&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;これはテスト用の文字列です。&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, [&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;テスト&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;文字列&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;], &lt;span class=&quot;synConstant&quot;&gt;highlighter&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;lt;em&amp;gt;\1&amp;lt;/em&amp;gt;&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;) %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; これは&amp;lt;em&amp;gt;テスト&amp;lt;/em&amp;gt;用の&amp;lt;em&amp;gt;文字列&amp;lt;/em&amp;gt;です。&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# lengthで指定した文字数以上ある場合は、&amp;quot;...&amp;quot;で文字列を省略して表示する。&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#（lengthは、...の数も含む）&lt;/span&gt;
&amp;lt;%= truncate(&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;これはテスト用の文字列です。&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;length&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;8&lt;/span&gt;) %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; これはテス...&lt;/span&gt;
&amp;lt;%= truncate(&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;これはテスト用文字列です。&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;length&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;8&lt;/span&gt;) { link_to &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;続きを読む&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; } %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; これはテス...&amp;lt;a href=&amp;quot;#&amp;quot;&amp;gt;続きを読む&amp;lt;/a&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# 文字列内の「指定文字」からradius文だけ表示する&lt;/span&gt;
&amp;lt;%= excerpt( &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;これはテスト用の文字列です。&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;テスト&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;radius&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt;) %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;#=&amp;gt;...れはテスト用の...&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# 日本語では関係ないですが、名詞の単数/複数を識別して表示する&lt;/span&gt;
&amp;lt;%= pluralize(&lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; 1 person&lt;/span&gt;
&amp;lt;%= pluralize(&lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; 2 people&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# 日本語でちょっと実験してみましたが変な風に表示されてしまいます。&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# 多分、単数系複数形の辞書があり、そこでマッチしなかったら&amp;quot;s&amp;quot;をつけるとかのロジックなんだと思います。&lt;/span&gt;
&amp;lt;%= pluralize(&lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;人&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; 1 人&lt;/span&gt;
&amp;lt;%= pluralize(&lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;人&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; 2 人s&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;数値関連&lt;/h3&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 通貨形式で表示する&lt;/span&gt;
&amp;lt;%= number_to_currency( &lt;span class=&quot;synConstant&quot;&gt;1234.56&lt;/span&gt; ) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; $1,234.56 （ロケールは en）&lt;/span&gt;
&amp;lt;%= number_to_currency( &lt;span class=&quot;synConstant&quot;&gt;1234.56&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;unit&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;¥&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;precision&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;0&lt;/span&gt; ) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; ¥1,235&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# バイトで表示する&lt;/span&gt;
&amp;lt;%= number_to_human_size( &lt;span class=&quot;synConstant&quot;&gt;1200&lt;/span&gt; ) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; 1.17 KB&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# パーセントで表示する&lt;/span&gt;
&amp;lt;%= number_to_percentage( &lt;span class=&quot;synConstant&quot;&gt;66.666666&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;precision&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt; ) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; 66.7%&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# 3桁毎に区切り文字(デフォルトは ,)を追加して表示する&lt;/span&gt;
&amp;lt;%= number_with_delimiter( &lt;span class=&quot;synConstant&quot;&gt;1234567890&lt;/span&gt; ) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; 1,234,567,890&lt;/span&gt;
&amp;lt;%= number_with_delimiter( &lt;span class=&quot;synConstant&quot;&gt;1234567890&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;delimiter&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; ) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; 1_234_567_890&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# 表示桁数を指定して表示する（四捨五入される）&lt;/span&gt;
&amp;lt;%= number_with_precision( &lt;span class=&quot;synConstant&quot;&gt;12.3456&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;precision&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;2&lt;/span&gt; ) %&amp;gt; &lt;span class=&quot;synComment&quot;&gt;#=&amp;gt; 12.35&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;日付/日時関連&lt;/h3&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# 現在日時から引数で指定した日時までのおよその日付を表示&lt;/span&gt;
&amp;lt;%= time_ago_in_words(&lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt;.minutes.from_now)  %&amp;gt;   &lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; 3 minutes&lt;/span&gt;
&amp;lt;%= time_ago_in_words(&lt;span class=&quot;synConstant&quot;&gt;3&lt;/span&gt;.minutes.ago)  %&amp;gt;            &lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; 3 minutes&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;</description>
          <pubDate>Sat, 02 Aug 2014 17:56:33 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/12921228815729413033</guid>
          
            <category>Rails View</category>
          
            <category>リファレンス</category>
          
        </item>
      
    
      
      
        <item>
          <title>Railsのform_for内のコードをすっきりさせるsimple_formの使い方</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20140730/1406700205</link>
          <description>&lt;p&gt;Railsの&lt;code&gt;form_for&lt;/code&gt;内のコードをすっきりさせることができる、&lt;a href=&quot;https://github.com/plataformatec/simple_form&quot; target=&quot;_blank&quot;&gt;simple_form&lt;/a&gt;のインストール方法、使い方、カスタマイズ方法、バリデーションエラーの表示について説明します。&lt;/p&gt;&lt;p&gt;&lt;code&gt;form_for&lt;/code&gt;で書いたコードです。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140730/20140730145943.png&quot; alt=&quot;f:id:nipe880324:20140730145943p:plain:w320&quot; title=&quot;f:id:nipe880324:20140730145943p:plain:w320&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:320px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;これが、&lt;code&gt;simple_form&lt;/code&gt;で書き直すとことにより、次のようにとてもすっきりさせることができます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140730/20140730145948.png&quot; alt=&quot;f:id:nipe880324:20140730145948p:plain:w320&quot; title=&quot;f:id:nipe880324:20140730145948p:plain:w320&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:320px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    &lt;p&gt;・Rails 4.1&lt;br /&gt;
・simple_form 3.0.2&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;目次&lt;/h3&gt;
    
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;#simple_form-install&quot;&gt;simple_formのインストール方法&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#simple_form-customize&quot;&gt;simple_formのフィールドのカスタマイズ方法&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#simple_form-validation-error&quot;&gt;simple_formのバリデーションエラーの表示方法&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;0. simple_formを使う環境の作成&lt;/h3&gt;
    &lt;p&gt;まず、&lt;code&gt;simple_form&lt;/code&gt;を使うには、フォーム内がごちゃごちゃしていないと意味があまり無いので、その環境を作ります。&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;Railsプロジェクトの作成&lt;/h5&gt;
    &lt;p&gt;Railsプロジェクトを作成します。&lt;/p&gt;
&lt;pre class=&quot;code lang-sh&quot; data-lang=&quot;sh&quot; data-unlink&gt;rails new simple_form_test
&lt;span class=&quot;synStatement&quot;&gt;cd&lt;/span&gt; simple_form_test
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;ModelとDBの作成とScaffoldの実施&lt;/h5&gt;
    &lt;p&gt;今回作成するプロジェクトのER図は次のようになっています。&lt;br /&gt;
CategoryとProductを多対多関係にするために、Categorizationというテーブルを作成しています。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140728/20140728195741.png&quot; alt=&quot;f:id:nipe880324:20140728195741p:plain:w320&quot; title=&quot;f:id:nipe880324:20140728195741p:plain:w320&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:320px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;rails g model &lt;span class=&quot;synType&quot;&gt;Category&lt;/span&gt; name&lt;span class=&quot;synConstant&quot;&gt;:string&lt;/span&gt;
rails g model &lt;span class=&quot;synType&quot;&gt;Publisher&lt;/span&gt; name&lt;span class=&quot;synConstant&quot;&gt;:string&lt;/span&gt;
rails g scaffold &lt;span class=&quot;synType&quot;&gt;Product&lt;/span&gt; name&lt;span class=&quot;synConstant&quot;&gt;:string&lt;/span&gt; price&lt;span class=&quot;synConstant&quot;&gt;:integer&lt;/span&gt; released_on&lt;span class=&quot;synConstant&quot;&gt;:date&lt;/span&gt; rating&lt;span class=&quot;synConstant&quot;&gt;:integer&lt;/span&gt; discontinued&lt;span class=&quot;synConstant&quot;&gt;:boolean&lt;/span&gt; publisher&lt;span class=&quot;synConstant&quot;&gt;:references&lt;/span&gt;
rails g model &lt;span class=&quot;synType&quot;&gt;Categorization&lt;/span&gt; product&lt;span class=&quot;synConstant&quot;&gt;:references&lt;/span&gt; category&lt;span class=&quot;synConstant&quot;&gt;:references&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Productのdiscontinuedカラム（販売中止かどうかのフラグ）をデフォルトでは&lt;code&gt;false&lt;/code&gt;にしたいので、&lt;code&gt;default&lt;/code&gt;を設定します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# db/migrate/yyyymmddhhmmss_create_products.rb&lt;/span&gt;
  t.boolean &lt;span class=&quot;synConstant&quot;&gt;:discontinued&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;default&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;null&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;false&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;DBマイグレートします。&lt;/p&gt;
&lt;pre class=&quot;code lang-sh&quot; data-lang=&quot;sh&quot; data-unlink&gt;rake db:migrate
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;Modelファイルに関連の追加&lt;/h5&gt;
    &lt;p&gt;ER図に沿ってリレーションを追加します。&lt;br /&gt;
&lt;i&gt;Modelの生成時に、&lt;code&gt;references&lt;/code&gt;を指定しているので、&lt;code&gt;belongs_to&lt;/code&gt;は既に記載されていると思いますが、全てのModelを記載しておきます。&lt;/i&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/models/categorization.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;Categorization&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  belongs_to &lt;span class=&quot;synConstant&quot;&gt;:category&lt;/span&gt;
  belongs_to &lt;span class=&quot;synConstant&quot;&gt;:product&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# app/models/category.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;Category&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  has_many &lt;span class=&quot;synConstant&quot;&gt;:categorizastions&lt;/span&gt;
  has_many &lt;span class=&quot;synConstant&quot;&gt;:products&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;through&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:categorizations&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# app/models/product.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;Product&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  belongs_to &lt;span class=&quot;synConstant&quot;&gt;:publisher&lt;/span&gt;
  has_many &lt;span class=&quot;synConstant&quot;&gt;:categorizations&lt;/span&gt;
  has_many &lt;span class=&quot;synConstant&quot;&gt;:categories&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;through&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:categorizations&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# app/models/publisher.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;Publisher&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
  has_many &lt;span class=&quot;synConstant&quot;&gt;:products&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;初期データの作成と投入&lt;/h5&gt;
    &lt;p&gt;今回はCategoryとPublisherの登録画面を作成しないので、初期データを&lt;code&gt;rake db:seed&lt;/code&gt;経由で登録しまておきます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# db/seeds.rb&lt;/span&gt;
literature = &lt;span class=&quot;synType&quot;&gt;Category&lt;/span&gt;.create! &lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;文学&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
history = &lt;span class=&quot;synType&quot;&gt;Category&lt;/span&gt;.create! &lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;歴史&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
business = &lt;span class=&quot;synType&quot;&gt;Category&lt;/span&gt;.create! &lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;ビジネス&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
science = &lt;span class=&quot;synType&quot;&gt;Category&lt;/span&gt;.create! &lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;科学&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
comic = &lt;span class=&quot;synType&quot;&gt;Category&lt;/span&gt;.create! &lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;コミック&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;

suzuki = &lt;span class=&quot;synType&quot;&gt;Publisher&lt;/span&gt;.create! &lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;鈴木書店&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
tanaka = &lt;span class=&quot;synType&quot;&gt;Publisher&lt;/span&gt;.create! &lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;田中出版&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
shugo = &lt;span class=&quot;synType&quot;&gt;Publisher&lt;/span&gt;.create! &lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;集合社&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
otona = &lt;span class=&quot;synType&quot;&gt;Publisher&lt;/span&gt;.create! &lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;大人館&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;入力したデータを投入します。&lt;/p&gt;
&lt;pre class=&quot;code lang-sh&quot; data-lang=&quot;sh&quot; data-unlink&gt;rake db:seed
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;フォームの修正（Productの新規/編集画面）&lt;/h5&gt;
    &lt;p&gt;Scaffoldでは適切でない入力項目もあるので、修正します。&lt;br /&gt;
下記にソースコードを全て記載していますが、修正した箇所は次の通りです。&lt;br /&gt;
・ratingを「テキストフィールド」から「ラジオボタン」に変更&lt;br /&gt;
・publisher_idを「テキストフィールド」から「セレクトボックス」に変更&lt;br /&gt;
・categoryを選択できるチェックボックスを追加&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;# app/views/products/_form.html.erb
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; form_for(@product)&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; do |f| %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% if @product.errors.any? %&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;error_explanation&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; pluralize(@product.errors.count,&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;error&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;) %&amp;gt;&lt;/span&gt; prohibited this product from being saved:&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% @product.errors.full_messages.each do |message| %&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; message&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;li&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;ul&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :price %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.text_field&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :price %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :released_on %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.date_select&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :released_on %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :rating %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.radio_button&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :rating, 1 %&amp;gt;&lt;/span&gt; 1
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.radio_button&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :rating, 2 %&amp;gt;&lt;/span&gt; 2
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.radio_button&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :rating, 3 %&amp;gt;&lt;/span&gt; 3
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.radio_button&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :rating, 4 %&amp;gt;&lt;/span&gt; 4
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.radio_button&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :rating, 5 %&amp;gt;&lt;/span&gt; 5
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :discontinued %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.check_box&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :discontinued %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :publisher_id %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.collection_select&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; :publisher_id, Publisher.all, :&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, :&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, include_blank: true %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% Category.all.each do |category| %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; check_box_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;product[category_ids][]&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, category.&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;, @product.category_ids.include?(category.&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;), &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;: dom_id(category) %&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; label_tag&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; dom_id(category), category.&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; /&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;actions&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt; f.submit&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; %&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;% end %&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;カテゴリを更新できるようにコントローラーのStrongParameters内で&lt;code&gt;category_ids: []&lt;/code&gt;を追加します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/controllers/products_controller.rb&lt;/span&gt;
  ...
    &lt;span class=&quot;synComment&quot;&gt;# Never trust parameters from the scary internet, only allow the white list through.&lt;/span&gt;
    &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;product_params&lt;/span&gt;
      params.require(&lt;span class=&quot;synConstant&quot;&gt;:product&lt;/span&gt;).permit(&lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:price&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:released_on&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:rating&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:discontinued&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:publisher_id&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;category_ids&lt;/span&gt;: [])
    &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;Productの登録確認&lt;/h5&gt;
    &lt;p&gt;&lt;code&gt;$ server s&lt;/code&gt;でローカルサーバを起動し、Productが登録できることを確認して下さい。&lt;br /&gt;
&lt;b&gt;[登録画面]&lt;/b&gt;&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140730/20140730142443.png&quot; alt=&quot;f:id:nipe880324:20140730142443p:plain:w480&quot; title=&quot;f:id:nipe880324:20140730142443p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;[詳細画面]&lt;/b&gt;&lt;br /&gt;
※登録できたことがわかると思います。Publisherの表示がおかしく、カテゴリも表示されていませんが、show.html.erbを修正すれば適切に表示されます。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140730/20140730142445.png&quot; alt=&quot;f:id:nipe880324:20140730142445p:plain:w480&quot; title=&quot;f:id:nipe880324:20140730142445p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;長かったですが、これで準備は終わりです。&lt;br /&gt;
今の&lt;code&gt;form_for&lt;/code&gt;内はとても長いですよね。&lt;br /&gt;
これを、&lt;code&gt;simple_form&lt;/code&gt;を使うことによりとてもすっきりさせることができます。&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;simple_form-install&quot;&gt;1. simple_formのインストール方法&lt;/h3&gt;&lt;code&gt;simple_form&lt;/code&gt;をインストールしていきます。&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;Simple formのインストール&lt;/h5&gt;
    &lt;p&gt;Gemfileに追加します。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# Gemfile&lt;/span&gt;
gem &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;simple_form&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
バンドルを実行します。&lt;/p&gt;
&lt;pre class=&quot;code lang-sh&quot; data-lang=&quot;sh&quot; data-unlink&gt;bundle &lt;span class=&quot;synStatement&quot;&gt;install&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
&lt;code&gt;simple_form&lt;/code&gt;をRailsプロジェクトにインストールします。&lt;/p&gt;
&lt;pre class=&quot;code lang-sh&quot; data-lang=&quot;sh&quot; data-unlink&gt;rails g simple_form:&lt;span class=&quot;synStatement&quot;&gt;install&lt;/span&gt;
      create  config/initializers/simple_form.rb
       exist  config/locales
      create  config/locales/simple_form.en.yml
      create  lib/templates/erb/scaffold/_form.html.erb
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h5&gt;simple_formでform_forを書き直す&lt;/h5&gt;
    &lt;p&gt;書き換えた後のソースコードを全て記載しています。&lt;br /&gt;
書き換える考え方としては、&lt;br /&gt;
・&lt;code&gt;form_for&lt;/code&gt;を&lt;code&gt;simple_form_for&lt;/code&gt;にする。&lt;br /&gt;
・Input要素は、&lt;code&gt;&lt;%= f.input :xxx %&gt;&lt;/code&gt;にする。&lt;br /&gt;
・関連があるInput要素は、&lt;code&gt;&lt;%= f.association :yyy %&gt;&lt;/code&gt;に変えて下さい。&lt;/p&gt;&lt;p&gt;変更前と比べるととてもすっきりしたコードになっていると思います。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= simple_form_for(&lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;) &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;f&lt;/span&gt;| %&amp;gt;
  &amp;lt;%= f.input &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt; %&amp;gt;
  &amp;lt;%= f.input &lt;span class=&quot;synConstant&quot;&gt;:price&lt;/span&gt; %&amp;gt;
  &amp;lt;%= f.input &lt;span class=&quot;synConstant&quot;&gt;:released_on&lt;/span&gt; %&amp;gt;
  &amp;lt;%= f.input &lt;span class=&quot;synConstant&quot;&gt;:rating&lt;/span&gt; %&amp;gt;
  &amp;lt;%= f.input &lt;span class=&quot;synConstant&quot;&gt;:discontinued&lt;/span&gt; %&amp;gt;
  &amp;lt;%= f.association &lt;span class=&quot;synConstant&quot;&gt;:publisher&lt;/span&gt; %&amp;gt;
  &amp;lt;%= f.association &lt;span class=&quot;synConstant&quot;&gt;:categories&lt;/span&gt; %&amp;gt;
  &amp;lt;%= f.button &lt;span class=&quot;synConstant&quot;&gt;:submit&lt;/span&gt; %&amp;gt;
&amp;lt;% &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt; %&amp;gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、スタイリングファイルを作成し、スタイリングも追加します。&lt;/p&gt;
&lt;pre class=&quot;code lang-css&quot; data-lang=&quot;css&quot; data-unlink&gt;# app/assets/stylesheets/forms&lt;span class=&quot;synIdentifier&quot;&gt;.css.scss&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;.simple_form&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;{&lt;/span&gt;
  label {
    &lt;span class=&quot;synType&quot;&gt;margin&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;2px&lt;/span&gt; &lt;span class=&quot;synConstant&quot;&gt;10px&lt;/span&gt;;
    &amp;amp;.radio, &amp;amp;.checkbox {
      &lt;span class=&quot;synType&quot;&gt;float&lt;/span&gt;: &lt;span class=&quot;synType&quot;&gt;none&lt;/span&gt;;
      &lt;span class=&quot;synType&quot;&gt;margin&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;0&lt;/span&gt;;
      &lt;span class=&quot;synType&quot;&gt;width&lt;/span&gt;: &lt;span class=&quot;synType&quot;&gt;auto&lt;/span&gt;;
      &lt;span class=&quot;synType&quot;&gt;text-align&lt;/span&gt;: &lt;span class=&quot;synType&quot;&gt;left&lt;/span&gt;;
    &lt;span class=&quot;synIdentifier&quot;&gt;}&lt;/span&gt;
    &amp;amp;&lt;span class=&quot;synIdentifier&quot;&gt;.checkbox&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;synType&quot;&gt;display&lt;/span&gt;: &lt;span class=&quot;synType&quot;&gt;block&lt;/span&gt;;
    &lt;span class=&quot;synIdentifier&quot;&gt;}&lt;/span&gt;
    &amp;amp;&lt;span class=&quot;synIdentifier&quot;&gt;.radio&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;margin-right&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;10px&lt;/span&gt;; &lt;span class=&quot;synIdentifier&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;synError&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;.input&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;margin-bottom&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;10px&lt;/span&gt;;&lt;span class=&quot;synIdentifier&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;synStatement&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;.radio_buttons&lt;/span&gt;, &lt;span class=&quot;synStatement&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;.check_boxes&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;synType&quot;&gt;margin-right&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;5px&lt;/span&gt;;
  &lt;span class=&quot;synIdentifier&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;.alert-error&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;synType&quot;&gt;color&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;#D00&lt;/span&gt;;
    &lt;span class=&quot;synType&quot;&gt;margin-bottom&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;10px&lt;/span&gt;;
    &lt;span class=&quot;synType&quot;&gt;font-weight&lt;/span&gt;: &lt;span class=&quot;synType&quot;&gt;bold&lt;/span&gt;;
  &lt;span class=&quot;synIdentifier&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;.hint&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;.error&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;synType&quot;&gt;clear&lt;/span&gt;: &lt;span class=&quot;synType&quot;&gt;left&lt;/span&gt;;
    &lt;span class=&quot;synType&quot;&gt;font-size&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;12px&lt;/span&gt;;
    &lt;span class=&quot;synType&quot;&gt;color&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;#D00&lt;/span&gt;;
    &lt;span class=&quot;synType&quot;&gt;display&lt;/span&gt;: &lt;span class=&quot;synType&quot;&gt;block&lt;/span&gt;;
  &lt;span class=&quot;synIdentifier&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;.hint&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;synType&quot;&gt;color&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;#555&lt;/span&gt;;
    &lt;span class=&quot;synType&quot;&gt;font-style&lt;/span&gt;: &lt;span class=&quot;synType&quot;&gt;italic&lt;/span&gt;;
  &lt;span class=&quot;synIdentifier&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;synError&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
では、サーバを起動し、画面を確認しましょう。&lt;br /&gt;
コードは短くなったのに、画面表示はほとんど同じですね。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140730/20140730144535.png&quot; alt=&quot;f:id:nipe880324:20140730144535p:plain:w480&quot; title=&quot;f:id:nipe880324:20140730144535p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;&lt;b&gt;[補足説明]&lt;/b&gt;&lt;br /&gt;
&lt;code&gt;simple_form&lt;/code&gt;はDBカラムの型からHTMLの要素を決めています。&lt;br /&gt;
例えば、&lt;br /&gt;
・String型なら、テキストフィールド&lt;br /&gt;
・Integerなど数値型なら、数値フィールド&lt;br /&gt;
・Date型なら、日付フィールド&lt;br /&gt;
・Boolean型なら、チェックボックス&lt;br /&gt;
などです。&lt;br /&gt;
&lt;a href=&quot;http://simple-form.plataformatec.com.br/#available-input-types-and-defaults-for-each-column-type&quot; target=&quot;_blank&quot;&gt;公式ドキュメント&lt;/a&gt;に対応は記載されています。&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;simple_form-customize&quot;&gt;2. simple_formのフィールドのカスタマイズ方法&lt;/h3&gt;先ほどの画面では、ratingをラジオボタンにしたい、カテゴリをチェックボックスにしたいなどいまいちな箇所があります。&lt;br /&gt;
実際に変更しながら、フィールドのカスタマイズ方法を説明しいきます。&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;Inputフィールドのタイプを指定&lt;/h4&gt;
    &lt;p&gt;&lt;code&gt;as&lt;/code&gt;オプションを使うことで、Inputフィールドのタイプを指定することができます。&lt;br /&gt;
ここでは、categoriesをチェックボックスで表示させます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= f.association &lt;span class=&quot;synConstant&quot;&gt;:categories&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;as&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:check_boxes&lt;/span&gt; %&amp;gt;
&lt;/pre&gt;&lt;p&gt;使えるInputタイプについては、「&lt;a href=&quot;https://github.com/plataformatec/simple_form#available-input-types-and-defaults-for-each-column-type&quot; target=&quot;_blank&quot;&gt;利用可能なInputタイプ&lt;/a&gt;のMapping列」を確認して下さい。&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;ラベルを設定する&lt;/h4&gt;
    &lt;p&gt;&lt;code&gt;label&lt;/code&gt;オプションを使うことで、ラベルの文字を指定できます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;  &amp;lt;%= f.input &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;label&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;名前&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;ヒントを追加する&lt;/h4&gt;
    &lt;p&gt;&lt;code&gt;hint&lt;/code&gt;オプションを使うことで、ヒントの文字を追加できます。&lt;br /&gt;
ヒントとは、inputフィールドの下に表示される文字列のことで、ユーザが入力時の簡単な説明になります。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;  &amp;lt;%= f.input &lt;span class=&quot;synConstant&quot;&gt;:price&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;label&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;値段&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;hint&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;値段は円で入力して下さい&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;範囲を指定する&lt;/h4&gt;
    &lt;p&gt;&lt;code&gt;collection&lt;/code&gt;オプションで範囲オブジェクトか配列を引数に渡すと、その値の範囲のセレクトボックスになります。しかし、今回はラジオボタンで表示したいので、asオプションでラジオボタンを指定しています。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;  &amp;lt;%= f.input &lt;span class=&quot;synConstant&quot;&gt;:rating&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;collection&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;1&lt;/span&gt;..&lt;span class=&quot;synConstant&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;as&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:radio_buttons&lt;/span&gt; %&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;ラベルとinput要素のhtml属性を指定する&lt;/h4&gt;
    &lt;p&gt;&lt;code&gt;lable_html&lt;/code&gt;と&lt;code&gt;input_html&lt;/code&gt;オプションとhtml属性を指定することにより、属性をしていできます。&lt;br /&gt;
今回はテストのため、名前を赤色に、入力ボックスの角を丸めるように&lt;code&gt;style&lt;/code&gt;属性を指定しました。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;  &amp;lt;%= f.input &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;label&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;名前&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synConstant&quot;&gt;label_html&lt;/span&gt;: { &lt;span class=&quot;synConstant&quot;&gt;style&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;color:red;&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; }, &lt;span class=&quot;synConstant&quot;&gt;input_html&lt;/span&gt;: { &lt;span class=&quot;synConstant&quot;&gt;style&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;border-radius:5px;&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; } %&amp;gt;
&lt;/pre&gt;&lt;p&gt;その他やりたいことがありましたら、&lt;a href=&quot;http://simple-form.plataformatec.com.br/#usage/stripping-away-all-wrapper-divs&quot; target=&quot;_blank&quot;&gt;Simple form 公式ドキュメント&lt;/a&gt;を確認して下さい。&lt;/p&gt;&lt;p&gt;では、変更した画像を見てみましょう。&lt;br /&gt;
実際に、ラジオボタンやチェックボックスになっていることが分かると思います。&lt;br /&gt;
&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140730/20140730145404.png&quot; alt=&quot;f:id:nipe880324:20140730145404p:plain:w480&quot; title=&quot;f:id:nipe880324:20140730145404p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;h3 id=&quot;simple_form-validation-error&quot;&gt;3. simple_formのバリデーションエラーの表示方法&lt;/h3&gt;Modelクラスに&lt;code&gt;validates&lt;/code&gt;メソッドを追加することで、フォーム上にValidationのエラーメッセージが表示されます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/models/product.rb&lt;/span&gt;
...
  validates &lt;span class=&quot;synConstant&quot;&gt;:email&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;presence&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;synComment&quot;&gt;# email属性が空の場合Validationエラー&lt;/span&gt;
...
&lt;/pre&gt;&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140730/20140730145701.png&quot; alt=&quot;f:id:nipe880324:20140730145701p:plain:w480&quot; title=&quot;f:id:nipe880324:20140730145701p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;p&gt;&lt;code&gt;simple form&lt;/code&gt;はラベルに自動で&quot;*&quot;マークをつけ、エラー文字も表示してくれます。&lt;br /&gt;
&quot;*&quot;マークを表示したくないや、他のマークにしたい場合、&lt;code&gt;config/initializers/simple_form.rb&lt;/code&gt;に設定項目があるので変更できます。&lt;/p&gt;&lt;p&gt;また、日本語化をしたい場合は、&lt;code&gt;config/locales/simple_form.en.yml&lt;/code&gt;を真似て、日本語用ファイルを作成してください。&lt;/p&gt;&lt;p&gt;エラーメッセージをフォームの上部に表示させたい場合は、下記を追加して下さい。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/products/_form.html.erb&lt;/span&gt;
&amp;lt;%= simple_form_for(&lt;span class=&quot;synIdentifier&quot;&gt;@product&lt;/span&gt;) &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;f&lt;/span&gt;| %&amp;gt;
  &amp;lt;%= f.error_notification %&amp;gt;

  &amp;lt;%= f.input &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;label&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;名前&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,
    &lt;span class=&quot;synConstant&quot;&gt;label_html&lt;/span&gt;: { &lt;span class=&quot;synConstant&quot;&gt;style&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;color:red;&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; }, &lt;span class=&quot;synConstant&quot;&gt;input_html&lt;/span&gt;: { &lt;span class=&quot;synConstant&quot;&gt;style&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;border-radius:5px;&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt; } %&amp;gt;
...
&lt;/pre&gt;&lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140730/20140730145836.png&quot; alt=&quot;f:id:nipe880324:20140730145836p:plain:w480&quot; title=&quot;f:id:nipe880324:20140730145836p:plain:w480&quot; class=&quot;hatena-fotolife&quot; style=&quot;width:480px&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;br /&gt;
&lt;p&gt;デザインがいまいちと思われた方は、&lt;code&gt;simple_form&lt;/code&gt;と&lt;code&gt;Twitter Bootstrap&lt;/code&gt;は連携できるので、&lt;br /&gt;
&lt;a href=&quot;http://ruby-rails.hatenadiary.com/entry/20140801/1406818800&quot;&gt;Rails&amp;#x306B;Twitter Bootstrap&amp;#x306E;&amp;#x5C0E;&amp;#x5165;&amp;#x3068;&amp;#x7C21;&amp;#x6613;&amp;#x306A;&amp;#x4F7F;&amp;#x3044;&amp;#x65B9; - Rails Webook&lt;/a&gt;&lt;br /&gt;
を参照して見て下さい。&lt;/p&gt;&lt;p&gt;以上です。&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;</description>
          <pubDate>Wed, 30 Jul 2014 15:03:25 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/12921228815729045197</guid>
          
            <category>Rails View</category>
          
            <category>Rails gem</category>
          
        </item>
      
    
      
      
        <item>
          <title>Railsのform_forを使ったフォームのController,View,Modelの連携した処理フロー</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20140727/1406448610</link>
          <description>&lt;p&gt;Rails のform_forを使ったフォームのController、View、Modelの連携がよく分からない、何となく動いているけど理解していないからカスタマイズなどできそうにないといった方向け、form_forメソッドを中心としたMVCが連携する処理フローを説明していきます。&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    &lt;p&gt;・Rails 4.1.0&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;処理フロー概要&lt;/h3&gt;
    &lt;p&gt;1. Controllerの&lt;code&gt;newメソッド/editメソッド&lt;/code&gt;でModelオブジェクトを生成しインスタンス変数（例：@userなど）に値を設定&lt;br /&gt;
2. Viewの&lt;code&gt;form_forメソッド&lt;/code&gt;でModelオブジェクトのカラムを使用したフォームを作成し、表示する。&lt;br /&gt;
3. ユーザがサブミットすると、params変数に入力したパラメータがハッシュの形で設定されてControllerに届く。&lt;br /&gt;
4. Controllerの&lt;code&gt;createメソッド /updateメソッド&lt;/code&gt;でparams変数でModelオブジェクトを作成/更新する。&lt;br /&gt;
という流れです。&lt;br /&gt;
&lt;br /&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;新規登録フロー&lt;/h3&gt;
    
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;前提&lt;/h4&gt;
    &lt;p&gt;Userテーブルには&lt;code&gt;name&lt;/code&gt;と&lt;code&gt;email&lt;/code&gt;というカラムが存在していて、&lt;code&gt;user.rbファイル&lt;/code&gt;が作成されている。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/models/user.rb&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;synType&quot;&gt;User&lt;/span&gt; &amp;lt; &lt;span class=&quot;synType&quot;&gt;ActiveRecord&lt;/span&gt;::&lt;span class=&quot;synType&quot;&gt;Base&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;1. Controllerの&lt;code&gt;newメソッド&lt;/code&gt;でModelオブジェクトを生成しインスタンス変数に設定&lt;/h4&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/controllers/users_controller.rb&lt;/span&gt;
... 
&lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# @user に空のModelオブジェクトを作成し、インタンス変数@userに設定&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# @userはViewでも使える&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# Controllerでrenderやredirect_toなどで明示的にレンダリングするViewをしていない場合は、&lt;/span&gt;
  &lt;span class=&quot;synComment&quot;&gt;# メソッド名のViewファイルがレンダリングされる（例：new =&amp;gt; new.html.erb）&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;@user&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;User&lt;/span&gt;.new
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
...
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;2. Viewの&lt;code&gt;form_forメソッド&lt;/code&gt;でフォームを作成し、表示&lt;/h4&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/views/users/new.html.erb&lt;/span&gt;
...
&lt;span class=&quot;synComment&quot;&gt;# form_forに@userを渡すことにより、Userテーブルのnameとemailカラムの&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;# ラベルやテキストフィールドなどのinput要素を簡易に作成することができる&lt;/span&gt;
&amp;lt;%= form_for &lt;span class=&quot;synIdentifier&quot;&gt;@user&lt;/span&gt; &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; |&lt;span class=&quot;synIdentifier&quot;&gt;f&lt;/span&gt;| %&amp;gt;

  &amp;lt;div &lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt;=&amp;quot;field&amp;quot;&amp;gt;
    &amp;lt;%= f.label &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;名前&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
    &amp;lt;%= f.text_field &lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt; %&amp;gt;
  &amp;lt;/div&amp;gt;

  &amp;lt;div &lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt;=&amp;quot;field&amp;quot;&amp;gt;
    &amp;lt;%= f.label &lt;span class=&quot;synConstant&quot;&gt;:email&lt;/span&gt;, &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;メールアドレス&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
    &amp;lt;%= f.text_field &lt;span class=&quot;synConstant&quot;&gt;:email&lt;/span&gt; %&amp;gt;
  &amp;lt;/div&amp;gt;
  
  &amp;lt;div &lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt;=&amp;quot;actions&amp;quot;&amp;gt;
    &amp;lt;%= f.submit &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;登録する&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;% &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt; %&amp;gt;
...
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;作成された画面のフォーム部分は...&lt;/h4&gt;
    &lt;p&gt;&lt;span itemscope itemtype=&quot;http://schema.org/Photograph&quot;&gt;&lt;img src=&quot;http://cdn-ak.f.st-hatena.com/images/fotolife/n/nipe880324/20140727/20140727165659.png&quot; alt=&quot;f:id:nipe880324:20140727165659p:plain&quot; title=&quot;f:id:nipe880324:20140727165659p:plain&quot; class=&quot;hatena-fotolife&quot; itemprop=&quot;image&quot;&gt;&lt;/span&gt;&lt;br /&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;作成されたHTMLは...&lt;/h4&gt;
    &lt;p&gt;&lt;code&gt;input属性&lt;/code&gt;の&lt;code&gt;name属性&lt;/code&gt;に注目しといて下さい。これは、Model名とそのカラム名になっていることが分かると思います。&lt;/p&gt;
&lt;pre class=&quot;code lang-html&quot; data-lang=&quot;html&quot; data-unlink&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;accept&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;/users&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;new_user&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;new_user&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;post&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;display:none&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;utf8&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;✓&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;authenticity_token&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;RIDGusRT/gJ2C+y+FKFV2P6rfN1mmNrQNWGX2sAtWrQ=&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;user_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;名前&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;user_name&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;user[name]&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;text&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;field&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;user_email&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;メールアドレス&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;user_email&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;user[email]&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;text&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;actions&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;commit&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;submit&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt; &lt;/span&gt;&lt;span class=&quot;synType&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;&amp;quot;登録する&amp;quot;&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;synIdentifier&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;synStatement&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;synIdentifier&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;3. ユーザがサブミットすると、params変数に入力したパラメータがハッシュの形で設定されてControllerに届く&lt;/h4&gt;
    &lt;p&gt;先ほどの、&lt;code&gt;input要素&lt;/code&gt;の&lt;code&gt;name属性&lt;/code&gt;をキーとしてハッシュ形式でparamsに設定されます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;params =
  {
    &lt;span class=&quot;synConstant&quot;&gt;user&lt;/span&gt;: {  &lt;span class=&quot;synComment&quot;&gt;# params[:user] で { name: &amp;quot;鈴木&amp;quot;, email: &amp;quot;suzu...&amp;quot; } を取得可能&lt;/span&gt;
      &lt;span class=&quot;synConstant&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;鈴木&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;,     &lt;span class=&quot;synComment&quot;&gt;# params[:user][:name] で値を取得可能&lt;/span&gt;
      &lt;span class=&quot;synConstant&quot;&gt;email&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;suzuki@example.com&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;   &lt;span class=&quot;synComment&quot;&gt;# params[:user][:email] で値を取得可能&lt;/span&gt;
    }
  }
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;4. Controllerの&lt;code&gt;createメソッド&lt;/code&gt;でparams変数でModelオブジェクトを作成&lt;/h4&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# app/controllers/users_controller.rb&lt;/span&gt;
... 
&lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;create&lt;/span&gt;
  &lt;span class=&quot;synIdentifier&quot;&gt;@user&lt;/span&gt; = &lt;span class=&quot;synType&quot;&gt;User&lt;/span&gt;.new(user_params)
  &lt;span class=&quot;synStatement&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;@user&lt;/span&gt;.save
    &lt;span class=&quot;synComment&quot;&gt;# @userはuser_path(@user) に自動変換される&lt;/span&gt;
    redirect_to &lt;span class=&quot;synIdentifier&quot;&gt;@user&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;notice&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;ユーザ登録しました。&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;synStatement&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;synComment&quot;&gt;# ValidationエラーなどでDBに保存できない場合 new.html.erb を再表示&lt;/span&gt;
    render &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;
  &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;synStatement&quot;&gt;private&lt;/span&gt;
    &lt;span class=&quot;synComment&quot;&gt;# Rails4からStrongParamaterと呼ばれる機能が追加されました。&lt;/span&gt;
    &lt;span class=&quot;synComment&quot;&gt;# セキュリティのため、permitメソッドで許可したパラメータ名しか取得できません。&lt;/span&gt;
    &lt;span class=&quot;synPreProc&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;synIdentifier&quot;&gt;user_params&lt;/span&gt;
      params.require(&lt;span class=&quot;synConstant&quot;&gt;:user&lt;/span&gt;).permit(&lt;span class=&quot;synConstant&quot;&gt;:name&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;:email&lt;/span&gt;)
    &lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;synPreProc&quot;&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;br /&gt;
以上です。&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;</description>
          <pubDate>Sun, 27 Jul 2014 17:10:10 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/12921228815728962272</guid>
          
            <category>Rails View</category>
          
        </item>
      
        <item>
          <title>Railsでaタグのリンクを作成するlink_toメソッドの使い方</title>
          <link>http://ruby-rails.hatenadiary.com/entry/20140727/1406439331</link>
          <description>&lt;p&gt;Railsでリンクを作成する&lt;code&gt;link_to&lt;/code&gt;メソッドのいろいろな使い方について説明します。&lt;br /&gt;
HTMLのclass属性を付与する、URLにパラメータ（クエリストリング）を付与する、DELETEメソッドを付与する、ダイアログを表示する方法などのよく使う使い方を説明します。&lt;/p&gt;

&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;動作確認&lt;/h3&gt;
    
&lt;ul&gt;
&lt;li&gt;Rails 4.1.0&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;&lt;code&gt;link_toメソッド&lt;/code&gt;の使い方&lt;/h3&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;## Viewファイル ##&lt;/span&gt;
&amp;lt;%= link_to( name = &lt;span class=&quot;synConstant&quot;&gt;nil&lt;/span&gt;, options = &lt;span class=&quot;synConstant&quot;&gt;nil&lt;/span&gt;, html_options = &lt;span class=&quot;synConstant&quot;&gt;nil&lt;/span&gt;, &amp;amp;block ) %&amp;gt;

&lt;span class=&quot;synComment&quot;&gt;# name - リンクに表示される名前&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   例.  &amp;lt;%= link_to &amp;quot;リンク名&amp;quot;  %&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# options&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   urlを指定する。&amp;quot;http://localhost/about.html&amp;quot;などのURL形式とposts_pathなどのパス形式で指定可能。&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   data: { confirm: &#39;プロンプト表示文字列&#39; }  - プロンプトを表示させることができる&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   method - HTTPメソッドを指定可能（:post, :delete, :patch, :put）&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   remote - trueを指定するとリクエストはAjaxリクエストとして送信される&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# html_options - HTMLの属性を指定可能&lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#   例.  &amp;lt;%= link_to &amp;quot;名前&amp;quot;, id: &amp;quot;aaa&amp;quot; %&amp;gt; &lt;/span&gt;
&lt;span class=&quot;synComment&quot;&gt;#          =&amp;gt; &amp;lt;a href=&amp;quot;xxx&amp;quot; id=&amp;quot;aaa&amp;quot;&amp;gt;名前&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;&lt;code&gt;link_toメソッド&lt;/code&gt;のよく使う使用例&lt;/h3&gt;
    
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;「一番基本」の&lt;code&gt;link_toメソッド&lt;/code&gt;&lt;/h4&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, profile_path(&lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;)  %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;a href=&amp;quot;/profiles/1&amp;quot;&amp;gt;プロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;

&lt;span class=&quot;synComment&quot;&gt;# 個別ページに遷移する場合、下記のように引数にpathを渡さずにModelオブジェクトを渡すだけでも良い。&lt;/span&gt;
&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;  %&amp;gt; 
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;「URLにパラメータ（例: ?q=&quot;abc&quot;）」を付与した&lt;code&gt;link_toメソッド&lt;/code&gt;&lt;/h4&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= link_to  &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, profile_path(&lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;q&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;)  %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;a href=&amp;quot;/profiles/1?q=list&amp;quot;&amp;gt;プロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;「class属性とid属性」を付与した&lt;code&gt;link_toメソッド&lt;/code&gt;&lt;/h4&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;, &lt;span class=&quot;synPreProc&quot;&gt;class&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;btn btn-large&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;profile-btn&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;a class=&amp;quot;btn btn-large&amp;quot; href=&amp;quot;/profiles/1&amp;quot; id=&amp;quot;profile-btn&amp;quot;&amp;gt;プロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;「DELETEメソッドとダイアログを表示」する&lt;code&gt;link_toメソッド&lt;/code&gt;&lt;/h4&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;削除する&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, profile, &lt;span class=&quot;synConstant&quot;&gt;method&lt;/span&gt;: &lt;span class=&quot;synConstant&quot;&gt;:delete&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;data&lt;/span&gt;: { &lt;span class=&quot;synConstant&quot;&gt;confirm&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;削除しますか？&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; } %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;a data-confirm=&amp;quot;削除しますか？&amp;quot; data-method=&amp;quot;delete&amp;quot; href=&amp;quot;/profiles/1&amp;quot; rel=&amp;quot;nofollow&amp;quot;&amp;gt;削除する&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;「ブロック」を使った&lt;code&gt;link_toメソッド&lt;/code&gt;&lt;/h4&gt;
    &lt;p&gt;ブロックを使うことで、&lt;code&gt;aタグ&lt;/code&gt;内にHTMLタグの複雑な構造を作成できます。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&quot;synStatement&quot;&gt;do&lt;/span&gt; %&amp;gt;
  &amp;lt;strong&amp;gt;&amp;lt;%= &lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt;.name %&amp;gt;&amp;lt;/strong&amp;gt;さんのプロフィール
&amp;lt;% &lt;span class=&quot;synStatement&quot;&gt;end&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;a href=&amp;quot;/profiles/1&amp;quot;&amp;gt;&amp;lt;strong&amp;gt;鈴木&amp;lt;/strong&amp;gt;さんのプロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h4&gt;「コントローラーやアクション」を指定した&lt;code&gt;link_toメソッド&lt;/code&gt;（旧形式）&lt;/h4&gt;
    &lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;# profiles#showが呼ばれる。&lt;/span&gt;
&amp;lt;%= link_to &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;プロフィール&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;controller&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;profiles&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;action&lt;/span&gt;: &lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;synConstant&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;synSpecial&quot;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&quot;synConstant&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;synIdentifier&quot;&gt;@profile&lt;/span&gt; %&amp;gt;
&lt;span class=&quot;synComment&quot;&gt;# =&amp;gt; &amp;lt;a href=&amp;quot;/profiles/1&amp;quot;&amp;gt;プロフィール&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;他にも...&lt;/h3&gt;
    &lt;p&gt;&lt;code&gt;link_to_if&lt;/code&gt;と&lt;code&gt;link_to_unless&lt;/code&gt;といった条件分付きの&lt;code&gt;link_toメソッド&lt;/code&gt;もあるので条件付きで表示・非表示にしたいときは使って下さい。&lt;/p&gt;
&lt;pre class=&quot;code lang-ruby&quot; data-lang=&quot;ruby&quot; data-unlink&gt;link_to_if(condition, name, options = {}, html_options = {}, &amp;amp;block)
link_to_unless(condition, name, options = {}, html_options = {}, &amp;amp;block)
&lt;/pre&gt;&lt;p&gt;詳細はRails APIの公式ドキュメントを確認して下さい。&lt;br /&gt;
&lt;a href=&quot;http://api.rubyonrails.org/&quot;&gt;Ruby on Rails API&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    &lt;h3&gt;参考文献&lt;/h3&gt;
    &lt;p&gt;・&lt;a href=&quot;http://sandragon.hatenablog.com/entry/2013/01/27/183218&quot;&gt;Rails&amp;#x306E;link_to&amp;#x306B;&amp;#x30D1;&amp;#x30E9;&amp;#x30E1;&amp;#x30FC;&amp;#x30BF;&amp;#x3092;&amp;#x4ED8;&amp;#x4E0E;&amp;#x3059;&amp;#x308B; - MogLog&lt;/a&gt;&lt;br /&gt;
・&lt;a href=&quot;http://yoshifumisato.jeez.jp/wordpress/post/rails/723&quot;&gt;http://yoshifumisato.jeez.jp/wordpress/post/rails/723&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;</description>
          <pubDate>Sun, 27 Jul 2014 14:35:31 +0900</pubDate>
          <guid isPermalink="false">hatenablog://entry/12921228815728940596</guid>
          
            <category>Rails View</category>
          
        </item>
      
    
  </channel>
</rss>
